/*! For license information please see 4446.046495de3651ce827aae.js.LICENSE.txt */
(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[4446],{44704:(e,t,n)=>{"use strict";n(65318)},65318:(e,t,n)=>{"use strict";n.r(t)},5444:()=>{},17073:()=>{},30562:()=>{},9554:()=>{},93607:(e,t,n)=>{var s;!function(i,o){var r={};function a(e){return function(){var t={method:e},n=Array.prototype.slice.call(arguments);/^get/.test(e)?(r.assert(n.length>0,"Get methods require a callback."),n.unshift(t)):(/^set/.test(e)&&(r.assert(0!==n.length,"Set methods require a value."),t.value=n[0]),n=[t]),this.send.apply(this,n)}}r.DEBUG=!1,r.VERSION="0.0.11",r.CONTEXT="player.js",r.POST_MESSAGE=!!i.postMessage,r.origin=function(e){return"//"===e.substr(0,2)&&(e=i.location.protocol+e),e.split("/").slice(0,3).join("/")},r.addEvent=function(e,t,n){e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)},r.log=function(){r.log.history=r.log.history||[],r.log.history.push(arguments),i.console&&r.DEBUG&&i.console.log(Array.prototype.slice.call(arguments))},r.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},r.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.isNone=function(e){return null==e},r.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.indexOf=function(e,t){if(null==e)return-1;var n=0,s=e.length;if(Array.prototype.IndexOf&&e.indexOf===Array.prototype.IndexOf)return e.indexOf(t);for(;n<s;n++)if(e[n]===t)return n;return-1},r.assert=function(e,t){if(!e)throw t||"Player.js Assert Failed"},r.Keeper=function(){this.init()},r.Keeper.prototype.init=function(){this.data={}},r.Keeper.prototype.getUUID=function(){return"listener-xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},r.Keeper.prototype.has=function(e,t){if(!this.data.hasOwnProperty(e))return!1;if(r.isNone(t))return!0;for(var n=this.data[e],s=0;s<n.length;s++)if(n[s].id===t)return!0;return!1},r.Keeper.prototype.add=function(e,t,n,s,i){var o={id:e,event:t,cb:n,ctx:s,one:i};this.has(t)?this.data[t].push(o):this.data[t]=[o]},r.Keeper.prototype.execute=function(e,t,n,s){if(!this.has(e,t))return!1;for(var i=[],o=[],a=0;a<this.data[e].length;a++){var c=this.data[e][a];r.isNone(t)||!r.isNone(t)&&c.id===t?(o.push({cb:c.cb,ctx:c.ctx?c.ctx:s,data:n}),!1===c.one&&i.push(c)):i.push(c)}0===i.length?delete this.data[e]:this.data[e]=i;for(var l=0;l<o.length;l++){var d=o[l];d.cb.call(d.ctx,d.data)}},r.Keeper.prototype.on=function(e,t,n,s){this.add(e,t,n,s,!1)},r.Keeper.prototype.one=function(e,t,n,s){this.add(e,t,n,s,!0)},r.Keeper.prototype.off=function(e,t){var n=[];if(!this.data.hasOwnProperty(e))return n;for(var s=[],i=0;i<this.data[e].length;i++){var o=this.data[e][i];r.isNone(t)||o.cb===t?r.isNone(o.id)||n.push(o.id):s.push(o)}return 0===s.length?delete this.data[e]:this.data[e]=s,n},r.Player=function(e,t){if(!(this instanceof r.Player))return new r.Player(e,t);this.init(e,t)},r.EVENTS={READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},r.EVENTS.all=function(){var e=[];for(var t in r.EVENTS)r.has(r.EVENTS,t)&&r.isString(r.EVENTS[t])&&e.push(r.EVENTS[t]);return e},r.METHODS={PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"},r.METHODS.all=function(){var e=[];for(var t in r.METHODS)r.has(r.METHODS,t)&&r.isString(r.METHODS[t])&&e.push(r.METHODS[t]);return e},r.READIED=[],r.Player.prototype.init=function(e,t){var n=this;r.isString(e)&&(e=o.getElementById(e)),this.elem=e,r.assert("IFRAME"===e.nodeName,'playerjs.Player constructor requires an Iframe, got "'+e.nodeName+'"'),r.assert(e.src,"playerjs.Player constructor requires a Iframe with a 'src' attribute."),this.origin=r.origin(e.src),this.keeper=new r.Keeper,this.isReady=!1,this.queue=[],this.events=r.EVENTS.all(),this.methods=r.METHODS.all(),r.POST_MESSAGE?r.addEvent(i,"message",(function(e){n.receive(e)})):r.log("Post Message is not Available."),r.indexOf(r.READIED,e.src)>-1?n.loaded=!0:this.elem.onload=function(){n.loaded=!0}},r.Player.prototype.send=function(e,t,n){if(e.context=r.CONTEXT,e.version=r.VERSION,t){var s=this.keeper.getUUID();e.listener=s,this.keeper.one(s,e.method,t,n)}return this.isReady||"ready"===e.value?(r.log("Player.send",e,this.origin),!0===this.loaded&&this.elem.contentWindow.postMessage(JSON.stringify(e),this.origin),!0):(r.log("Player.queue",e),this.queue.push(e),!1)},r.Player.prototype.receive=function(e){if(r.log("Player.receive",e),e.origin!==this.origin)return!1;var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==r.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src===this.elem.src&&this.ready(t),this.keeper.has(t.event,t.listener)&&this.keeper.execute(t.event,t.listener,t.value,this)},r.Player.prototype.ready=function(e){if(!0===this.isReady)return!1;e.value.events&&(this.events=e.value.events),e.value.methods&&(this.methods=e.value.methods),this.isReady=!0,this.loaded=!0;for(var t=0;t<this.queue.length;t++){var n=this.queue[t];r.log("Player.dequeue",n),"ready"===e.event&&this.keeper.execute(n.event,n.listener,!0,this),this.send(n)}this.queue=[]},r.Player.prototype.on=function(e,t,n){var s=this.keeper.getUUID();return"ready"===e?this.keeper.one(s,e,t,n):this.keeper.on(s,e,t,n),this.send({method:"addEventListener",value:e,listener:s}),!0},r.Player.prototype.off=function(e,t){var n=this.keeper.off(e,t);if(r.log("Player.off",n),n.length>0)for(var s in n)return this.send({method:"removeEventListener",value:e,listener:n[s]}),!0;return!1},r.Player.prototype.supports=function(e,t){r.assert(r.indexOf(["method","event"],e)>-1,'evtOrMethod needs to be either "event" or "method" got '+e),t=r.isArray(t)?t:[t];for(var n="event"===e?this.events:this.methods,s=0;s<t.length;s++)if(-1===r.indexOf(n,t[s]))return!1;return!0};for(var c=0,l=r.METHODS.all().length;c<l;c++){var d=r.METHODS.all()[c];r.Player.prototype.hasOwnProperty(d)||(r.Player.prototype[d]=a(d))}r.addEvent(i,"message",(function(e){var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==r.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src&&r.READIED.push(t.value.src)})),r.Receiver=function(e,t){this.init(e,t)},r.Receiver.prototype.init=function(e,t){var n=this;this.isReady=!1,this.origin=r.origin(o.referrer),this.methods={},this.supported={events:e||r.EVENTS.all(),methods:t||r.METHODS.all()},this.eventListeners={},this.reject=!(i.self!==i.top&&r.POST_MESSAGE),this.reject||r.addEvent(i,"message",(function(e){n.receive(e)}))},r.Receiver.prototype.receive=function(e){if(e.origin!==this.origin)return!1;var t={};if(r.isObject(e.data))t=e.data;else try{t=i.JSON.parse(e.data)}catch(e){r.log("JSON Parse Error",e)}if(r.log("Receiver.receive",e,t),!t.method)return!1;if(t.context!==r.CONTEXT)return!1;if(-1===r.indexOf(r.METHODS.all(),t.method))return this.emit("error",{code:2,msg:'Invalid Method "'+t.method+'"'}),!1;var n=r.isNone(t.listener)?null:t.listener;if("addEventListener"===t.method)this.eventListeners.hasOwnProperty(t.value)?-1===r.indexOf(this.eventListeners[t.value],n)&&this.eventListeners[t.value].push(n):this.eventListeners[t.value]=[n],"ready"===t.value&&this.isReady&&this.ready();else if("removeEventListener"===t.method){if(this.eventListeners.hasOwnProperty(t.value)){var s=r.indexOf(this.eventListeners[t.value],n);s>-1&&this.eventListeners[t.value].splice(s,1),0===this.eventListeners[t.value].length&&delete this.eventListeners[t.value]}}else this.get(t.method,t.value,n)},r.Receiver.prototype.get=function(e,t,n){var s=this;if(!this.methods.hasOwnProperty(e))return this.emit("error",{code:3,msg:'Method Not Supported"'+e+'"'}),!1;var i=this.methods[e];if("get"===e.substr(0,3)){i.call(this,(function(t){s.send(e,t,n)}))}else i.call(this,t)},r.Receiver.prototype.on=function(e,t){this.methods[e]=t},r.Receiver.prototype.send=function(e,t,n){if(r.log("Receiver.send",e,t,n),this.reject)return r.log("Receiver.send.reject",e,t,n),!1;var s={context:r.CONTEXT,version:r.VERSION,event:e};r.isNone(t)||(s.value=t),r.isNone(n)||(s.listener=n);var o=JSON.stringify(s);i.parent.postMessage(o,""===this.origin?"*":this.origin)},r.Receiver.prototype.emit=function(e,t){if(!this.eventListeners.hasOwnProperty(e))return!1;r.log("Instance.emit",e,t,this.eventListeners[e]);for(var n=0;n<this.eventListeners[e].length;n++){var s=this.eventListeners[e][n];this.send(e,t,s)}return!0},r.Receiver.prototype.ready=function(){r.log("Receiver.ready"),this.isReady=!0;var e={src:i.location.toString(),events:this.supported.events,methods:this.supported.methods};this.emit("ready",e)||this.send("ready",e)},r.HTML5Adapter=function(e){if(!(this instanceof r.HTML5Adapter))return new r.HTML5Adapter(e);this.init(e)},r.HTML5Adapter.prototype.init=function(e){r.assert(e,"playerjs.HTML5Adapter requires a video element");var t=this.receiver=new r.Receiver;e.addEventListener("playing",(function(){t.emit("play")})),e.addEventListener("pause",(function(){t.emit("pause")})),e.addEventListener("ended",(function(){t.emit("ended")})),e.addEventListener("timeupdate",(function(){t.emit("timeupdate",{seconds:e.currentTime,duration:e.duration})})),e.addEventListener("progress",(function(){t.emit("buffered",{percent:e.buffered.length})})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(100*e.volume)})),t.on("setVolume",(function(t){e.volume=t/100})),t.on("mute",(function(){e.muted=!0})),t.on("unmute",(function(){e.muted=!1})),t.on("getMuted",(function(t){t(e.muted)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},r.HTML5Adapter.prototype.ready=function(){this.receiver.ready()},r.JWPlayerAdapter=function(e){if(!(this instanceof r.JWPlayerAdapter))return new r.JWPlayerAdapter(e);this.init(e)},r.JWPlayerAdapter.prototype.init=function(e){r.assert(e,"playerjs.JWPlayerAdapter requires a player object");var t=this.receiver=new r.Receiver;this.looped=!1,e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("time",(function(e){var n=e.position,s=e.duration;if(!n||!s)return!1;var i={seconds:n,duration:s};t.emit("timeupdate",i)}));var n=this;e.on("complete",(function(){!0===n.looped?e.seek(0):t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play(!0)})),t.on("pause",(function(){e.pause(!0)})),t.on("getPaused",(function(t){t(e.getState().toLowerCase()!=="PLAYING".toLowerCase())})),t.on("getCurrentTime",(function(t){t(e.getPosition())})),t.on("setCurrentTime",(function(t){e.seek(t)})),t.on("getDuration",(function(t){t(e.getDuration())})),t.on("getVolume",(function(t){t(e.getVolume())})),t.on("setVolume",(function(t){e.setVolume(t)})),t.on("mute",(function(){e.setMute(!0)})),t.on("unmute",(function(){e.setMute(!1)})),t.on("getMuted",(function(t){t(!0===e.getMute())})),t.on("getLoop",(function(e){e(this.looped)}),this),t.on("setLoop",(function(e){this.looped=e}),this)},r.JWPlayerAdapter.prototype.ready=function(){this.receiver.ready()},r.MockAdapter=function(){if(!(this instanceof r.MockAdapter))return new r.MockAdapter;this.init()},r.MockAdapter.prototype.init=function(){var e={duration:20,currentTime:0,interval:null,timeupdate:function(){},volume:100,mute:!1,playing:!1,loop:!1,play:function(){e.interval=setInterval((function(){e.currentTime+=.25,e.timeupdate({seconds:e.currentTime,duration:e.duration})}),250),e.playing=!0},pause:function(){clearInterval(e.interval),e.playing=!1}},t=this.receiver=new r.Receiver;t.on("play",(function(){var t=this;e.play(),this.emit("play"),e.timeupdate=function(e){t.emit("timeupdate",e)}})),t.on("pause",(function(){e.pause(),this.emit("pause")})),t.on("getPaused",(function(t){t(!e.playing)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(e.volume)})),t.on("setVolume",(function(t){e.volume=t})),t.on("mute",(function(){e.mute=!0})),t.on("unmute",(function(){e.mute=!1})),t.on("getMuted",(function(t){t(e.mute)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},r.MockAdapter.prototype.ready=function(){this.receiver.ready()},r.VideoJSAdapter=function(e){if(!(this instanceof r.VideoJSAdapter))return new r.VideoJSAdapter(e);this.init(e)},r.VideoJSAdapter.prototype.init=function(e){r.assert(e,"playerjs.VideoJSReceiver requires a player object");var t=this.receiver=new r.Receiver;e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("timeupdate",(function(n){var s=e.currentTime(),i=e.duration();if(!s||!i)return!1;var o={seconds:s,duration:i};t.emit("timeupdate",o)})),e.on("ended",(function(){t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused())})),t.on("getCurrentTime",(function(t){t(e.currentTime())})),t.on("setCurrentTime",(function(t){e.currentTime(t)})),t.on("getDuration",(function(t){t(e.duration())})),t.on("getVolume",(function(t){t(100*e.volume())})),t.on("setVolume",(function(t){e.volume(t/100)})),t.on("mute",(function(){e.volume(0)})),t.on("unmute",(function(){e.volume(1)})),t.on("getMuted",(function(t){t(0===e.volume())})),t.on("getLoop",(function(t){t(e.loop())})),t.on("setLoop",(function(t){e.loop(t)}))},r.VideoJSAdapter.prototype.ready=function(){this.receiver.ready()},void 0===(s=function(){return r}.call(t,n,t,e))||(e.exports=s)}(window,document)},93424:(e,t,n)=>{"use strict";var s;function i(e){const t=new Date;t.setHours(0,0,0,0),e.setHours(0,0,0,0);const n=(t.getTime()-e.getTime())/864e5;if(0===n)return s.TODAY;if(1===n)return s.YESTERDAY;if(n<7)return s.THIS_WEEK;const i=Math.floor(n/7);return 1===i?s.ONE_WEEK_AGO:2===i?s.TWO_WEEKS_AGO:3===i?s.THREE_WEEKS_AGO:s.OLDER}n.d(t,{T:()=>s,n:()=>i}),function(e){e.TODAY="TODAY",e.YESTERDAY="YESTERDAY",e.THIS_WEEK="THIS_WEEK",e.ONE_WEEK_AGO="ONE_WEEK_AGO",e.TWO_WEEKS_AGO="TWO_WEEKS_AGO",e.THREE_WEEKS_AGO="THREE_WEEKS_AGO",e.OLDER="OLDER"}(s||(s={}))},9876:(e,t,n)=>{"use strict";var s;n.d(t,{U:()=>s}),function(e){e.NOTE="note",e.TAG="tag",e.OBJECT="object"}(s||(s={}))},76573:(e,t,n)=>{"use strict";n.d(t,{E:()=>u});var s=n(74848),i=n(32485),o=n.n(i),r=n(24378),a=n(9876),c=n(89552),l=n(7660),d=n(844);function u({inline:e,children:t,parentId:n,canDelete:i,nonViewable:u,attachments:h,annotationType:p,onViewAttachment:m}){const g=(0,r.Rd)(),f=(0,r.hw)(),v=(e,t)=>{m&&m(t)},E=e=>n!==e.parentId?null:(0,s.jsx)(d.P,{id:e.id,fileName:e.file.name,className:"inline",progress:e.progress,error:e.error},e.id),x=p===a.U.NOTE;return(0,s.jsxs)("div",Object.assign({className:o()("annotation-attachments",{"annotation-attachments-inline":!!e,"annotation-attachments-preview":!u,"annotation-attachments-list":u})},{children:[h.map(((t,n)=>{const o=h.length,r=!e&&!u&&(0,c.rV)(t)&&(1===o||0===n&&o>2);let a,d;return x&&(e?(a=60,d=60):r||(a=140,d=140)),(0,s.jsx)(l.o,{attachment:t,inline:!!e,canDelete:!!i,hero:r,onClick:v,thumbnail:!!e||!r,width:a,height:d},t.id)})),g&&g.map(E),f&&f.map(E),t]}))}},12003:(e,t,n)=>{"use strict";n.d(t,{G:()=>ue});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(9876),c=n(91902),l=n(5272),d=n(89998),u=n(36042),h=n(40936);const{UP:p,DOWN:m,LEFT:g,RIGHT:f,UP_LEFT:v,UP_RIGHT:E,DOWN_LEFT:x,DOWN_RIGHT:b}=d.DH,y=(0,i.memo)((({className:e,onClick:t,children:n})=>{const o=(0,u.S)(),[a,c]=(0,i.useState)(null),{width:l,height:d,ref:y}=(0,h.A)(),[{width:O,height:T},C]=(0,i.useState)({width:0,height:0}),{ref:A}=(0,h.A)({onResize:({width:e,height:t})=>{null===a&&C({width:e||0,height:t||0})}});let _;if((0,i.useEffect)((()=>{if(l&&d&&O&&T&&o){let e=a;const t=o.y<T,n=o.y>d-T,s=o.x<O,i=o.x>l-O;t&&n?e=i&&!s?g:f:t?e=s?b:i?x:m:n?e=s?E:i?v:p:s&&i?e=t?m:p:s?e=f:i?e=g:null===e&&(e=f),e!==a&&c(e)}}),[o,l,d,O,T,a]),l&&o){_=a===f&&o.x>l-O?l-o.x:void 0}return(0,s.jsx)("div",Object.assign({ref:y,className:"annotations-preview-layer"},{children:o&&n&&(0,s.jsx)("div",Object.assign({ref:A,className:r()("annotation-preview",`annotation-preview-${a}`,e),style:{top:o.y,left:o.x,visibility:null===a?"hidden":void 0,width:_},onClick:t},{children:n}))}))}));var O=n(90479),T=n(91029),C=n(40826),A=n(8639),_=n(92264),S=n(99366),j=n(38216),R=n(89339);const{NOTES:N}=S.A.SHOWCASE;function k({comment:e,noteView:t}){const n=t?t.created:e.created,{userData:o}=(0,i.useContext)(C.BR),r=(0,j.Y)(),a=t?t.user.email:e.user.email,c=o.getUserDisplay(a),l=c.color,d=t?t.comments.length-1:0,u=r.t(N.REPLIES,d),h=""===e.text&&!(e.attachments.length>0)?r.t(N.CONTENT_DELETED):n.toLocaleString();return(0,s.jsxs)("header",Object.assign({className:"note-header"},{children:[(0,s.jsx)(R.E,{label:c.initials,badgeStyle:{color:l,borderColor:l}}),(0,s.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,s.jsx)("span",Object.assign({className:"note-user"},{children:c.name})),d>0&&(0,s.jsx)("span",Object.assign({className:"note-summary-info note-replies"},{children:u})),(0,s.jsx)("div",Object.assign({className:"note-subheader"},{children:h}))]}))]}))}var w=n(33361);function I(e){const{attachments:t}=e,{analytics:n}=(0,i.useContext)(C.BR);if(!(t.length>0))return null;return(0,s.jsx)(w.g,{attachments:t,onClick:(t,s)=>{n.trackToolGuiEvent("notes","notes_preview_click_attachment"),t.stopPropagation(),e.onClick(s)}})}var L=n(40194),P=n(99860),D=n(56210);function M({text:e,noteId:t}){const n=(0,P.V)(),i=(0,D.b)();return(0,s.jsx)("div",Object.assign({className:r()("note-post",{"note-summary-info":!e})},{children:e&&n&&(0,s.jsx)(L.$,{text:e,textParser:n,linkHandler:i,maxLength:150,annotationType:a.U.NOTE,annotationId:t})}))}var U=n(76573);function H(e){const t=(0,j.Y)(),{moreAttachmentsCount:n}=e;if(0===n)return null;const i=t.t(S.A.SHOWCASE.ATTACHMENTS.MORE_ATTACHMENT,n);return(0,s.jsx)("div",Object.assign({className:"attachment attachments-truncated"},{children:(0,s.jsx)("div",Object.assign({className:"attachment-view attachment-other "},{children:(0,s.jsx)("div",Object.assign({className:"attachment-label"},{children:(0,s.jsx)("div",Object.assign({className:"file-label"},{children:i}))}))}))}))}var B=n(89552),V=n(40270);const{ANNOTATIONS:F}=S.A.SHOWCASE;function G(e){const{previewId:t}=e,n=(0,i.useRef)(null),o=(0,j.Y)(),{commandBinder:l}=(0,i.useContext)(C.BR),d=(0,A.e)(t),u=(0,_.Z)(t);if((0,i.useEffect)((()=>(u&&n.current&&n.current.focus(),()=>{})),[u]),!u)return null;const h=u.comments.get(0),p=h&&h.attachments.length>0,m=h.attachments.values(),g=(0,B.c9)(m),f=(0,B.rg)(m),v=f.slice(0,V.p8),E=Math.max(f.length-V.p8,0),x=u.comments.length>1||E>0,b=o.t(F.READ_MORE_MESSAGE),y=r()("annotation-preview-contents","note-preview-contents",{"viewable-media":p});return(0,s.jsxs)("div",Object.assign({ref:n,role:"dialog",tabIndex:0,className:y,onClick:t=>{t.stopPropagation(),e.onClick()},onKeyDown:e=>{"Escape"===e.code&&(e.stopPropagation(),l.issueCommand(new c.ZR))}},{children:[h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I,{attachments:g,onClick:e.onClick}),(0,s.jsx)(k,{noteView:u,comment:h}),(0,s.jsx)(M,{text:h.text,noteId:t}),(0,s.jsx)(U.E,Object.assign({annotationType:a.U.NOTE,attachments:v},{children:(0,s.jsx)(H,{moreAttachmentsCount:E})}))]}),d&&(0,s.jsxs)("div",Object.assign({className:"nested-comment-preview"},{children:[(0,s.jsx)(k,{comment:d}),(0,s.jsx)(M,{text:d.text,noteId:t})]})),x&&(0,s.jsx)("div",Object.assign({className:"link link-more"},{children:b}))]}))}var W=n(53360),K=n(57682),Y=n(92733),$=n(24850),z=n(63348),X=n(52385),J=n(61643),q=n(87243);const{TAGS:Q}=S.A.SHOWCASE;function Z(e){const{tag:t,tagType:n,capabilities:o}=e,{analytics:l,commandBinder:d,editMode:u,locale:h}=(0,i.useContext)(C.BR),p=u?h.t(Q.EDIT_TAG_LABEL):void 0,m=u?"toggle-pencil":"dock",g=u?void 0:h.t(Q.DOCK_TAG_LABEL),f=t.id,v=(0,i.useCallback)((e=>{e.stopPropagation(),u&&n===a.U.OBJECT?(l.trackToolGuiEvent("object_tags","object_tags_billboard_edit_tag"),d.issueCommand(new q.y_(f))):(l.trackToolGuiEvent("tags",u?"tags_billboard_edit_tag":"tags_billboard_dock_tag"),d.issueCommand(new c.y8(f,n)))}),[u,n,l,d,f]);return n!==a.U.OBJECT||u?o.share||o.dock?(0,s.jsxs)("header",Object.assign({className:r()("tag-billboard-header",{editable:u})},{children:[!u&&o.share&&(0,s.jsx)(J.k,{prefix:"tag",pin:t,id:t.id,darkTheme:!0,includeCameraView:!0,analyticAction:"tags_copy_share_link",buttonVariant:X.Ak.TERTIARY}),o.dock&&(0,s.jsx)(X.$n,{icon:m,label:p,size:X.Mp.SMALL,variant:X.Ak.TERTIARY,theme:"dark",onClick:v,reverse:!0,tooltip:g,tooltipOptions:{placement:"bottom"}})]})):(0,s.jsx)("div",{}):null}var ee=n(16552),te=n(44246),ne=n(47952),se=n(93612);const ie=(0,ne.v)(se.j);var oe=n(69831);const re=(0,ne.v)(oe.$);var ae=n(16603),ce=n(20764);const{ANNOTATIONS:le}=S.A.SHOWCASE;function de({onClick:e,previewId:t,previewType:n}){const o=new K.r({links:!0}),l=(0,te.s)(),{commandBinder:d,editMode:u}=(0,i.useContext)(C.BR),h=(0,O.d)(),p=(0,Y.G)(),m=ie(),g=re(),f=(0,j.Y)(),v=(0,$.J)(),E=(0,i.useRef)(null),[x,b]=(0,i.useState)(!1),[y,T]=(0,i.useState)(null),[A,_]=(0,i.useState)({dock:!0,share:!0}),S=(0,ae.i)(ce.GK,!0),R=(0,ae.i)(ce.AM,!0),N="true"===(0,ae.i)(ce.$Q,!1),k=(0,i.useCallback)((e=>{l.trackToolGuiEvent("tags",e)}),[l]),w=(0,i.useCallback)(((t,n)=>{k("tags_billboard_click_attachment"),e(n)}),[e,k]),I=(0,i.useCallback)((t=>{k(u?"tags_billboard_click_to_edit":"tags_billboard_click_to_dock"),t.stopPropagation(),e()}),[e,k,u]),P=(0,i.useCallback)((e=>{b(e)}),[]);(0,i.useEffect)((()=>(y&&E.current&&E.current.focus(),()=>{})),[y]),(0,i.useEffect)((()=>{if(p&&m)switch(n){case a.U.OBJECT:const e=null==g?void 0:g.getObjectTag(t);if(!e)return;const s=e.mattertagId?m.getTag(e.mattertagId):void 0,i=e.toTagView(s);T(Object.assign({},i));break;case a.U.TAG:const o=m.getTag(t),r=p.getTagView(t);if(!o||!r)return void T(null);function c(){const e=null==h?void 0:h.getCapabilities(t);return e&&_(Object.assign({},e)),e}T(Object.assign({},r));const l=c(),d=null==l?void 0:l.onChanged(c),u=o.onChanged((()=>{const e=p.getTagView(t);e&&T(Object.assign({},e))}));return()=>{null==d||d.cancel(),u.cancel()}}}),[h,m,g,t,n,p]);if(!y)return null;const{id:D,label:M,attachments:F,description:G,keywords:X}=y,J=(0,B.c9)(F),q=J.length>0,Q=(0,B.rg)(F),ne=F.some((e=>e.mediaType===W.zu.VIDEO)),se=Math.max(Q.length-V.p8,0);se>0&&(Q.length=V.p8);const oe=f.t(le.READ_MORE_MESSAGE),de=(0,s.jsx)(z.P,{attachments:J,onClick:w}),ue=M&&(0,s.jsx)("div",Object.assign({className:"tag-billboard-title"},{children:M})),he=r()("annotation-preview-contents","tag-billboard",{"viewable-media":q,"has-video":ne});return(0,s.jsxs)("div",Object.assign({ref:E,role:"dialog",tabIndex:0,className:he,onClick:I,onKeyDown:e=>{"Escape"===e.code&&(e.stopPropagation(),d.issueCommand(new c.ZR))}},{children:[(0,s.jsx)(Z,{tag:y,tagType:n,capabilities:{share:S&&A.share,dock:R&&A.dock}}),(0,s.jsxs)("div",Object.assign({className:"tag-billboard-contents"},{children:[M?(()=>{const e=N?ue:de,t=N?de:ue;return(0,s.jsxs)(s.Fragment,{children:[e,t]})})():de,G&&(0,s.jsx)("div",Object.assign({className:"tag-billboard-description"},{children:(0,s.jsx)(L.$,{text:G,textParser:o,linkHandler:v,annotationType:a.U.TAG,annotationId:D,maxLength:100,maxLines:4,onTruncationChange:P})})),X&&(0,s.jsx)(ee.B,{keywords:X,theme:"dark",className:"tag-previewer-keywords"}),Q.length>0&&(0,s.jsx)(U.E,Object.assign({annotationType:a.U.TAG,attachments:Q},{children:(0,s.jsx)(H,{moreAttachmentsCount:se})})),x&&(0,s.jsx)("div",Object.assign({className:"annotation-read-more"},{children:(0,s.jsx)("span",Object.assign({className:"link link-more"},{children:oe}))}))]}))]}))}const ue=(0,i.memo)((({notesEnabled:e,openModal:t})=>{const{messageBus:n,analytics:o,commandBinder:d}=(0,i.useContext)(C.BR),{billboardAnnotation:u,selectedAnnotation:h,dockedAnnotation:p}=(0,T.J)((0,O.d)())||{},m=(null==u?void 0:u.annotationType)===a.U.TAG,g=(null==u?void 0:u.annotationType)===a.U.OBJECT,f=e&&(null==u?void 0:u.annotationType)===a.U.NOTE,v=(0,i.useCallback)((()=>{u&&(o.trackGuiEvent(`annotations_dock_${u.annotationType}`),d.issueCommand(new c.y8(u.id,u.annotationType)))}),[o,u,d]),E=(0,i.useCallback)((()=>{u&&(o.trackGuiEvent(`annotations_select_${u.annotationType}`),d.issueCommand(new c.xo(u.id,u.annotationType)))}),[o,u,d]),x=(0,i.useCallback)((e=>{if(u){o.trackGuiEvent(f?"click_note_preview":"tags_click_tag_billboard");const{id:t,annotationType:s}=u;e&&!p||g||v(),e&&n.broadcast(new l.z(s,t,e))}}),[u,o,p,g,f,v,n]),b=(0,i.useCallback)((()=>{if(u)if(h)d.issueCommand(new c.XK(u.id,u.annotationType));else{f||p?v():E()}}),[u,d,v,p,f,E,h]);return t?null:(0,s.jsx)(y,Object.assign({className:r()({"tag-preview":m||g,"note-preview":f}),onClick:b},{children:m||g?(0,s.jsx)(de,{previewId:u.id,previewType:u.annotationType,onClick:x}):f?(0,s.jsx)(G,{previewId:u.id,onClick:x}):null}),null==u?void 0:u.id)}))},40194:(e,t,n)=>{"use strict";n.d(t,{$:()=>v});var s=n(74848),i=n(96540),o=n(72909),r=n(40826),a=n(25591),c=n(1665),l=n(91902),d=n(5272),u=n(52147),h=n(66172),p=n(76573),m=n(58919),g=(n(5444),function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r}),f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let v=class extends i.Component{constructor(e){super(e),this.onTextReplaced=e=>{const{onTruncationChange:t}=this.props,n=this.state.truncated;this.setState({truncated:e}),t&&n!==e&&t(e)},this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;if(e.stopPropagation(),n){const{annotationType:s,annotationId:i,linkHandler:o}=this.props,r={blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id};if(n===a.n.LINK&&o&&r.value){e.preventDefault();const t=(0,c.A)(r.value),{url:n,modelId:a,pose:d}=t;a?o.handler.openLink({fullLink:n,modelId:a}):d?(o.handler.openLink({fullLink:n,pose:d}),this.context.commandBinder.issueCommand(new l.XK(i,s))):(o.handler.openLink(n),this.context.messageBus.broadcast(new h.Qn(n)))}this.context.messageBus.broadcast(new d.v(s,i,r))}},this.state={truncated:!1}}renderAttachments(e){if(0===e.length)return null;const{onViewAttachment:t,annotationType:n}=this.props;return(0,s.jsx)(p.E,{attachments:e,onViewAttachment:t,annotationType:n})}render(){const{settings:e}=this.context,{text:t,textParser:n,edited:i,attachments:o,maxLength:r,maxLines:a,readMore:c}=this.props,{truncated:l}=this.state,d=e.tryGetProperty(u.qu,!1);return(0,s.jsxs)("div",Object.assign({className:"annotation-box"},{children:[(0,s.jsx)("div",Object.assign({className:"annotation-text-box"},{children:(0,s.jsx)(m.A,{text:t,textParser:n,onClickAnchor:d?void 0:this.onClickAnchor,clickableLinks:!d,onTextReplaced:this.onTextReplaced,maxLength:r,maxLines:a,readonly:!0})})),i&&(0,s.jsx)("div",Object.assign({className:"annotation-edited"},{children:"(edited)"})),c&&l&&(0,s.jsx)("div",Object.assign({className:"annotation-read-more"},{children:(0,s.jsx)("span",Object.assign({className:"link link-more"},{children:c}))})),o&&!d&&this.renderAttachments(o)]}))}};v.contextType=r.BR,v=g([o.A,f("design:paramtypes",[Object])],v)},90479:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var s=n(47952),i=n(87513);const o=(0,s.v)(i.o)},76217:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var s=n(96540),i=n(90479);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(e?e.dockedAnnotation:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){n(e?e.dockedAnnotation:null)}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}(0,n(29633).c)("dockedAnnotation",o)},5272:(e,t,n)=>{"use strict";n.d(t,{v:()=>o,z:()=>i});var s=n(14754);class i extends s.QB{constructor(e,t,n){super(),this.annotationType=e,this.id=t,this.attachmentId=n}}class o extends s.QB{constructor(e,t,n){super(),this.block=n,this.id=t,this.annotationType=e}}},21891:(e,t,n)=>{"use strict";n.d(t,{dT:()=>i,db:()=>r,q2:()=>o});var s=n(9876);function i(e,t){return!!t&&t.id===e.getCurrentUserId()}function o(e,t,n){if(t===s.U.NOTE){return e.isCommenter()&&i(e,n)}return e.isEditor()}function r(e,t,n){if(t===s.U.NOTE){return e.isCommenter()&&i(e,n)||e.isOrgAdmin()}return e.isEditor()}},55848:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var s=n(61589),i=n(54998),o=n(20489);class r extends s.B{constructor(){super(),this.name="attachments-data",this.pendingAttachments=(0,i.y)(),this.removedAttachments=(0,i.y)(),this.currentUploads=(0,i.y)(),this.failedUploads=(0,i.y)()}iteratePending(e){for(const t of this.pendingAttachments)e(t)}iterateRemoved(e){for(const t of this.removedAttachments)e(t)}get pendings(){return this.pendingAttachments}get removals(){return this.removedAttachments}getPendingAttachment(e){return this.pendingAttachments.get(e)}getRemovedAttachment(e){return this.removedAttachments.get(e)}addPending(e){this.pendingAttachments.set(e.id,e)}removePendingAttachment(e){this.pendingAttachments.has(e)&&this.pendingAttachments.delete(e)}clearPending(){this.pendingAttachments.clear()}getPendingAttachmentsForAsset(e,t){const n=[];return this.iteratePending((s=>{s.parentType===t&&s.parentId===e&&n.push(s)})),n}getRemovedAttachmentsForAsset(e,t){const n=[];return this.iterateRemoved((s=>{s.parentType===t&&s.parentId===e&&n.push(s)})),n}markAttachmentForDelete(e){const t=new o.o(e);this.removedAttachments.set(t.id,t)}clearRemovals(){this.removedAttachments.clear()}get uploads(){return this.currentUploads}addUpload(e){this.uploads.set(e.id,e)}updateUpload(e){this.uploads.has(e.id)&&this.uploads.set(e.id,e)}removeUpload(e){this.uploads.has(e)&&this.uploads.delete(e)}clearUploads(){this.uploads.clear()}get failures(){return this.failedUploads}addFailure(e){this.failures.set(e.id,e)}removeFailure(e){this.failures.has(e)&&this.failures.delete(e)}clearFailures(){this.failures.clear()}}},7660:(e,t,n)=>{"use strict";n.d(t,{o:()=>te});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(40826),c=n(4234),l=n(53360),d=n(44246),u=n(61412),h=n(55285),p=n(99366),m=n(72909),g=n(79679),f=n(35652),v=n(70767);class E extends i.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,onClick:i,style:o}=this.props,a=r()("oembed","oembed-text",e,{"oembed-text--cover":t}),c=n.provider_name?`${n.provider_name} content`:"Embedded content",l=n.author_name?`from ${n.author_name}`:"";return(0,s.jsxs)("div",Object.assign({className:a,style:o,onClick:i},{children:[n.title&&(0,s.jsx)("h3",{children:n.title}),(0,s.jsx)("p",{children:`${c} ${l}`})]}))}}const x=["soundcloud","spotify"];class b extends i.Component{constructor(e){super(e)}getAttributes(){const{data:e}=this.props;let t=e.thumbnail_url,n=e.thumbnail_width,s=e.thumbnail_height;return(!t||!n||!s)&&e.type===g.n.PHOTO&&(t=e.url,n=e.width,s=e.height),{url:t,width:n,height:s}}render(){const{className:e,cover:t,data:n,disabled:i,maxHeight:o,maxWidth:a,onClick:c,style:l}=this.props,{url:d,width:u,height:h}=this.getAttributes();if(!d||!u||!h)return(0,s.jsx)(E,Object.assign({},this.props));const p=function(e,t){return e<128||t<128}(u,h),m=!i&&function(e){const t=(e.provider_name||"").toLowerCase();return e.type===g.n.VIDEO?"giphy"!==t:!(e.type!==g.n.RICH||!x.includes(t))}(n),f=r()("oembed","oembed-thumbnail",e,{"oembed-thumbnail--cover":t,"oembed-thumbnail--cover--icon":t&&p}),b=Object.assign(Object.assign({},l),{backgroundImage:`url('${d}')`});if(!t){const{width:e,height:t}=function(e,t,n,s){let i=e,o=t;if(n&&i>n){const e=n/i;i*=e,o&&(o*=e)}if(o&&s&&o>s){const e=s/o;i*=e,o*=e}return{width:i,height:o}}(u,h,a,o);b.width=`${e}px`,b.height=`${t}px`}return t&&p&&(b.maxWidth=1.5*u+"px"),(0,s.jsx)("div",Object.assign({className:f,style:b,onClick:i?void 0:c},{children:m&&(0,s.jsx)(v.K0,{className:"oembed-thumbnail__cta",iconClass:"icon-play-unicode",buttonStyle:v.zt.OVERLAY,buttonSize:v.Tp.LARGE})}))}}const y=({id:e,className:t,onClick:n,url:o,cover:a,style:c,containerWidth:l})=>{const{height:d}=(0,h.lW)(),u=(0,i.useCallback)((t=>{n&&n(t,e)}),[n,e]),p=r()({"image-cover":!!a},t),m=4/3,g=.8*d,f=Math.min(Math.round(l/m),g);return(0,s.jsxs)("div",Object.assign({className:r()("oembed-image fill-cover-image",p),style:Object.assign(Object.assign({},c),{minHeight:f,maxWidth:l}),onClick:n?u:void 0},{children:[(0,s.jsx)("div",{className:"fill-blur",style:{backgroundImage:`url('${o}')`}}),(0,s.jsx)("img",{className:r()("image",p),src:o,style:{maxHeight:Math.min(g,Math.round(l*m))},onClick:n?u:void 0})]}))};class O extends i.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,onClick:i,style:o,containerWidth:a}=this.props,c=r()("oembed","oembed-photo",e,{"oembed-photo--cover":t});return(0,s.jsx)(y,{url:n.url,style:o,onClick:i,className:c,containerWidth:a})}}var T=n(8430);function C(e){const{className:t,children:n}=e;if(!n)return null;const i=r()("oembed","oembed-loading",t);return(0,s.jsx)("div",Object.assign({className:i},{children:n}))}var A=n(78331);const _={flickr:!0,instagram:!0},S=/^<iframe.*>.*<\/iframe>$/;function j(e){return S.test(e)}function R(e,t){let n;return n=j(e)?function(e){const t=document.createElement("div");t.innerHTML=e;const n=t.firstChild,s=n.style;return s.maxWidth="100%",s.maxHeight="100%",s.minWidth="",s.minHeight="",n}(e):function(e,t){const n=document.createElement("iframe");n.setAttribute("allow","encrypted-media; autoplay; fullscreen");let s="";return s=t&&t===A.K.Instagram?"\n      <style>\n        html, body { padding: 0; margin: 0; border: 0; }\n        img { display: block; max-width: 100%; height: auto; border: 0; }\n        iframe { display: block; max-width: 100%; border: 0; }\n      </style>\n    ":"\n      <style>\n        html, body { padding: 0; margin: 0; border: 0; }\n        img, iframe { display: block; max-width: 100%; height: auto; border: 0; }\n      </style>\n    ",n.srcdoc=`<!doctype html>${s.replace(/\s+/g," ")}${e}`,n}(e,t),n.src||(e=>void 0!==e&&!!_[e.toLowerCase()])(t)?n.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-presentation"):n.setAttribute("sandbox","allow-same-origin"),n}var N=n(40270);function k(e){const{className:t,data:n,loadingComponent:o,onClick:a,style:c,onLoad:l}=e,[d,u]=(0,i.useState)(),[h,p]=(0,i.useState)(),[m,f]=(0,i.useState)(!0),[v,E]=(0,i.useState)(n.height);(0,i.useLayoutEffect)((()=>{const e=d;let t=null;if(e){for(;e.lastChild;)e.removeChild(e.lastChild);const s=R(n.html,n.provider_name);s.onload=()=>{l&&s&&l(s),f(!1)},e.appendChild(s),t=e=>{const t=(e=>{let t;try{t=JSON.parse(e.data)}catch(e){return}if("iframe.resize"!==t.context)return;const n=t.src.replace(/http(s?):\/\//,"//"),s=document.querySelector('iframe[src="'+n+'"]');return s?{iframe:s,height:t.height}:void 0})(e);t&&t.iframe===s&&E(t.height)},window.addEventListener("message",t)}return()=>{t&&window.removeEventListener("message",t)}}),[d,n.html,n.provider_name,l]);const x=(0,i.useCallback)((e=>{e&&(p(e.offsetWidth),u(e))}),[]),b=(0,i.useMemo)((()=>{var e;if(!v||!h)return"30%";let t;if((null===(e=n.provider_name)||void 0===e?void 0:e.toLowerCase())===A.K.Flickr)t=(n.height||n.thumbnail_height||220)/n.width;else{let e=v||n.height||n.thumbnail_height||220;n.type===g.n.VIDEO&&window.innerWidth>=N.K$&&(e*=1.3),t=e/h}return`${Math.max(30,100*t).toPrecision(4)}%`}),[v,h,n.height,n.width,n.thumbnail_height,n.provider_name,n.type]);return(0,s.jsxs)("div",Object.assign({className:r()("oembed-iframe--wrapper",t),style:c,onClick:a},{children:[(0,s.jsx)(C,Object.assign({className:m?"":"is-loaded"},{children:o})),(0,s.jsx)("div",{className:r()("oembed-iframe__container",n.provider_name&&`oembed-iframe--src-${n.provider_name.replace(/\s/g,"-")}`,m&&"is-loading"),ref:x,style:{paddingBottom:b}})]}))}var w=n(93607);const I=new f.Ay("oembed-video");class L extends i.Component{constructor(){super(...arguments),this.isUnmounting=!1,this.onIFrameLoad=async e=>{if(!this.isUnmounting)try{const t=await function(e){const t=new w.Player(e);return new Promise(((e,n)=>{t.on("ready",(()=>{e(t)}))}))}(e);if(this.isUnmounting)return;(0,T.Fr)()||t.play()}catch(e){I.warn("unable to autoplay video"),I.warn(e)}}}componentWillUnmount(){this.isUnmounting=!0}render(){const{className:e,cover:t}=this.props;if(t)return(0,s.jsx)(b,Object.assign({},this.props));const n=r()("oembed","oembed-video",e);return(0,s.jsx)(k,Object.assign({},this.props,{className:n,onLoad:this.onIFrameLoad}))}}const P=e=>{const{className:t,cover:n}=e;if(n)return(0,s.jsx)(b,Object.assign({},e));const i=r()("oembed","oembed-rich",t);return(0,s.jsx)(k,Object.assign({},e,{className:i}))};function D(e){const{children:t,className:n}=e;if(!t)return null;const i=r()("oembed","oembed-error",n);return(0,s.jsx)("div",Object.assign({className:i},{children:t}))}const M=new f.Ay("oembed-errors");class U extends i.Component{constructor(e){super(e),this.state={caughtError:void 0}}static getDerivedStateFromError(e){return{caughtError:e}}componentDidCatch(e){M.warn(e.message)}componentDidUpdate(e){var t,n;e.data!==this.props.data&&this.setState({caughtError:void 0}),e.error!==this.props.error&&(null===(n=(t=this.props).onError)||void 0===n||n.call(t))}render(){const{className:e,cover:t,data:n,disabled:i,renderError:o,loadingComponent:r,maxHeight:a,maxWidth:c,onClick:l,style:d,thumbnail:u,error:h,containerWidth:p}=this.props,{caughtError:m}=this.state;if(o&&(h||m))return(0,s.jsx)(D,Object.assign({className:e},{children:o(h,m)}));if(!n)return(0,s.jsx)(C,Object.assign({className:e},{children:r}));const f={className:e,cover:t,maxHeight:a,maxWidth:c,onClick:l,style:d,containerWidth:p};return u?(0,s.jsx)(b,Object.assign({data:n,disabled:i},f)):n.type===g.n.PHOTO?(0,s.jsx)(O,Object.assign({data:n},f)):n.type===g.n.VIDEO?(0,s.jsx)(L,Object.assign({data:n,loadingComponent:r},f)):n.type===g.n.RICH?(0,s.jsx)(P,Object.assign({data:n,loadingComponent:r},f)):null}}var H=n(38216),B=n(38963);const{ATTACHMENTS:V}=p.A.SHOWCASE,F={200:V.ERROR_200_MESSAGE,401:V.ERROR_401_MESSAGE,403:V.ERROR_403_MESSAGE,404:V.ERROR_404_MESSAGE,429:V.ERROR_429_MESSAGE},G=({error:e,compact:t,scriptError:n})=>{const[o,r]=(0,i.useState)(null),a=(0,H.Y)(),c=(null==e?void 0:e.status)&&(e=>{const t=F[e];if(t)return t;switch(Math.floor(+e/100)){case 2:return V.ERROR_200_MESSAGE;case 4:return V.ERROR_4XX_MESSAGE;case 5:return V.ERROR_5XX_MESSAGE}})(e.status),l=n?n.message:a.t(c||V.FAILED_TO_LOAD_MESSAGE),d=(0,i.useCallback)((e=>{r(e)}),[]);return(0,s.jsx)("div",Object.assign({className:"embed-error-container",ref:d},{children:t?(0,s.jsx)(B.m,{title:l,target:o}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"icon icon-error"}),(0,s.jsx)("div",Object.assign({className:"embed-error-message"},{children:l}))]})}))};var W=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},K=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Y=class extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.handleError=()=>{const{onError:e}=this.props;e&&e(this.props.attachment.parentId)},this.renderError=(e,t)=>{const{compact:n}=this.props;return(0,s.jsx)(G,{error:e,scriptError:t,compact:n})},this.state={embed:null,error:void 0}}componentDidMount(){this.getEmbeddedMedia()}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){this.props.attachment.id!==e.attachment.id&&this.getEmbeddedMedia()}async getEmbeddedMedia(){const{attachment:e}=this.props,{commandBinder:t}=this.context;let n,s=null;try{if(s=await t.issueCommand(new c.ib(e)),!s)throw new Error("embed not found")}catch(e){n=e}this.isUnmounting||this.setState({attachmentId:e.id,embed:s,error:n})}render(){const{compact:e,height:t,width:n,onClick:i,style:o,thumbnail:a,containerWidth:c}=this.props,{embed:l,error:d}=this.state,u=l&&this.state.attachmentId===this.props.attachment.id,h=(0,s.jsx)("div",{className:"gui-spinner-icon"}),p=!!n&&!!t,m=r()("embedded-media",{clickable:i&&!d});return(0,s.jsx)(U,{className:m,data:u&&null!=l?l:void 0,style:o,cover:p,loadingComponent:h,renderError:this.renderError,error:d,thumbnail:a,disabled:e,maxWidth:n,maxHeight:t,onClick:d?void 0:i,onError:this.handleError,containerWidth:c})}};Y.contextType=a.BR,Y=W([m.A,K("design:paramtypes",[Object])],Y);var $=n(89552),z=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},X=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ATTACHMENTS:J}=p.A.SHOWCASE;let q=class extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.setDownloadLinkRef=e=>{this.setState({downloadLinkRef:e})},this.state={displayUrl:"",downloadUrl:"",downloadLinkRef:null}}componentDidMount(){this.loadUrls()}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){e.attachment.id!==this.props.attachment.id&&this.loadUrls()}getImageUrl(){const{attachment:e,cover:t,smartWidth:n,smartHeight:s}=this.props,{displayUrl:i}=this.state;if(!(0,$.rV)(e))return null;if(!t||void 0===n||void 0===s||!(0,$.QQ)(e))return i;const o=-1!==i.indexOf("?");return`${i}${o?"&":"?"}height=${s}&crop=${n}:${s},smart`}async loadUrls(){var e;const{attachment:t,thumbnail:n}=this.props,[s,i]=await Promise.all([n&&t.thumbnailUrl?t.thumbnailUrl.get():t.url.get(),null===(e=t.downloadUrl)||void 0===e?void 0:e.get()]);this.isUnmounting||this.setState({displayUrl:s,downloadUrl:null!=i?i:""})}onDownloadClicked(e){e.stopPropagation(),this.context.analytics.trackGuiEvent("attachment_media_download_clicked",{data:this.props.attachment.mimeType})}render(){const{attachment:e,inline:t,onClick:n,style:i,containerWidth:o}=this.props,{id:a,category:c,filename:d,bytes:u}=e;if(c!==l._A.UPLOAD)return null;const h=this.getImageUrl(),p=r()("attachment-view",{clickable:!!n});if(h)return(0,s.jsx)(y,{id:a,url:h,style:i,onClick:n,className:p,containerWidth:o});{const{downloadUrl:e,downloadLinkRef:o}=this.state,a=this.context.locale.t(J.DOWNLOAD_TOOLTIP),c=u?(0,$.X6)(u):"";return(0,s.jsxs)("div",Object.assign({className:r()(p,"attachment-other",{inline:t}),onClick:n,style:i},{children:[!t&&(0,s.jsx)("div",{className:"icon icon-paper-clip"}),(0,s.jsxs)("div",Object.assign({className:"attachment-label"},{children:[(0,s.jsx)("div",Object.assign({className:"file-label"},{children:d})),c&&!t&&(0,s.jsx)("div",Object.assign({className:"size-label"},{children:c}))]})),!t&&e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",Object.assign({className:"link download-link",ref:this.setDownloadLinkRef,href:e,download:!0,onClick:e=>{this.onDownloadClicked(e)}},{children:(0,s.jsx)("span",{className:"icon-download"})})),(0,s.jsx)(B.m,{target:o,title:a})]})]}))}}};q.contextType=a.BR,q=z([m.A,X("design:paramtypes",[Object])],q);var Q=n(52385);function Z({id:e,width:t,height:n,srcDoc:o,onLoad:r}){const a=new URLSearchParams(new URL(e,window.location.href).search).get("parent"),c=(0,i.useCallback)((function(e){r(e.currentTarget,a||"")}),[r,a]);return(0,s.jsx)("iframe",{style:{width:t?`${t}px`:"100%",height:n?`${n}px`:"100%",border:0},srcDoc:o,onLoad:c,referrerPolicy:"no-referrer",sandbox:"allow-scripts"},e)}const{ATTACHMENTS:ee}=p.A.SHOWCASE,te=({attachment:e,onClick:t,inline:n,canDelete:o,hero:p,containerWidth:m,width:g,height:f,thumbnail:v,onError:E,onDelete:x})=>{const{commandBinder:b,locale:y}=(0,i.useContext)(a.BR),O=(0,d.s)(),[T,C]=(0,i.useState)(null),[A,_]=(0,h.Lh)(),S=(0,i.useMemo)((()=>y.t(ee.DELETE_ATTACHMENT_TOOLTIP)),[y]),j=(0,$.rV)(e),R=(0,u.L)(),N={attachment:e,thumbnail:v,containerWidth:m||_.width||0,onClick:t?n=>{t&&t(n,e.id)}:void 0};return(0,s.jsxs)("div",Object.assign({className:r()("attachment",`attachment-${e.category}`,{inline:!!n,hero:!!p,"non-viewable":!j}),ref:A},{children:[e.category===l._A.UPLOAD?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",Object.assign({className:"attachment-preview",ref:C},{children:(0,s.jsx)(q,Object.assign({},N,{inline:n}))})),o&&(null==e?void 0:e.filename)&&(0,s.jsx)(B.m,{target:T,title:e.filename})]}):e.category===l._A.EXTERNAL?(0,s.jsx)(Y,Object.assign({},N,{compact:n,width:g,height:f,onError:E})):ne(e)?(0,s.jsx)(Z,{id:e.src,width:e.width,height:e.height,srcDoc:e.srcDoc,onLoad:e.onLoad}):(0,s.jsx)("div",{children:"Unknown Attachment Category"}),o&&(0,s.jsx)(Q.$n,{icon:"close",className:"attachment-delete",size:Q.Mp.SMALL,variant:Q.Ak.FAB,theme:"dark",tooltip:S,tooltipOptions:{placement:"bottom-start"},onClick:t=>{t.stopPropagation(),t.preventDefault(),o&&(O.trackGuiEvent("attachments_click_remove",{tool:R}),x?x(e):b.issueCommand(new c.fz(e)))}})]}))};function ne(e){return e.category===l._A.SANDBOX}},33361:(e,t,n)=>{"use strict";n.d(t,{g:()=>g});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(55285),c=n(40936),l=n(52385),d=n(61412),u=n(7660),h=n(70767),p=n(44246),m=n(2923);const g=({attachments:e,onClick:t,onNavigate:n,startIndex:o=0,onError:l})=>{const g=(0,p.s)(),[v,{width:E}]=(0,a.Lh)(),x=(0,m.w)(),{ref:b,height:y}=(0,c.A)({box:"border-box"}),[O,T]=(0,i.useState)(o),[C,A]=(0,i.useState)(),_=e.length,S=(0,d.L)();(0,i.useEffect)((()=>{o!==O&&T(o)}),[o,e]),(0,i.useEffect)((()=>{A(x?0:y)}),[y,x]);const j=(0,i.useCallback)((e=>{e.stopPropagation();const t=O+1<_?O+1:0;g.trackGuiEvent("attachments_viewer_next",{tool:S}),T(t),n&&n(t)}),[O,_,g,S,n]),R=(0,i.useCallback)((e=>{e.stopPropagation();const t=O>0?O-1:_-1;g.trackGuiEvent("attachments_viewer_prev",{tool:S}),T(t),n&&n(t)}),[O,_,g,S,n]),N=(0,i.useCallback)(((e,t)=>{e.stopPropagation();const s=t;g.trackGuiEvent("attachments_viewer_dot_clicked",{tool:S}),T(s),n&&n(s)}),[g,S,n]),k=e[O];if(!k)return null;const w=_>1;return(0,s.jsxs)("div",Object.assign({className:"attachment-carousel",ref:v},{children:[(0,s.jsx)("div",Object.assign({className:"attachment-carousel-view",style:{height:C}},{children:(0,s.jsx)("div",Object.assign({className:"attachment-container",ref:b},{children:(0,s.jsx)(u.o,{attachment:k,onClick:t,thumbnail:!1,containerWidth:E||318,onError:l})}))})),w&&(0,s.jsx)(h.K0,{className:r()("modal-nav","modal-prev"),iconClass:"icon-dpad-left",onClick:R}),w&&(0,s.jsx)(h.K0,{className:r()("modal-nav","modal-next"),iconClass:"icon-dpad-right",onClick:j}),w&&(0,s.jsx)("div",Object.assign({className:"carousel-bullets"},{children:e.map(((e,t)=>(0,s.jsx)(f,{index:t,active:t===O,onSelect:N},t)))}))]}))};function f({index:e,active:t,onSelect:n}){return(0,s.jsx)(l.$n,{icon:"simple-tag",onClick:t=>n(t,e),className:r()("carousel-bullet",{"carousel-bullet-active":t})})}},45518:(e,t,n)=>{"use strict";n.d(t,{o:()=>y});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=n(44158),l=n(83910),d=n(55649),u=n(52775),h=n(4234),p=n(72380),m=n(33361),g=n(99167),f=n(40826),v=n(99366),E=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},x=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ATTACHMENTS:b}=v.A.SHOWCASE;let y=class extends i.Component{constructor(e){super(e),this.bindings=[],this.onKey=async e=>{const{attachments:t,attachmentIndex:n}=this.state,s=t.length;let i=-1;switch(e.keyCode){case c.D.ESCAPE:e.stopPropagation(),this.closeAttachmentViewer();break;case c.D.LEFTARROW:e.stopPropagation(),i=n-1,i<0&&(i=s-1);break;case c.D.RIGHTARROW:e.stopPropagation(),i=n+1,i>=s&&(i=0)}-1!==i&&this.setState({attachmentIndex:i})},this.closeAttachmentViewer=()=>{this.state.open&&this.context.commandBinder.issueCommand(new h.ht(!1))},this.onModalToggled=e=>{e.modal!==l.a.ATTACHMENT||e.open||this.closeAttachmentViewer()},this.onViewerClosed=()=>{this.state.open&&(this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.X(l.a.ATTACHMENT,!1)),this.setState({open:!1}))},this.onNavigate=e=>{this.setState({attachmentIndex:e})},this.onViewAttachments=e=>{const{attachments:t,attachmentId:n}=e,s=n||this.getCurrentAttachmentId(),i=t.findIndex((e=>e.id===s));0===t.length||-1===i?this.closeAttachmentViewer():(this.state.open||(this.context.mainDiv.getRootNode().addEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.X(l.a.ATTACHMENT,!0)),this.setState({open:!0})),this.setState({attachments:t,attachmentIndex:i}))},this.state={open:!1,attachmentIndex:-1,attachments:[]}}componentDidMount(){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(p.FA,this.onViewAttachments),e.subscribe(p.hd,this.onViewerClosed),e.subscribe(u.rn,this.onModalToggled))}componentWillUnmount(){for(const e of this.bindings)e.cancel();this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0})}getCurrentAttachmentId(){var e;const{attachmentIndex:t,attachments:n}=this.state;return(null===(e=n[t])||void 0===e?void 0:e.id)||void 0}render(){const{open:e,attachments:t,attachmentIndex:n}=this.state,{locale:i}=this.context,o=i.t(b.CLOSE_TOOLTIP),r=i.t(b.VIEWER_INDEX_COUNT,{currentNumber:n+1,totalNumber:t.length});return(0,s.jsx)("div",Object.assign({className:a()("overlay-layer","attachment-overlay",{open:e})},{children:e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",Object.assign({className:"overlay-top-bar"},{children:[(0,s.jsx)("div",Object.assign({className:"overlay-label"},{children:r})),(0,s.jsx)(g.J,{theme:"overlay",tooltip:o,onClose:this.closeAttachmentViewer})]})),(0,s.jsx)(m.g,{attachments:t,startIndex:n,onNavigate:this.onNavigate})]})}))}};y.contextType=f.BR,y=E([o.A,x("design:paramtypes",[Object])],y)},844:(e,t,n)=>{"use strict";n.d(t,{P:()=>b});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(40826),l=n(4234),d=n(53360),u=n(91607),h=n(99366),p=n(63591),m=n(26854),g=n(38963),f=n(52385),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ATTACHMENTS:x}=h.A.SHOWCASE;let b=class extends i.Component{constructor(e){super(e),this.setContainerRef=e=>{this.setState({containerRef:e})},this.handleCancelClick=e=>{e.preventDefault(),this.context.commandBinder.issueCommand(new l.Yr(this.props.id))},this.onRemoveFailed=e=>{const{id:t,error:n}=this.props;n&&(e.stopPropagation(),this.context.commandBinder.issueCommand(new l.c4(t)))},this.state={containerRef:null}}render(){const{className:e,error:t,progress:n,fileName:i}=this.props;let o=x.ERROR_UPLOAD_FAIL;const a=this.context.locale.t(x.REMOVE_TOOLTIP),c=t?this.onRemoveFailed:this.handleCancelClick;switch(t){case d.t2.FILE_TOO_LARGE:o=x.ERROR_FILE_TOO_LARGE;break;case d.t2.EMPTY_FILE:o=x.ERROR_EMPTY_FILE;break;case d.t2.OVER_QUOTA:o=x.ERROR_OVER_QUOTA;break;case d.t2.PERMISSION_DENIED:o=x.ERROR_PERMISSION_DENIED}const l=t?this.context.locale.t(o):i,h={"upload-error":!!t};return(0,s.jsxs)("div",Object.assign({className:r()("attachment","attachment-upload",h,e)},{children:[(0,s.jsx)("div",Object.assign({ref:this.setContainerRef,className:"upload-status"},{children:t?(0,s.jsx)(p.I,{name:"error",size:m.l.MEDIUM}):(0,s.jsx)(u.A,{progress:n,innerRadius:20,barWidth:4})})),(0,s.jsx)(g.m,{target:this.state.containerRef,title:l}),(0,s.jsx)(f.$n,{icon:"close",className:"attachment-delete",size:f.Mp.SMALL,variant:f.Ak.FAB,theme:"dark",tooltip:a,tooltipOptions:{placement:"bottom-start"},onClick:c})]}))}};b.contextType=c.BR,b=v([a.A,E("design:paramtypes",[Object])],b)},24378:(e,t,n)=>{"use strict";n.d(t,{M8:()=>r,Rd:()=>a,hw:()=>c,lX:()=>o});var s=n(96540),i=n(82834);function o(){return l("pendings")}function r(){return l("removals")}function a(){return l("uploads")}function c(){return l("failures")}function l(e){const t=(0,i.k)(),[n,o]=(0,s.useState)(d(t,e));return(0,s.useEffect)((()=>{if(!t)return()=>{};function n(){o(d(t,e))}const s=t[e].onChanged(n);return n(),()=>s.cancel()}),[t,e]),n}function d(e,t){return e?e[t].values:[]}},82834:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var s=n(47952),i=n(55848);const o=(0,s.v)(i.v)},72380:(e,t,n)=>{"use strict";n.d(t,{FA:()=>i,Uf:()=>a,Z4:()=>c,hd:()=>o,hg:()=>r});var s=n(14754);class i extends s.QB{constructor(e,t){super(),this.attachments=e,this.attachmentId=t}}class o extends s.QB{}class r extends s.QB{constructor(e){super(),this.upload=e}}class a extends s.QB{constructor(e){super(),this.upload=e}}class c extends s.QB{constructor(e,t,n,s){super(),this.attachment=e,this.status=t,this.parentId=n,this.parentType=s}}},62083:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={enabled:e}}}i.id="TOGGLE_PANO_MARKER"},21959:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={disable:e}}}i.id="DISABLE_CURSOR_MESH"},7895:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var s=n(96540),i=n(13673);function o(e){return e?e.floors.getOrderedValues():[]}function r(){const e=(0,i._)(),[t,n]=(0,s.useState)(o(e));return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=()=>n(o(e)),s=e.floors.getCollection().onChanged(t);return t(),()=>s.cancel()}),[e]),t}},68726:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var s=n(74848),i=n(32485),o=n.n(i);function r({current:e,min:t,max:n}){const i=void 0!==t&&e<t||e>n;return(0,s.jsxs)("div",Object.assign({className:o()("text-counter",{error:i})},{children:[e,"/",n]}))}},15442:(e,t,n)=>{"use strict";n.d(t,{P:()=>y,F:()=>b});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(40826),l=n(83763),d=n(4234),u=n(35953),h=n(52385);const p=/[^]*youtube.com\/shorts\//gi;var m,g=n(53285),f=n(99366),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{EMBED:x}=f.A.WORKSHOP;var b;!function(e){e.NONE="none",e.INVALID_URL_SYNTAX="invalid",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(b||(b={}));let y=m=class extends i.Component{constructor(e){super(e),this.inputRef=(0,i.createRef)(),this.isUnmounting=!1,this.onInput=e=>{const t=(0,l.q)(e)?b.NONE:b.INVALID_URL_SYNTAX;this.setState({validationPhase:t,currentUrl:e})},this.onApply=()=>{this.isDisabled()||this.onDoneEditing(this.state.currentUrl)},this.stopPropagation=e=>{e.stopPropagation()},this.onDoneEditing=async e=>{const{onEmbed:t,onEmbedCleared:n,url:s}=this.props;if(""===e)return n&&n(),void this.setState({validationPhase:b.NONE,error:void 0,currentUrl:""});const i=(e=>{if(p.test(e))return`https://youtube.com/watch?v=${e.replace(p,"").replace(/\?(.*)/g,"")}`;return e})(e);if(i&&i!==s)try{const e=await this.loadMedia(i);if(this.isUnmounting)return;e?(this.setState({validationPhase:b.LOADED,error:void 0,currentUrl:i}),t(e)):this.onEmbedError(i)}catch(e){if(this.isUnmounting)return;this.onEmbedError(i,e)}},this.loadMedia=async e=>{const{parentId:t,parentType:n}=this.props;return this.setState({validationPhase:b.LOADING}),this.context.commandBinder.issueCommand(new d.Bd(t,n,e))},this.state={currentUrl:e.url||"",validationPhase:b.NONE,error:void 0}}componentWillUnmount(){this.isUnmounting=!0,this.setState({currentUrl:"",validationPhase:b.NONE,error:void 0})}componentDidUpdate(e,t){const{url:n,onValidationPhaseChange:s}=this.props;let i=this.state.validationPhase;n!==e.url&&(i=b.NONE,this.setState({currentUrl:n||"",validationPhase:b.NONE,error:void 0})),s&&i!==t.validationPhase&&s(i)}focus(){this.inputRef.current&&this.inputRef.current.focus()}onEmbedError(e,t){this.setState({error:t,validationPhase:b.ERROR,currentUrl:e})}isDisabled(){const{validationPhase:e,currentUrl:t}=this.state;return e===b.ERROR||e===b.LOADING||e===b.INVALID_URL_SYNTAX&&""!==t||""===t}renderError(){const{locale:e}=this.context,{error:t}=this.state;let n=e.t(x.ERROR_MESSAGE);return t instanceof g.aI?n=e.t(x.PROVIDER_NOT_SUPPORTED_MESSAGE):t instanceof g.Dm&&(n=e.t(x.LINK_TYPE_NOT_SUPPORTED_MESSAGE)),(0,s.jsxs)("div",Object.assign({className:"popover-message popover-message-error"},{children:[n," ",(0,s.jsx)("a",Object.assign({className:"link",target:"_blank",rel:"noreferrer",href:m.supportPage},{children:e.t(x.HELP_CTA)}))]}))}renderHelpMessage(){const{locale:e}=this.context,{currentUrl:t,validationPhase:n}=this.state;switch(n){case b.ERROR:return this.renderError();case b.LOADING:return(0,s.jsx)("div",Object.assign({className:"popover-message"},{children:e.t(x.LOADING_MESSAGE)}));case b.INVALID_URL_SYNTAX:if(""!==t)return(0,s.jsx)("div",Object.assign({className:"popover-message popover-message-error"},{children:e.t(x.INVALID_URL_MESSAGE)}))}return(0,s.jsx)("div",Object.assign({className:"popover-message"},{children:(0,s.jsx)("a",Object.assign({className:"link",target:"_blank",href:m.supportPage,tabIndex:-1},{children:e.t(x.SUPPORTED_FORMATS_MESSAGE)}))}))}render(){const{locale:e}=this.context,{className:t,tabIndex:n}=this.props,{currentUrl:i}=this.state,o=void 0!==n&&n>=0,a=e.t(x.MEDIA_EMBED_PLACEHOLDER);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",Object.assign({className:"media-embed-editor",onClick:this.stopPropagation},{children:[(0,s.jsx)(u.A,{ref:this.inputRef,text:i,type:"url",className:r()(t),placeholder:a,onDone:this.onDoneEditing,onInput:this.onInput,allowTabbing:o,tabIndex:n}),(0,s.jsx)("div",Object.assign({className:"popover-footer"},{children:this.renderHelpMessage()}))]})),(0,s.jsx)("div",Object.assign({className:"modal-footer embed-apply"},{children:(0,s.jsx)(h.$n,{variant:h.Ak.PRIMARY,size:"small",disabled:this.isDisabled(),onClick:this.onApply,label:e.t(x.APPLY_CTA)})}))]})}};y.contextType=c.BR,y.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868-Add-Multimedia-to-a-Mattertag-Post",y=m=v([a.A,E("design:paramtypes",[Object])],y)},1003:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var s=n(74848);function i({children:e}){return(0,s.jsx)("div",Object.assign({className:"overlay-message"},{children:e}))}},54550:(e,t,n)=>{"use strict";n.d(t,{q:()=>d});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(521),c=n(97137),l=n(34611);const d=(0,i.forwardRef)((({children:e,open:t,className:n,onClose:o,scrollingDisabled:d=!1},u)=>{const h=(0,i.useRef)(null),p=(0,i.useRef)(null),m=(0,c.O)();(0,i.useImperativeHandle)(u,(()=>({resetScrollTop:()=>{p.current&&p.current.resetScrollTop()},scrollToSelector:e=>{p.current&&p.current.scrollToSelector(e)}})),[p]);return(0,s.jsx)("div",Object.assign({className:r()("detail-panel",t&&"open",n),onKeyDown:function(e){o&&"Escape"===e.code&&(e.stopPropagation(),o())},ref:h,tabIndex:t?0:void 0,onTransitionEnd:e=>{h.current&&e.target===h.current&&t&&h.current.focus()}},{children:(0,s.jsx)(l.H,Object.assign({ref:p,hideThumb:m===a.L$.BOTTOM_PANEL,disabled:d},{children:e}))}))}))},18435:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var s=n(96540),i=n(47952),o=n(56545);const r=(0,i.v)(o.J);function a(){const e=r(),[t,n]=(0,s.useState)((null==e?void 0:e.getAccordionGroupCollapsedStates())||{});(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getAccordionGroupCollapsedStates())}const s=e.onAccordionCollapsedGroupsChanged(t);return t(),()=>s.cancel()}),[e]);return[t,(0,s.useCallback)(((t,n)=>{e&&e.setAccordionGroupCollapsed(t,n)}),[e])]}},50078:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var s=n(40826),i=n(96540);function o(e,t){const{engine:n}=(0,i.useContext)(s.BR);return(0,i.useCallback)(((...s)=>{const i=t?Array.isArray(t)?t:t(...s):[];n.commandBinder.issueCommand(new e(...i))}),[e,t,n])}},91029:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var s=n(96540);function i(e){const t=function(){const[,e]=(0,s.useState)(0);return(0,s.useCallback)((()=>{e((e=>e+1))}),[])}();return(0,s.useEffect)((()=>{if(t(),null!=e){const n=e.onChanged(t);return()=>{n.cancel()}}return()=>{}}),[e,t]),e}},89339:(e,t,n)=>{"use strict";n.d(t,{E:()=>d});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let d=class extends i.Component{constructor(e){super(e)}render(){const{iconClass:e,label:t,badgeStyle:n,onClick:i,className:o,imageUrl:r}=this.props;return(0,s.jsxs)("span",Object.assign({className:a()("badge",o,{clickable:!!i}),style:n,onClick:i},{children:[e&&(0,s.jsx)("span",{className:`icon badge-icon ${e}`}),t&&(0,s.jsx)("span",Object.assign({className:"badge-label"},{children:t})),r&&(0,s.jsx)("span",Object.assign({className:"badge-img"},{children:(0,s.jsx)("img",{src:r})}))]}))}};d=c([o.A,l("design:paramtypes",[Object])],d)},86978:(e,t,n)=>{"use strict";n.d(t,{r:()=>d});var s=n(74848),i=n(96540),o=n(72909),r=n(52385),a=n(44158),c=n(40826),l=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r};let d=class extends i.Component{constructor(){super(...arguments),this.onKey=async e=>{if(this.props.disabled)return;switch(e.keyCode){case a.D.COMMA:this.onGotoPrev();break;case a.D.PERIOD:this.onGotoNext()}},this.onGotoNext=()=>{const e=this.getNextIndex();-1!==e&&this.props.onNavigate(e)},this.onGotoPrev=()=>{const e=this.getPrevIndex();-1!==e&&this.props.onNavigate(e)}}componentDidMount(){this.context.mainDiv.getRootNode().addEventListener("keydown",this.onKey,{capture:!0})}componentWillUnmount(){this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0})}getNextIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t+1<e?t+1:n?0:-1}getPrevIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t>0?t-1:n?e-1:-1}render(){const{total:e,index:t,disabled:n,overlay:i}=this.props;if(e<2||-1===t)return null;const o=i?"dark":"light",a=i?void 0:r.Mp.LARGE,c=`${t+1} of ${e}`;return(0,s.jsxs)("div",Object.assign({className:"list-nav"},{children:[(0,s.jsx)(r.$n,{icon:"dpad-left",variant:r.Ak.TERTIARY,size:a,disabled:n,theme:o,onClick:this.onGotoPrev}),(0,s.jsx)("span",Object.assign({className:"list-nav-label"},{children:c})),(0,s.jsx)(r.$n,{icon:"dpad-right",variant:r.Ak.TERTIARY,size:a,disabled:n,theme:o,onClick:this.onGotoNext})]}))}};d.contextType=c.BR,d=l([o.A],d)},39944:(e,t,n)=>{"use strict";n.d(t,{Q:()=>Q,r:()=>q});var s=n(74848),i=n(96540);var o=function(){return o=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function r(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}Object.create;Object.create;var a=function(){return a=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,i,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}function d(e,t,n){if(n||2===arguments.length)for(var s,i=0,o=t.length;i<o;i++)!s&&i in t||(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}Object.create;var u=n(32485),h=n.n(u),p=function(e){return(Array.isArray(e)?e:[e]).filter((function(e){return!!e})).map((function(e){return"mdc-theme--"+e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}))},m=i.forwardRef((function(e,t){var n=e.tag,s=void 0===n?"div":n,o=(e.theme,e.element),r=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}(e,["tag","theme","element"]),c=o?o.props(r):r,l=o?g(t,o.setRef):t;return i.createElement(s,a({},c,{ref:l}))})),g=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n,s;try{for(var i=c(e),o=i.next();!o.done;o=i.next()){var r=o.value;"function"==typeof r?r(t):r&&"current"in r&&(r.current=t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}}},f=function(e,t){"function"==typeof e?e(t):e&&"current"in e&&(e.current=t)};function v(e){var t=i.forwardRef(e),n=function(e,t){return i.createElement(i.Fragment,null)};return n.displayName=e.constructor.name||"RMWCComponent",t.displayName=n.displayName,t}var E={blur:"onBlur",cancel:"onCancel",click:"onClick",close:"onClose",contextmenu:"onContextMenu",copy:"onCopy",cut:"onCut",auxclick:"onAuxClick",doubleclick:"onDoubleClick",dragend:"onDragEnd",dragstart:"onDragStart",drop:"onDrop",focus:"onFocus",input:"onInput",invalid:"onInvalid",keydown:"onKeyDown",keypress:"onKeyPress",keyup:"onKeyUp",mousedown:"onMouseDown",mouseup:"onMouseUp",paste:"onPaste",pause:"onPause",play:"onPlay",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerup:"onPointerUp",ratechange:"onRateChange",reset:"onReset",seeked:"onSeeked",submit:"onSubmit",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchstart:"onTouchStart",volumechange:"onVolumeChange",abort:"onAbort",animationend:"onAnimationEnd",animationiteration:"onAnimationIteration",animationstart:"onAnimationStart",canplay:"onCanPlay",canplaythrough:"onCanPlayThrough",drag:"onDrag",dragenter:"onDragEnter",dragexit:"onDragExit",dragleave:"onDragLeave",dragover:"onDragOver",durationchange:"onDurationChange",emptied:"onEmptied",encrypted:"onEncrypted",ended:"onEnded",error:"onError",gotpointercapture:"onGotPointerCapture",load:"onLoad",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",loadstart:"onLoadStart",lostpointercapture:"onLostPointerCapture",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseover:"onMouseOver",playing:"onPlaying",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",progress:"onProgress",scroll:"onScroll",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",toggle:"onToggle",touchmove:"onTouchMove",transitionend:"onTransitionEnd",waiting:"onWaiting",wheel:"onWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",change:"onChange",select:"onSelect",beforeinput:"onBeforeInput",compositionend:"onCompositionEnd",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate"},x=function(e){return E[e]||e},b=function(){function e(e){this._classes=new Set,this._events={},this._style={},this._props={},this._ref=null,this._onChange=null,this._onChange=e,this.onChange=this.onChange.bind(this),this.addClass=this.addClass.bind(this),this.removeClass=this.removeClass.bind(this),this.hasClass=this.hasClass.bind(this),this.setProp=this.setProp.bind(this),this.getProp=this.getProp.bind(this),this.removeProp=this.removeProp.bind(this),this.setStyle=this.setStyle.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.setRef=this.setRef.bind(this)}return e.prototype.onChange=function(){this._onChange&&this._onChange()},e.prototype.destroy=function(){var e=this;this._onChange=null,this._events={},this._style={},this._props={},this._classes=new Set,setTimeout((function(){e._ref=null}))},e.prototype.addClass=function(e){this._classes.has(e)||(this._classes.add(e),this.onChange())},e.prototype.removeClass=function(e){this._classes.has(e)&&(this._classes.delete(e),this.onChange())},e.prototype.hasClass=function(e){return this._classes.has(e)},e.prototype.setProp=function(e,t,n){void 0===n&&(n=!1),this._props[e]!==t&&(this._props[e]=t,!n&&this.onChange())},e.prototype.getProp=function(e){return this._props[e]},e.prototype.removeProp=function(e){void 0!==this._props[e]&&(delete this._props[e],this.onChange())},e.prototype.props=function(e){var t=this,n=e.className,s=void 0===n?"":n,i=e.style,o=void 0===i?{}:i,r=Object.entries(e).reduce((function(e,n){var s=l(n,2),i=s[0],o=s[1],r=t._events[i];if("function"==typeof o&&"function"==typeof r){e[i]=function(e){return r(e),o(e)}}return e}),a({},this._events)),c=h()(s,d([],l(this._classes))),u=a(a({},this._style),o);return a(a(a(a({},e),this._props),r),{style:u,className:c})},e.prototype.setStyle=function(e,t){e=e.startsWith("--")?e:e.replace(/(-[a-z])/g,(function(e){return e.toUpperCase().replace("-","")})),this._style[e]!==t&&(this._style[e]=t,this.onChange())},e.prototype.addEventListener=function(e,t){var n=x(e);this._events[n]!==t&&(this._events[n]=t,this.onChange())},e.prototype.removeEventListener=function(e,t){var n=x(e);this._events[n]&&(delete this._events[n],this.onChange())},e.prototype.setRef=function(e){e&&(this._ref=e)},Object.defineProperty(e.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),e}(),y=function(e){var t=e.foundation,n=e.props,s=e.elements,o=e.api,r=l((0,i.useState)(0),2)[1],c=(0,i.useRef)(n);c.current=n;var u=(0,i.useMemo)((function(){return Object.keys(s).reduce((function(e,t){return e[t]=new b((function(){r((function(e){return e+1}))})),e}),{})}),[]),h=(0,i.useMemo)((function(){var e=t(a(a({},u),{getProps:function(){return c.current},emit:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return function(t,n,s){var i;void 0===s&&(s=!1),i=new CustomEvent(t,{detail:n,bubbles:s}),Object.defineProperty(i,"target",{value:n,writable:!1}),Object.defineProperty(i,"currentTarget",{value:n,writable:!1});var o=t;return e[o]&&e[o](i),i}}(c.current).apply(void 0,d([],l(e)))}}));return o&&f(c.current.apiRef,o(a({foundation:e},u))),e}),[]);return(0,i.useEffect)((function(){var e=h;return e.init(),o&&f(c.current.apiRef,o(a({foundation:e},u))),f(c.current.foundationRef,e),function(){e.destroy(),f(c.current.apiRef,null),f(c.current.foundationRef,null),Object.values(u).map((function(e){return e.destroy()})),c.current={}}}),[h,u]),a({foundation:h},u)},O={bottom:0,height:0,left:0,right:0,top:0,width:0},T=function(e,t){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},T(e,t)};var C=function(){return C=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C.apply(this,arguments)};var A={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},_={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function S(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}var j=function(){function e(e){void 0===e&&(e={}),this.adapter_=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();var R={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete"},N={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},k={PAGE_FACTOR:4},w=["mousedown","pointerdown","touchstart"],I=["mouseup","pointerup","touchend"],L={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},P="ArrowDown",D="ArrowLeft",M="ArrowRight",U="ArrowUp",H="End",B="Home",V="PageDown",F="PageUp",G=function(e){function t(n){var s=e.call(this,C({},t.defaultAdapter,n))||this;return s.savedTabIndex_=NaN,s.active_=!1,s.inTransit_=!1,s.isDiscrete_=!1,s.hasTrackMarker_=!1,s.handlingThumbTargetEvt_=!1,s.min_=0,s.max_=100,s.step_=0,s.value_=0,s.disabled_=!1,s.preventFocusState_=!1,s.thumbContainerPointerHandler_=function(){return s.handlingThumbTargetEvt_=!0},s.interactionStartHandler_=function(e){return s.handleDown_(e)},s.keydownHandler_=function(e){return s.handleKeydown_(e)},s.focusHandler_=function(){return s.handleFocus_()},s.blurHandler_=function(){return s.handleBlur_()},s.resizeHandler_=function(){return s.layout()},s}return function(e,t){function n(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return R},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return N},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;this.isDiscrete_=this.adapter_.hasClass(R.IS_DISCRETE),this.hasTrackMarker_=this.adapter_.hasClass(R.HAS_TRACK_MARKER),w.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.interactionStartHandler_),e.adapter_.registerThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_),this.adapter_.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},t.prototype.destroy=function(){var e=this;w.forEach((function(t){e.adapter_.deregisterInteractionHandler(t,e.interactionStartHandler_),e.adapter_.deregisterThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.deregisterResizeHandler(this.resizeHandler_)},t.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter_.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},t.prototype.layout=function(){this.rect_=this.adapter_.computeBoundingRect(),this.updateUIForCurrentValue_()},t.prototype.getValue=function(){return this.value_},t.prototype.setValue=function(e){this.setValue_(e,!1)},t.prototype.getMax=function(){return this.max_},t.prototype.setMax=function(e){if(e<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},t.prototype.getMin=function(){return this.min_},t.prototype.setMin=function(e){if(e>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},t.prototype.getStep=function(){return this.step_},t.prototype.setStep=function(e){if(e<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof e||e<1)&&(e=1),this.step_=e,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},t.prototype.isDisabled=function(){return this.disabled_},t.prototype.setDisabled=function(e){this.disabled_=e,this.toggleClass_(R.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter_.getTabIndex(),this.adapter_.setAttribute(N.ARIA_DISABLED,"true"),this.adapter_.removeAttribute("tabindex")):(this.adapter_.removeAttribute(N.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter_.setAttribute("tabindex",String(this.savedTabIndex_)))},t.prototype.handleDown_=function(e){var t=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(e){t.handleMove_(e)},s=L[e.type],i=function(){t.handleUp_(),t.adapter_.deregisterBodyInteractionHandler(s,n),I.forEach((function(e){return t.adapter_.deregisterBodyInteractionHandler(e,i)}))};this.adapter_.registerBodyInteractionHandler(s,n),I.forEach((function(e){return t.adapter_.registerBodyInteractionHandler(e,i)})),this.setValueFromEvt_(e)}},t.prototype.handleMove_=function(e){e.preventDefault(),this.setValueFromEvt_(e)},t.prototype.handleUp_=function(){this.setActive_(!1),this.adapter_.notifyChange()},t.prototype.getClientX_=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].clientX:e.clientX},t.prototype.setValueFromEvt_=function(e){var t=this.getClientX_(e),n=this.computeValueFromClientX_(t);this.setValue_(n,!0)},t.prototype.computeValueFromClientX_=function(e){var t=this.max_,n=this.min_,s=(e-this.rect_.left)/this.rect_.width;return this.adapter_.isRTL()&&(s=1-s),n+s*(t-n)},t.prototype.handleKeydown_=function(e){var t=this.getKeyId_(e),n=this.getValueForKeyId_(t);isNaN(n)||(e.preventDefault(),this.adapter_.addClass(R.FOCUS),this.setValue_(n,!0),this.adapter_.notifyChange())},t.prototype.getKeyId_=function(e){return e.key===D||37===e.keyCode?D:e.key===M||39===e.keyCode?M:e.key===U||38===e.keyCode?U:e.key===P||40===e.keyCode?P:e.key===B||36===e.keyCode?B:e.key===H||35===e.keyCode?H:e.key===F||33===e.keyCode?F:e.key===V||34===e.keyCode?V:""},t.prototype.getValueForKeyId_=function(e){var t=this,n=t.max_,s=t.min_,i=t.step_||(n-s)/100;switch(this.adapter_.isRTL()&&(e===D||e===M)&&(i=-i),e){case D:case P:return this.value_-i;case M:case U:return this.value_+i;case B:return this.min_;case H:return this.max_;case F:return this.value_+i*k.PAGE_FACTOR;case V:return this.value_-i*k.PAGE_FACTOR;default:return NaN}},t.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter_.addClass(R.FOCUS)},t.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter_.removeClass(R.FOCUS)},t.prototype.setValue_=function(e,t,n){if(void 0===n&&(n=!1),e!==this.value_||n){var s=this.min_,i=this.max_,o=e===s||e===i;this.step_&&!o&&(e=this.quantize_(e)),e<s?e=s:e>i&&(e=i),e=e||0,this.value_=e,this.adapter_.setAttribute(N.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),t&&(this.adapter_.notifyInput(),this.isDiscrete_&&this.adapter_.setMarkerValue(e))}},t.prototype.quantize_=function(e){return Math.round(e/this.step_)*this.step_},t.prototype.updateUIForCurrentValue_=function(){var e=this,t=this,n=t.max_,s=t.min_,i=(t.value_-s)/(n-s),o=i*this.rect_.width;this.adapter_.isRTL()&&(o=this.rect_.width-o);var r=function(e,t){if(S(e)&&t in A){var n=e.document.createElement("div"),s=A[t],i=s.standard,o=s.prefixed;return i in n.style?i:o}return t}(window,"transform"),a=function(e,t){if(S(e)&&t in _){var n=e.document.createElement("div"),s=_[t],i=s.standard,o=s.prefixed;return s.cssProperty in n.style?i:o}return t}(window,"transitionend");if(this.inTransit_){var c=function(){e.setInTransit_(!1),e.adapter_.deregisterThumbContainerInteractionHandler(a,c)};this.adapter_.registerThumbContainerInteractionHandler(a,c)}requestAnimationFrame((function(){e.adapter_.setThumbContainerStyleProperty(r,"translateX("+o+"px) translateX(-50%)"),e.adapter_.setTrackStyleProperty(r,"scaleX("+i+")")}))},t.prototype.setActive_=function(e){this.active_=e,this.toggleClass_(R.ACTIVE,this.active_)},t.prototype.setInTransit_=function(e){this.inTransit_=e,this.toggleClass_(R.IN_TRANSIT,this.inTransit_)},t.prototype.toggleClass_=function(e,t){t?this.adapter_.addClass(e):this.adapter_.removeClass(e)},t}(j);var W=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track"})}))),K=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track-marker-container"})}))),Y=i.memo((function(e){var t=e.value;return i.createElement("div",{className:"mdc-slider__pin"},i.createElement("span",{className:"mdc-slider__pin-value-marker"},t))})),$=i.memo((function(){return i.createElement("svg",{className:"mdc-slider__thumb",width:"21",height:"21"},i.createElement("circle",{cx:"10.5",cy:"10.5",r:"7.875"}))})),z=i.memo((function(){return i.createElement("div",{className:"mdc-slider__focus-ring"})})),X=v((function(e,t){var n=function(e){var t=(0,i.useRef)(),n=(0,i.useRef)(),s=y({props:e,elements:{rootEl:!0,thumbContainerEl:!0,sliderPinEl:!0},foundation:function(e){var s,i,o,r=e.rootEl,c=e.thumbContainerEl,l=e.sliderPinEl,d=e.emit;return new G({hasClass:function(e){return r.hasClass(e)},addClass:function(e){return r.addClass(e)},removeClass:function(e){return r.removeClass(e)},getAttribute:function(e){return r.getProp(e)},setAttribute:(s=function(e,t){return r.setProp(e,t)},i=300,function(){var e=this,t=arguments;null!==o&&clearTimeout(o),o=setTimeout((function(){o=null,s.apply(e,t)}),i)}),removeAttribute:function(e){return r.removeProp(e)},computeBoundingRect:function(){return r.ref?r.ref.getBoundingClientRect():O},getTabIndex:function(){return r.ref?r.ref.tabIndex:0},registerInteractionHandler:function(e,t){r.addEventListener(e,t)},deregisterInteractionHandler:function(e,t){r.removeEventListener(e,t)},registerThumbContainerInteractionHandler:function(e,t){c.addEventListener(e,t)},deregisterThumbContainerInteractionHandler:function(e,t){c.removeEventListener(e,t)},registerBodyInteractionHandler:function(e,t){document.body&&document.body.addEventListener(e,t)},deregisterBodyInteractionHandler:function(e,t){document.body&&document.body.removeEventListener(e,t)},registerResizeHandler:function(e){window.addEventListener("resize",e)},deregisterResizeHandler:function(e){window.removeEventListener("resize",e)},notifyInput:function(){d("onInput",{value:a.getValue()})},notifyChange:function(){d("onChange",{value:a.getValue()})},setThumbContainerStyleProperty:function(e,t){c.setStyle(e,t)},setTrackStyleProperty:function(e,n){var s;null===(s=t.current)||void 0===s||s.style.setProperty(e,n)},setMarkerValue:function(e){l.setProp("value",e)},setTrackMarkers:function(e,t,s){var i,o=e.toLocaleString(),r="linear-gradient(to right, currentColor 2px, transparent 0) 0 center / calc((100% - 2px) / (("+t.toLocaleString()+" - "+s.toLocaleString()+") / "+o+")) 100% repeat-x";null===(i=n.current)||void 0===i||i.style.setProperty("background",r)},isRTL:function(){return!!r.ref&&"rtl"===getComputedStyle(r.ref).direction}})}}),a=s.foundation,c=r(s,["foundation"]);return(0,i.useEffect)((function(){void 0!==e.max&&a.setMax(+e.max)}),[e.max,a]),(0,i.useEffect)((function(){void 0!==e.min&&a.setMin(+e.min)}),[e.min,a]),(0,i.useEffect)((function(){var t=void 0!==e.value?Number(e.value):a.getValue(),n=a.getMin(),s=a.getMax();t<n&&(console.warn("Attempted to set slider to "+t+" which is less than min: "+n),t=n),t>s&&(console.warn("Attempted to set slider to "+t+" which is greater than max: "+s),t=s),a.setValue(t)}),[e.value,a]),(0,i.useEffect)((function(){void 0!==e.step&&a.setStep(+e.step)}),[e.step,a]),(0,i.useEffect)((function(){void 0!==e.disabled&&a.setDisabled(e.disabled)}),[e.disabled,a]),(0,i.useEffect)((function(){void 0!==e.discrete&&(a.isDiscrete_=e.discrete),e.discrete&&0===a.getStep()&&a.setStep(1)}),[e.discrete,a]),(0,i.useEffect)((function(){var t=a.hasTrackMarker_;void 0!==e.displayMarkers&&e.displayMarkers!==t&&(a.hasTrackMarker_=e.displayMarkers,window.requestAnimationFrame((function(){return a.setupTrackMarker()})))}),[e.displayMarkers,a]),(0,i.useEffect)((function(){var e=a.handleDown_.bind(a);a.handleDown_=function(t){t.persist(),e(t)}}),[a]),o({setTrackRef:function(e){return t.current=e},setTrackMarkerContainerRef:function(e){return n.current=e}},c)}(e),s=n.rootEl,a=n.thumbContainerEl,c=n.sliderPinEl,u=n.setTrackRef,g=n.setTrackMarkerContainerRef,f=e.value,v=(e.min,e.max),E=e.discrete,x=e.displayMarkers,b=e.step,T=e.disabled,C=(e.onChange,e.onInput,e.children),A=(e.foundationRef,r(e,["value","min","max","discrete","displayMarkers","step","disabled","onChange","onInput","children","foundationRef"])),_=function(e,t){return h().apply(void 0,d(d([e.className],l(e.theme?p(e.theme):[])),l("function"==typeof t?t(e):t)))}(e,["mdc-slider",{"mdc-slider--discrete":E,"mdc-slider--display-markers":x&&E}]),S=b?{"data-step":b}:{};return x&&!E&&console.warn("The 'displayMarkers' prop on rmwc Slider will\n        only work in conjunction with the 'discrete' prop"),i.createElement(m,o({tabIndex:0,role:"slider","aria-valuemax":v,"aria-valuenow":f,"aria-label":"Select Value"},T?{"aria-disabled":T}:{},S,A,{ref:t,element:s,className:_}),i.createElement("div",{className:"mdc-slider__track-container"},i.createElement(W,{ref:u}),x&&i.createElement(K,{ref:g})),i.createElement(m,{element:a,className:"mdc-slider__thumb-container"},E&&i.createElement(Y,{value:c.getProp("value")}),i.createElement($,null),i.createElement(z,null)),C)}));n(44704);let J=0;class q extends i.Component{constructor(e){super(e),this.mdcRef=(0,i.createRef)(),this.setValue=e=>{this.setState({value:e})},this.onSliderInput=e=>{var t;const n=e.detail.value;this.layoutRecalculated||(null===(t=this.mdcRef.current)||void 0===t||t.layout(),this.layoutRecalculated=!0),this.setState({value:n}),this.props.onInput&&this.props.onInput(n)},this.onSliderChange=e=>{const t=e.detail.value;this.setState({value:t}),this.props.onChange&&this.props.onChange(t)},this.getLeftOffset=()=>100*(this.state.value-this.props.min)/(this.props.max-this.props.min)+"%",this.getSliderId=()=>`slider-with-tooltip-${this.id}`,this.getStyleElement=()=>`#${this.getSliderId()} .mdc-slider__thumb-container {\n        left: ${this.getLeftOffset()}\n    }`,this.getDisplayValue=e=>{const{formatNumbers:t,units:n}=this.props;return(t?t(e):e)+(n||"")},this.setActive=e=>()=>this.setState({active:e}),this.hasChanged=()=>{this.setState({hasChanged:!1})},this.onMouseDown=e=>{this.props.onInputStart&&this.props.onInputStart()},this.onEventMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.onMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.id=J++,this.state={value:void 0!==e.initialValue?e.initialValue:(e.max+e.min)/2,active:!1,hasChanged:!1},this.setActiveSlider=this.setActive(!0),this.setInactiveSlider=this.setActive(!1)}componentDidMount(){document.addEventListener("mouseup",this.onEventMouseUp),document.addEventListener("mouseleave",this.onEventMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.onEventMouseUp),document.removeEventListener("mouseleave",this.onEventMouseUp)}componentDidUpdate(e,t){t.value!==this.state.value&&(clearTimeout(this.hasChangedTimeout),this.setState({hasChanged:!0}),this.hasChangedTimeout=window.setTimeout(this.hasChanged,450))}render(){const{width:e,displayBounds:t,min:n,max:i,discrete:o,tooltipPosition:r=Q.DOWN,variant:a="default",disabled:c,tabIndex:l}=this.props,{active:d,hasChanged:u,value:p}=this.state,m={left:this.getLeftOffset()},g="inline-value"===a,f=!g&&t,v=!g,E=void 0!==l?l:0;return(0,s.jsxs)("div",Object.assign({id:this.getSliderId(),className:h()("slider-with-tooltip",{displayBounds:t,disabled:c}),style:{width:`${e}px`},onMouseEnter:this.setActiveSlider,onMouseLeave:this.setInactiveSlider},{children:[v&&r===Q.UP&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:d||u}),"data-balloon":this.getDisplayValue(p),"data-balloon-pos":Q.UP,style:m}),f&&(0,s.jsx)("div",Object.assign({className:"min-amount"},{children:this.getDisplayValue(n)})),g&&(0,s.jsx)("div",Object.assign({className:"min-amount"},{children:this.getDisplayValue(p)})),(0,s.jsx)(X,{discrete:o,min:n,max:i,value:p,onInput:this.onSliderInput,onChange:this.onSliderChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,foundationRef:this.mdcRef,disabled:c,tabIndex:E}),f&&(0,s.jsx)("div",Object.assign({className:"max-amount"},{children:this.getDisplayValue(i)})),(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:this.getStyleElement()}}),v&&r===Q.DOWN&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:d||u}),"data-balloon":this.getDisplayValue(p),"data-balloon-pos":Q.DOWN,style:m})]}))}}var Q;!function(e){e.UP="up",e.DOWN="down"}(Q||(Q={}))},23101:(e,t,n)=>{"use strict";n.d(t,{n:()=>m});var s=n(74848),i=n(96540),o=n(82030),r=n(81196),a=n(93475);const c=e=>{let t="";t+=Math.floor(e)+"'";const n=Math.floor(e%1*12);return n<10&&(t+="0"),t+=n+"''",t};var l=n(39944),d=n(33675),u=n(99366),h=n(38216),p=u.A.WORKSHOP.MATTERTAGS;function m(e){const{stemEnabled:t,stemLength:n,onLengthUpdate:u,onLengthChanged:m,onStemEnabledChanged:g,variant:f,disabled:v,tabIndex:E}=e,x=(0,i.useRef)(null),b=(0,r.J)(),y=(0,h.Y)();(0,i.useEffect)((()=>{x.current&&x.current.setValue((0,a.ld)(n))}),[n]);const O=y.t(p.SHOW_STEM_LABEL);return(0,s.jsxs)("div",Object.assign({className:"stem-editor",onClick:e=>e.stopPropagation()},{children:[(0,s.jsx)("div",Object.assign({className:"stem-slider"},{children:(0,s.jsx)(l.r,{ref:x,discrete:!1,min:.1,max:9,initialValue:(0,a.ld)(n),onChange:(e,t=!0)=>{const n=t?(0,a.hV)(e):e;m(n)},onInput:(e,t=!0)=>{const s=t?(0,a.hV)(e):e;s!==n&&u(s)},displayBounds:!0,width:150,formatNumbers:e=>{if(b===o.t.IMPERIAL)return c(e);return`${Math.round(100*(0,a.hV)(e))/100}m`},tooltipPosition:l.Q.DOWN,variant:f,disabled:v,tabIndex:E})})),(0,s.jsx)(d.S,{enabled:!0,checked:t,label:O,onChange:e=>{const t=e.classList.contains("checked");g(t)}})]}))}},35953:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(74848),i=n(96540),o=n(72909),r=n(40826),a=n(32485),c=n.n(a),l=n(44158),d=n(52775),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.focusTimeout=0,this.onInput=e=>{if(this.props.onInput){const t=e.target;this.props.onInput(t.value)}},this.onKeyPress=e=>{e.stopPropagation();const{allowTabbing:t}=this.props,n=e.which||e.keyCode,s=[l.D.TAB,l.D.RETURN,l.D.ESCAPE];if("keydown"===e.type&&!s.includes(n))return!1;const i=e.target;switch(this.props.maxLength&&i.value.length>this.props.maxLength&&e.preventDefault(),n){case l.D.ESCAPE:this.props.onCancel&&this.props.onCancel();break;case l.D.TAB:case l.D.RETURN:this.props.onBlur||e.shiftKey||(n===l.D.TAB&&t||e.preventDefault(),this.blur())}return!1},this.stopPropagation=e=>e.stopPropagation(),this.onFocus=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!0)),this.props.onFocus&&this.props.onFocus(e)},this.onBlur=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!1));const t=e.target.value,{onBlur:n,onDone:s}=this.props;n?n(t):s&&s(t)},this.setRef=e=>this.input=e,this.state={currentText:e.text}}componentWillUnmount(){window.clearTimeout(this.focusTimeout),this.input&&this.input.blur()}componentDidMount(){const{focusOnMount:e,readOnly:t}=this.props;t||(0===e?this.focus():void 0!==e&&(this.focusTimeout=window.setTimeout((()=>{this.focus()}),e)))}UNSAFE_componentWillReceiveProps(e){e.text!==this.props.text&&this.setState({currentText:e.text})}getText(){return this.input?this.input.value:""}focus(){this.input.focus()}blur(){this.input.blur()}scrollIntoView(e){this.input.scrollIntoView(e)}render(){const{placeholder:e,tabIndex:t,maxLength:n,type:i,className:o,readOnly:r,disabled:a}=this.props,{currentText:l}=this.state;return(0,s.jsx)("div",Object.assign({className:c()("text-field",o)},{children:(0,s.jsx)("input",{ref:this.setRef,className:"text-input-box",type:i||"text",value:l,placeholder:e,"aria-label":e,maxLength:n,onInput:this.onInput,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,onBlur:this.onBlur,onFocus:this.onFocus,tabIndex:t,readOnly:r,disabled:!!a})}))}};p.contextType=r.BR,p=u([o.A,h("design:paramtypes",[Object])],p);const m=p},18969:(e,t,n)=>{"use strict";n.d(t,{y:()=>c});var s=n(74848),i=n(96540),o=n(72909),r=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let c=class extends i.Component{constructor(e){super(e),this.active=!1,this.dropZone=null,this.onDragOver=e=>{e.dataTransfer&&e.dataTransfer.types&&e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation(),this.activate())},this.onDrop=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&e.dataTransfer.files&&this.props.onDropped(e.dataTransfer.files),this.deactivate()},this.onDragEnd=e=>{e.preventDefault(),e.stopPropagation(),this.deactivate()},this.onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.deactivate()},this.setDropZoneRef=e=>{this.dropZone=e}}activate(){!this.active&&this.dropZone&&(this.props.onActivate&&this.props.onActivate(!0),this.active=!0,this.dropZone.classList.add("active"))}deactivate(){this.active&&this.dropZone&&(this.active=!1,this.dropZone.classList.remove("active"),this.props.onDone&&this.props.onDone())}render(){const{className:e,children:t,disabled:n}=this.props;return(0,s.jsxs)("div",Object.assign({className:e,onDragEnter:n?void 0:this.onDragOver,onDragLeave:n?void 0:this.onDragLeave,onDragOver:n?void 0:this.onDragOver,onDragEnd:n?void 0:this.onDragEnd,onDrop:n?void 0:this.onDrop},{children:[(0,s.jsxs)("div",Object.assign({className:"file-drop-zone",ref:this.setDropZoneRef},{children:[(0,s.jsx)("span",{className:"icon icon-attach"}),(0,s.jsx)("label",{children:"Upload file"})]})),t]}))}};c=r([o.A,a("design:paramtypes",[Object])],c)},25504:(e,t,n)=>{"use strict";n.d(t,{e:()=>l});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o);const a=(0,i.memo)((e=>{const{accept:t,id:n,multi:i,enabled:o,children:r,tooltip:a,onUpload:c}=e,l=`file-upload-${n}`;return(0,s.jsxs)("label",Object.assign({className:"file-upload-trigger",htmlFor:l,"data-balloon":a,"data-balloon-pos":"down"},{children:[r,o&&(0,s.jsx)("input",{type:"file",className:"file-input",id:l,accept:t,multiple:!!i,onChange:({currentTarget:e})=>{const t=e.files;t&&c(t),e.value=""}})]}))})),c=(0,i.createContext)(a),l=(0,i.memo)((e=>{const{accept:t,id:n,multi:o,enabled:a,children:l,className:d,tooltip:u,onUpload:h}=e,p=(0,i.useContext)(c);return(0,s.jsx)("div",Object.assign({className:r()("file-upload-button",d,{disabled:!a})},{children:(0,s.jsx)(p,{id:n,accept:t,multi:o,children:l,onUpload:h,enabled:a,tooltip:u})}))}))},63769:(e,t,n)=>{"use strict";n.d(t,{U:()=>T});var s=n(74848),i=n(96540),o=n(99366),r=n(40826),a=n(75414),c=n(83910),l=n(32485),d=n.n(l),u=n(83763),h=n(34758),p=n(52385),m=n(87987);const{MATTERTAGS:g}=o.A.WORKSHOP;function f(e){const{url:t,text:n,error:o,newLink:a}=e,{locale:c}=(0,i.useContext)(r.BR),l=""===n&&""===t&&a?c.t(g.LINK_EDITOR_TIP_TEXT):null,u=o?c.t(g.LINK_EDITOR_INVALID_TIP):null,h=d()("modal-message",{"modal-message-error":!!o}),p=u||l||"";return(0,s.jsx)("div",Object.assign({className:h},{children:p}))}const{MATTERTAGS:v,MODAL:E}=o.A.WORKSHOP;function x(e){return(0,u.q)(e)}function b(e){const{linkUrl:t,linkText:n,onSaveLink:o,onRemoveLink:a,onCancelLink:c}=e,{locale:l}=(0,i.useContext)(r.BR),[u,g]=(0,i.useState)(!1),[b,y]=(0,i.useState)(n),[O,T]=(0,i.useState)(t),[C,A]=(0,i.useState)(x(t));(0,i.useEffect)((()=>(T(t),y(n),A(x(t)),g(!1),()=>{})),[n,t]);const _=(0,i.useCallback)((()=>{C&&window.open(O,"_blank","noreferrer")}),[O,C]),S=(0,i.useCallback)(((e,t)=>{const n=void 0!==t?t:O;o((void 0!==e?e:b)||n,n)}),[O,b,o]),j=(0,i.useCallback)((()=>{S(b,O)}),[S,b,O]),R=(0,i.useCallback)(((e,t)=>{const n=x(e);A(n),g(!n&&""!==e),t&&n&&S(b,e)}),[b,S]),N=(0,i.useCallback)((e=>{y(e)}),[]),k=(0,i.useCallback)((e=>{T(e);const t=x(e);A(t),u&&t&&g(!1)}),[u]),w=(0,i.useCallback)((()=>{R(O,!1)}),[O,R]),I=(0,i.useCallback)((()=>{R(O,!0)}),[O,R]),L=!t,P=l.t(v.LINK_EDITOR_TEXT_PLACEHOLDER),D=l.t(E.SAVE),M=l.t(E.CANCEL),U=l.t(v.LINK_EDITOR_PREVIEW_TIP),H=l.t(v.LINK_EDITOR_REMOVE_TIP),B=!L&&a;return(0,s.jsxs)("div",Object.assign({className:"modal-contents"},{children:[(0,s.jsxs)("div",Object.assign({className:"modal-body"},{children:[(0,s.jsx)("div",Object.assign({className:"link-editor-field link-text-field"},{children:(0,s.jsx)(h.k,{text:b,placeholder:P,autofocus:!n,onInput:N,onCancel:c})})),(0,s.jsxs)("div",Object.assign({className:"link-editor-field link-url-field"},{children:[(0,s.jsx)(h.k,{text:O,type:"url",placeholder:"https://",autofocus:!!n,onBlur:w,onReturn:I,onInput:k,onCancel:c}),C&&O&&(0,s.jsx)(p.$n,{className:"preview-link",icon:"ext-link",variant:p.Ak.TERTIARY,size:p.Mp.SMALL,tooltip:U,onClick:_})]})),(0,s.jsx)(f,{newLink:L,text:n,url:O,error:u})]})),(0,s.jsx)("div",Object.assign({className:"modal-footer"},{children:(0,s.jsxs)(m.e,Object.assign({className:d()("modal-footer",{stretch:B})},{children:[B&&(0,s.jsx)(p.$n,{icon:"delete",label:H,className:"remove-link",variant:p.Ak.TERTIARY,size:p.Mp.SMALL,onClick:a}),(0,s.jsxs)(m.e,Object.assign({spacing:"small"},{children:[(0,s.jsx)(p.$n,{label:M,variant:p.Ak.SECONDARY,size:p.Mp.SMALL,onClick:c}),(0,s.jsx)(p.$n,{label:D,variant:p.Ak.PRIMARY,disabled:!C,size:p.Mp.SMALL,onClick:j})]}))]}))}))]}))}var y=n(16098);const{MATTERTAGS:O}=o.A.WORKSHOP;function T(e){const{linkUrl:t,linkText:n,onSaveLink:o,onRemoveLink:l,onCancelLink:d}=e,{locale:u}=(0,i.useContext)(r.BR),h=(0,a.t)(),p=""===t?u.t(O.LINK_EDITOR_LINK_ADD_LABEL):u.t(O.LINK_EDITOR_LINK_EDIT_LABEL),m=h===c.a.LINK_EDITOR;return(0,s.jsx)(y.Q,Object.assign({open:m,title:p,fullModal:!1,className:"link-editor-modal"},{children:(0,s.jsx)(b,{linkText:n,linkUrl:t,onCancelLink:d,onSaveLink:o,onRemoveLink:l})}))}},16098:(e,t,n)=>{"use strict";n.d(t,{Q:()=>p});var s=n(74848),i=n(96540),o=n(40961),r=n(32485),a=n.n(r),c=n(40826),l=n(99167),d=n(13820),u=n(55649),h=n(23819);function p(e){const{children:t,className:n,title:r,open:p,onClose:m,fullModal:g}=e,{commandBinder:f,mainDiv:v}=(0,i.useContext)(c.BR),E=(0,i.useRef)(!1),x=(0,i.useCallback)((()=>{f.issueCommand(new u.r),m&&m()}),[f,m]),b=(0,i.useCallback)((()=>{E.current=!0,window.setTimeout((()=>{E.current=!1}),500)}),[]),y=(0,i.useCallback)((()=>{E.current&&(E.current=!1,x())}),[x]),O=v.querySelector("#react-render-root")||document.body,T=a()(n,{open:p,"full-modal":g});return(0,o.createPortal)((0,s.jsx)(h.w,Object.assign({open:p,className:a()("modal-background",{open:p}),onPointerUp:y,onPointerDown:b},{children:(0,s.jsxs)(d.l,Object.assign({className:T,onClose:x},{children:[(0,s.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,s.jsx)("div",Object.assign({className:"modal-title"},{children:r})),(0,s.jsx)(l.J,{onClose:x})]})),t]}))})),O)}},1665:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var s=n(69505);function i(e){return e.get("m")||e.get("model")}function o(e){const t=-1!==e.indexOf("matterport.com/show"),n=-1!==e.indexOf(window.location.host+"/show");if(t||n){const t=new URL(e),n=s.s.deserialize(e)||void 0,o=i(t.searchParams),r=i(new URLSearchParams(window.location.search));return{url:e,pose:n,modelId:o&&o!==r?o:void 0}}return{url:e}}},38187:(e,t,n)=>{"use strict";n.d(t,{u:()=>b});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(40826),c=n(72909),l=n(74435),d=n(44158),u=n(83763),h=n(2040),p=n(25591),m=n(57682),g=n(58919),f=n(89339),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const x="​";let b=class extends i.Component{constructor(e){super(e),this.emailMention=!1,this.wordToken=null,this.endTokens={"@":[","," ","!","?","/",";",":","(",")"],"#":[","," ",".","!","?","/",";",":"]},this.wordElement=null,this.linkElement=null,this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;this.props.active?(e.preventDefault(),n===p.n.LINK&&this.prepareLinkForEdit(t)):n&&this.props.onClickBlock({blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id},e)},this.onSelectionChange=()=>{const e=this.getCurrentRange();if(e){this.range=e.cloneRange();const t=this.wordElement&&null===this.wordElement.parentElement,n=!!this.wordElement&&this.wordElement!==this.getAnchorFromSelection();(t||n)&&this.wordElement&&(this.wordElement.classList.add("link-annotation-active"),this.endWordMatching()),this.insertFocusNodeIfNeeded()}},this.addFauxHighlight=()=>{this.execCommand("backColor","#ff315840")},this.removeFauxHighlight=()=>{this.execCommand("backColor","transparent")},this.isEmailMention=(e="")=>e.lastIndexOf("@")>0,this.onInput=e=>{var t;const n=e.nativeEvent,s=n.inputType,i=s.startsWith("insert"),o="insertLineBreak"===s,r=n.data,a=this.startTokens;e.stopPropagation();const{isLinkNode:c,isSpecialNode:l,anchorNode:d}=this.tryGetAnchorNode();if(a.length&&!c&&!o){let o=r&&r.length>0?r.charAt(r.length-1):"";const c=this.getTextElement(),u=((null==c?void 0:c.innerText)||"").trim().length;if(c&&s.startsWith("delete")&&0===u&&(c.innerHTML=""),this.updateWordElement(n,l,d),!this.wordToken&&a.includes(o)?(e.preventDefault(),this.wordToken=o,this.emailMention=!1,this.createWordElement(o),this.updateSuggestions()):!this.wordToken&&r&&r.length>1&&a.includes(r[0])&&(e.preventDefault(),this.wordToken=r[0],o=r[r.length-1],this.emailMention=this.isEmailMention(r),this.createWordElement(r),this.updateSuggestions()),this.wordToken&&this.wordElement){const n=this.wordElement.textContent||"",s=this.getMatches(n),r=s.length,a=null===(t=this.endTokens[this.wordToken])||void 0===t?void 0:t.includes(o);1===r&&this.sanitizeForSearch(n)===this.sanitizeForSearch(s[0].text)&&i?(e.preventDefault(),this.chooseMatch(s[0].text,s[0].value,s[0].id)):a&&"#"===this.wordToken?(e.preventDefault(),this.finishWordElement(!0)):a&&"@"===this.wordToken?(e.preventDefault(),this.emailMention?this.finishWordElement(!0):0===r&&this.clearWordElement()):"@"===this.wordToken?(this.updateUserMatches(),this.isEmailMention(n)&&(this.wordElement.classList.add("link-annotation-active"),this.emailMention=!0)):this.filterSuggestions()}}this.props.onInput(this.getMarkdown())},this.updateUserMatches=(0,l.s)((()=>this.fetchUserMatches()),350),this.onClickMatch=e=>{const t=e.currentTarget;if(t){const n=t.dataset.value,s=t.dataset.id,i=t.dataset.text||t.innerText;e.stopPropagation(),e.preventDefault(),this.chooseMatch(i,n,s)}},this.onHoverMatch=e=>{const t=e.currentTarget;if(t){const e=parseInt(t.dataset.index||"0",10);this.setState({activeMatch:e})}},this.onClick=e=>{const{active:t,clickToEdit:n,onStartEditing:s}=this.props;t?(this.removeFauxHighlight(),this.range=null):n&&s&&s(e)},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e&&e(!0)},this.onBlur=()=>{this.endWordMatching(),this.setState({sortedSuggestions:[]});const{onFocusChange:e}=this.props;e&&e(!1)},this.onDone=()=>{const{onDoneEditing:e}=this.props;e?e():this.toggleEditing(!1)},this.onKeyDown=e=>{const{onCancelEditing:t,allowTabbing:n,allowReturnKey:s}=this.props,{matches:i,activeMatch:o}=this.state;e.stopPropagation(),this.range||(this.range=this.getCurrentRange());const r=e.which||e.keyCode;switch(r){case d.D.ESCAPE:return void(t&&t());case d.D.TAB:case d.D.RETURN:if(i.length&&o>-1)e.preventDefault(),this.chooseMatch(i[o].text,i[o].value,i[o].id);else{const{isSpecialNode:t,anchorNode:i}=this.tryGetAnchorNode();if(t&&i&&this.range&&(e.preventDefault(),this.insertAndFocusCharacter(i,!1,`\n${x}`)),this.wordToken&&(e.preventDefault(),this.finishWordElement(!1,!0)),!e.shiftKey){const t=r===d.D.TAB&&n,i=r===d.D.RETURN&&s;t||i||(e.preventDefault(),this.onDone())}}return;case d.D.DOWNARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=(e.activeMatch+1)%i.length;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.UPARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=0===e.activeMatch?i.length-1:e.activeMatch-1;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.B:case d.D.I:case d.D.U:if(e.ctrlKey||e.metaKey)return void e.preventDefault();break;case d.D.BACKSPACE:case d.D.SHIFT:case d.D.CONTROL:case d.D.ALT:case d.D.LEFTARROW:case d.D.RIGHTARROW:case d.D.DELETE:return}},this.saveRef=e=>{this.textBox=e},this.bindSuggestionMenuRef=e=>{this.suggestionMenuRef=e},this.state={activeMatch:-1,matches:[],sortedSuggestions:[]}}componentDidMount(){this.props.active&&this.toggleEditing(!0,this.props.focusOnMount)}componentWillUnmount(){this.toggleEditing(!1),this.wordElement=null}componentDidUpdate(e,t){const{active:n}=this.props;n!==e.active&&this.toggleEditing(n)}toggleEditing(e,t){this.textBox&&this.textBox.toggleEditing(e,t),this.endWordMatching(),this.setState({sortedSuggestions:[]}),e?document.addEventListener("selectionchange",this.onSelectionChange):document.removeEventListener("selectionchange",this.onSelectionChange)}ensureActiveMatchIsVisible(e){if(!this.suggestionMenuRef)return;const{scrollTop:t,offsetHeight:n}=this.suggestionMenuRef,s=this.suggestionMenuRef.querySelector(`[data-index="${e}"]`);if(!s)return;const{offsetTop:i,offsetHeight:o}=s,r=t>i;if(t+n<i+o||r){const e=r;s.scrollIntoView(e)}}getTextElement(){var e;return null===(e=this.textBox)||void 0===e?void 0:e.getTextElement()}focus(){this.textBox&&this.textBox.focus()}getMarkdown(){const e=this.getTextElement();return e?this.props.textParser.serialize(e):""}hasTextSelected(){return!(!this.range||this.range.startOffset===this.range.endOffset)}createAnchor(e,t){const n=document.createElement("a");return n.href=t,n.text=this.props.textParser.sanitizeText(e),n.classList.add(m.H.LINK),n.setAttribute("data-value",t),n}prepareLinkForEdit(e){const t=e||this.getAnchorFromSelection();let n="";const s=window.getSelection();if(s){const e=this.getTextElement();t||this.range||!e?(this.addFauxHighlight(),t||(n=this.range?this.range.toString():s.toString())):(this.focus(),s.selectAllChildren(e),s.collapseToEnd(),this.range=s.getRangeAt(0),n=this.range.toString())}n===x&&(n=""),this.linkElement=t;const i=t?t.innerText:n,o=t?t.dataset.value||t.href:"";this.props.onClickBlock({blockType:p.n.LINK,text:i,value:o})}saveLink(e,t){this.linkElement?""!==t?this.updateLink(this.linkElement,e,t):this.unlink(this.linkElement):this.linkify(e,t)}updateLink(e,t,n){const s=this.createAnchor(t,n);return e.href=s.href,e.text=s.text,e.setAttribute("data-value",n),!0}cancelLink(){this.focus(),this.removeFauxHighlight()}linkify(e,t){this.removeFauxHighlight(),this.execCommand("createLink",t);let n=this.getAnchorFromSelection();!n&&this.range&&(n=document.createElement("a"),n.href=t,this.range.insertNode(n)),n&&(n.text=e,n.className=`link-annotation ${m.H.LINK}`,n.setAttribute("data-blocktype",p.n.LINK),n.setAttribute("data-value",t),n.onclick=this.onClickAnchor,this.insertAndFocusCharacter(n))}insertAndFocusCharacter(e,t=!1,n=x){if(this.range=this.getCurrentRange(),this.range){const s=document.createTextNode(n),i=t?"setStartBefore":"setStartAfter",o=t?"setEndBefore":"setEndAfter";this.range[i](e),this.range[o](e),this.range.insertNode(s),this.range.selectNodeContents(s),n!==x&&this.range.collapse(!1),this.applyRange()}}unlink(e){const t=e.parentNode,n=e.textContent;t&&(t.removeChild(e),n&&!(0,u.q)(n)&&this.execCommand("insertText",n))}execCommand(e,t){this.range&&(this.applyRange(),document.execCommand(e,!1,t),this.onSelectionChange())}applyRange(){if(this.range){const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(this.range))}}getAnchorFromSelection(){const e=this.getCurrentRange();if(!e)return null;let t=e.commonAncestorContainer;for(;t&&"A"!==t.nodeName;){if(t===this.getTextElement())return null;t=t.parentNode}return t||null}insertFocusNodeIfNeeded(){var e,t;const n=window.getSelection();if(!n||!this.range)return;const{anchorNode:s,isLinkNode:i}=this.tryGetAnchorNode();if(s){const o=null!==(t=null===(e=s.textContent)||void 0===e?void 0:e.length)&&void 0!==t?t:0,r=0===n.focusOffset&&o>0,a=null===s.nextSibling&&o===n.focusOffset&&i;(r||a)&&this.insertAndFocusCharacter(s,r)}}getCurrentRange(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),n=this.getTextElement();if(n&&(n===t.commonAncestorContainer||n.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}sortWords(e){return e.sort(((e,t)=>e.text.toLowerCase()<t.text.toLowerCase()?-1:1))}tryGetAnchorNode(){var e;const t=this.getAnchorFromSelection();if(t&&t instanceof HTMLAnchorElement){const n=null===(e=t.dataset)||void 0===e?void 0:e.blocktype,s=n===p.n.USER||n===p.n.HASH,i=n===p.n.LINK;return{isSpecialNode:s,isLinkNode:i,anchorNode:s||i?t:null}}return{isSpecialNode:!1,isLinkNode:!1,anchorNode:null}}updateWordElement(e,t,n){const s=e.inputType.startsWith("delete"),i=window.getSelection(),o=this.startTokens;if(!this.wordElement||this.wordElement.parentElement){if(t&&n&&n.parentElement&&i){const e=n.textContent||"";if(!o.includes(e[0]||""))return void this.clearWordElement();const t=e.substr(0,i.focusOffset),r=i&&i.focusOffset<e.length,a=s||r;if(this.wordElement=n,this.wordToken=t[0],this.emailMention=this.isEmailMention(t),this.updateSuggestions(),this.range=this.getCurrentRange(),a&&this.range){this.range.selectNode(n);const s=this.range.extractContents();if(s&&s.firstElementChild&&s.firstElementChild instanceof HTMLElement){const n=e.substring(t.length),i=document.createTextNode(n);s.firstElementChild.innerText=t,s.firstElementChild.classList.remove("link-annotation-active"),s.firstElementChild.removeAttribute("data-value"),s.firstElementChild.removeAttribute("data-id"),s.appendChild(i),this.range.insertNode(s),this.range.setStartBefore(i),this.range.setEndBefore(i),this.range.collapse(!1),this.range.selectNodeContents(this.wordElement),this.range.collapse(!1),this.applyRange()}}}}else this.endWordMatching()}get startTokens(){const{hashtags:e,userMentions:t}=this.props,n=[];return t&&n.push("@"),e&&n.push("#"),n}fetchUserMatches(){const e=this.wordElement?this.wordElement.textContent:null;if(this.props.active&&this.wordToken&&e){const t=this.sanitizeForSearch(e,!0);this.context.commandBinder.issueCommand(new h.ly(t)).then((()=>{this.updateSuggestions()}))}}filterSuggestions(){const{wordToken:e,wordElement:t}=this;if(e&&t&&t.textContent){const e=this.sanitizeForSearch(t.textContent),n=this.getMatches(e),s=n.length>0?0:-1;this.setState({matches:n,activeMatch:s})}}sanitizeForSearch(e="",t){if(!this.wordToken)return e;let n=(e.startsWith(this.wordToken)?e.substr(1):e).toLowerCase().trim().replace(/\s\s+/g," ");if(t){const e=/([^\s]+)/.exec(n);n=e&&e[0]||""}return n}getMatches(e){const{sortedSuggestions:t=[]}=this.state,n=this.sanitizeForSearch(e)||"";return 0===n.length?t:t.filter((e=>{let t=0===this.sanitizeForSearch(e.text).indexOf(n);return!t&&"@"===this.wordToken&&e.value&&(t=0===this.sanitizeForSearch(e.value).indexOf(n)),t}))}chooseMatch(e,t,n){const s=this.wordElement;if(s){const i=this.wordToken&&!e.startsWith(this.wordToken)?this.wordToken:"";s.innerText=`${i}${e}`,s.classList.add("link-annotation-active"),t&&s.setAttribute("data-value",t),n&&s.setAttribute("data-id",n),this.finishWordElement(!1,!0),this.props.onInput(this.getMarkdown())}}updateSuggestions(){const{wordToken:e}=this,{hashtags:t,userMentions:n}=this.props;let s=[];if("#"===e&&t)s=this.sortWords(t.map((e=>({text:e,blockType:p.n.HASH}))));else if("@"===e&&n){const e=this.context.userData.getKnownUsers();s=this.sortWords(e.map((e=>({text:e.name,id:e.id,value:e.email,blockType:p.n.USER}))))}this.setState({sortedSuggestions:s},this.filterSuggestions)}endWordMatching(){this.setState({matches:[],activeMatch:-1}),this.wordToken=null,this.wordElement=null,this.emailMention=!1}createWordElement(e){const t=window.getSelection(),n=this.range;if(!n||!t||!this.wordToken)return;const s=document.createElement("a");s.removeAttribute("href"),s.innerText=e,"#"===this.wordToken?(s.className=`link-annotation ${m.H.HASH}`,s.setAttribute("data-blocktype",p.n.HASH)):"@"===this.wordToken&&(s.className=`link-annotation ${m.H.USER}`,s.setAttribute("data-blocktype",p.n.USER));const i=n.startContainer,o=n.startOffset,r=n.endOffset+e.length,a=Math.max(0,(i.textContent||"").length);try{n.setStart(i,Math.min(o,a)),n.setEnd(i,Math.min(r,a))}catch(e){n.selectNodeContents(i)}n.deleteContents(),n.insertNode(s),n.selectNodeContents(s),n.collapse(!1),this.applyRange(),this.wordElement=s}clearWordElement(){const e=this.range,t=window.getSelection();e&&t&&this.wordElement&&this.wordToken&&(this.stripAnchorFromNode(this.wordElement),this.endWordMatching())}stripAnchorFromNode(e){const t=this.range;if(!t)return;const n=e.textContent;if(this.focus(),t.selectNode(e),t.deleteContents(),t.collapse(!1),n){const e=document.createTextNode(n);t.insertNode(e),t.selectNodeContents(e),t.collapse(!1)}this.applyRange()}isValidSpecialWord(e,t){return 0!==this.sanitizeForSearch(t).length||(this.clearWordElement(),!1)}finishWordElement(e,t){const{range:n,wordElement:s,wordToken:i}=this,o=window.getSelection();if(!(n&&o&&s&&i))return;s.contentEditable="true",s.classList.add("link-annotation-active");let r="";const a=s.textContent;if(this.isValidSpecialWord(i,a||"")){if(e&&a&&a.length>1?(r=a.charAt(a.length-1),s.textContent=a.slice(0,-1)):t&&(r=" "),this.focus(),n.setStartAfter(s),r){const e=document.createTextNode(r);n.insertNode(e),n.selectNodeContents(e),n.collapse(!1)}this.applyRange(),this.endWordMatching()}else this.clearWordElement()}renderMatch(e,t){const{activeMatch:n}=this.state,i=t===n,o=e.blockType===p.n.USER,a=o&&e.value?this.context.userData.getUserDisplay(e.value):null,c=o?e.value:void 0,l=`${e.text}-${t}`;return(0,s.jsxs)("div",Object.assign({className:r()("suggestion",{selected:i}),onMouseDown:this.onClickMatch,onMouseEnter:this.onHoverMatch,"data-value":e.value,"data-id":e.id,"data-text":e.text,"data-index":t},{children:[o&&a&&(0,s.jsx)(f.E,{badgeStyle:{color:a.color,borderColor:a.color,backgroundColor:"transparent"},label:a.initials}),(0,s.jsx)("span",Object.assign({className:"suggestion-text"},{children:e.text})),c&&(0,s.jsxs)("p",Object.assign({className:"suggestion-hint"},{children:["(",c,")"]}))]}),l)}renderMatches(){if(!this.props.active)return null;const{matches:e}=this.state,t=e.length>0;return(0,s.jsx)("div",Object.assign({className:r()("suggestion-menu",{open:t}),ref:this.bindSuggestionMenuRef},{children:t&&e.map(((e,t)=>this.renderMatch(e,t)))}))}render(){const{text:e,textParser:t,clickToEdit:n,placeholder:i,tabIndex:o,className:a,active:c}=this.props;return(0,s.jsxs)("div",Object.assign({className:r()("smart-text-box",a)},{children:[(0,s.jsx)(g.A,{ref:this.saveRef,text:e,textParser:t,active:c,placeholder:i,tabIndex:o,clickToEdit:n&&!c,onClick:this.onClick,onInput:this.onInput,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.handleFocus,onClickAnchor:this.onClickAnchor}),this.renderMatches()]}))}};b.contextType=a.BR,b=v([c.F,E("design:paramtypes",[Object])],b)},58919:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(40826),l=n(44158),d=n(52775),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.textElement=(0,i.createRef)(),this.editing=!1,this.isUnmounting=!1,this.stopPropagation=e=>e.stopPropagation(),this.onPaste=e=>{if(!e.clipboardData||!this.textElement.current)return;let t=e.clipboardData.getData("text/plain");t=this.props.textParser.sanitizeText(t),e.preventDefault(),t&&document.execCommand("insertText",!1,t)},this.onKeyDown=e=>{if(!this.textElement.current)return;const{onKeyDown:t}=this.props;(e.which||e.keyCode)===l.D.RETURN&&(e.shiftKey||e.altKey)?document.execCommand("insertText",!1,"\n"):t&&t(e)},this.onMouseDown=e=>{const{onClick:t,clickToEdit:n,readonly:s}=this.props;t&&(e.stopPropagation(),t(e)),s||!this.editing&&n&&this.toggleEditing(!0)},this.onFocus=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.Yl(this.textElement.current,!0)),this.props.onFocus&&this.props.onFocus(e))},this.onBlur=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.Yl(this.textElement.current,!1)),this.props.onBlur&&this.props.onBlur(e))}}componentDidMount(){this.replaceTextContent(this.props.text)}componentWillUnmount(){this.isUnmounting=!0,this.textElement.current&&this.textElement.current.blur()}componentDidUpdate(e){const{text:t,active:n}=this.props;t===e.text&&n===e.active||this.replaceTextContent(t)}shouldComponentUpdate(){return!1}getTextElement(){return this.textElement.current}getPlainText(){var e;return(null===(e=this.textElement.current)||void 0===e?void 0:e.innerText)||""}focus(){this.editing&&this.textElement.current&&this.textElement.current.focus()}toggleEditing(e,t=!0){clearTimeout(this.toggleEditingTimeout),this.toggleEditingTimeout=window.setTimeout((()=>{this.textElement.current&&!this.isUnmounting&&(this.editing!==e&&(this.editing=e,this.textElement.current.contentEditable=e?"true":"false",e?this.textElement.current.classList.add("editing"):this.textElement.current.classList.remove("editing")),e&&t?this.textElement.current.focus():this.textElement.current.blur())}),0)}replaceTextContent(e){clearTimeout(this.replaceTextContentTimeout),this.replaceTextContentTimeout=window.setTimeout((()=>{if(!this.textElement.current||this.isUnmounting)return;for(;this.textElement.current.firstChild;)this.textElement.current.removeChild(this.textElement.current.firstChild);const t=document.createDocumentFragment(),{textParser:n,markers:s,onClickAnchor:i,active:o,readonly:r,maxLength:a,clickableLinks:c}=this.props,l=void 0!==c?c:!o,d=n.deserialize(e,l,i,s);let u=0,h=!d.every((e=>{var n;const s=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0;if(r&&a&&u+s>a){if("#text"===e.nodeName){const n=e.textContent||"";e.textContent=n.substring(0,a-u),t.appendChild(e)}return!1}return!r&&o&&"A"===e.nodeName&&(e.contentEditable="true"),u+=s,t.appendChild(e),!0}));h&&t.appendChild(document.createTextNode("...")),this.textElement.current.appendChild(t),this.focus(),r&&!h&&this.props.maxLines&&this.textElement.current.scrollHeight>this.textElement.current.offsetHeight&&(h=!0,this.textElement.current.appendChild(document.createTextNode("..."))),this.props.onTextReplaced&&this.props.onTextReplaced(h)}),0)}render(){const{placeholder:e,tabIndex:t,onInput:n,readonly:i,maxLines:o,text:a}=this.props,c=i&&o,l=c?{WebkitLineClamp:o}:{},d=r()("text-box-text",{clamped:c,placeholder:!!e&&!a});return(0,s.jsx)("div",{ref:this.textElement,className:d,style:l,role:"textbox",draggable:!1,spellCheck:!0,contentEditable:!1,placeholder:e,"aria-label":e,onMouseDown:this.onMouseDown,onKeyDown:i?void 0:this.onKeyDown,onKeyUp:i?void 0:this.stopPropagation,onFocus:i?void 0:this.onFocus,onBlur:i?void 0:this.onBlur,onInput:i?void 0:n,onPaste:i?void 0:this.onPaste,tabIndex:t})}};p.contextType=c.BR,p=u([a.F,h("design:paramtypes",[Object])],p);const m=p},64599:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var s=n(40270);function i(e){return e.width<=s._8}},83763:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var s=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");const i=e=>(e=>s.test(e))(e)&&/^https?:\/\//.test(e)},74568:(e,t,n)=>{"use strict";n.d(t,{OR:()=>r,Zl:()=>a,v0:()=>o,v3:()=>i,vp:()=>c});var s=n(13686);class i extends s.E{constructor(e,t,n,s){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=s}}class o extends s.E{constructor(e,t,n,s,i){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=s,this.progress=i}}class r extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.buttons=n}}class a extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.buttons=n}}class c extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.cancelled=n}}},51889:(e,t,n)=>{"use strict";if(n.d(t,{U:()=>o,t:()=>r}),5602==n.j)var s=n(5573);if(5602==n.j)var i=n(44383);var o;!function(e){e.DISC_COLOR="disc_color",e.STEM_VISIBLE="stem_visible",e.STEM_LENGTH="stem_length",e.TITLE="title",e.DESCRIPTION="description",e.MEDIA="media",e.LINKS="links",e.ENABLED="enabled",e.KEYWORDS="keywords"}(o||(o={}));class r{constructor(){this.handlers=[{msgType:s.Y_,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera};e.track("mattertag_add",n)}},{msgType:s.Fj,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_remove_method:t.removeMethod};e.track("mattertag_remove",n)}},{msgType:s.On,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};e.track("mattertag_add_title",n)}},{msgType:s.GN,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};let s=1;t.tagDescriptionChunks.forEach((e=>{"link"===e.type&&void 0!==e.link&&(n["mattertag_link_domain"+s++]=(0,i.SE)(e.link.url))})),e.track("mattertag_add_description",n)}},{msgType:s.KW,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_property:t.property,mattertag_value:t.value};e.track("mattertag_edit",n)}},{msgType:s.oO,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera,mattertag_distance_moved:t.distanceMoved};e.track("mattertag_moved",n)}},{msgType:s.EX,func:(e,t)=>{const n={mattertag_sid:t.sid,media_type:t.mediaType,media_src:t.mediaSrc};e.track("mattertag_add_media",n)}}]}}},5573:(e,t,n)=>{"use strict";n.d(t,{EX:()=>c,Fj:()=>o,GN:()=>a,KW:()=>l,On:()=>r,Y_:()=>i,oO:()=>d});var s=n(14754);class i extends s.QB{constructor(e,t,n){super(),this.sid=e,this.position=t,this.distanceFromCamera=n}}class o extends s.QB{constructor(e,t){super(),this.sid=e,this.removeMethod=t}}class r extends s.QB{constructor(e,t){super(),this.sid=e,this.characterCount=t}}class a extends s.QB{constructor(e,t,n){super(),this.sid=e,this.characterCount=t,this.tagDescriptionChunks=n}}class c extends s.QB{constructor(e,t,n){super(),this.sid=e,this.mediaType=t,this.mediaSrc=n}}class l extends s.QB{constructor(e,t,n){super(),this.sid=e,this.property=t,this.value=n}}class d extends s.QB{constructor(e,t,n,s){super(),this.sid=e,this.position=t,this.distanceFromCamera=n,this.distanceMoved=s}}},24081:(e,t,n)=>{"use strict";var s;n.d(t,{f:()=>s}),function(e){e[e.Standard=0]="Standard",e[e.Depth=1]="Depth",e[e.Transparent=2]="Transparent",e[e.Wireframe=3]="Wireframe",e[e.UV=4]="UV",e[e.CeilingSample=5]="CeilingSample",e[e.FloorSample=6]="FloorSample"}(s||(s={}))},10691:(e,t,n)=>{"use strict";n.d(t,{B:()=>l});var s=n(68909),i=n(23847),o=n(34944),r=n(12183),a=n(94221),c=n(97624);class l extends a.r{constructor(e,t,n=i.H.ALL){super(),this._opacity=1,this._chunks=[],this.size=new s.Vector3,this.center=new s.Vector3,this.built=!1,this.layers.mask=n.mask,this.name=`RoomMesh:${e}-${t}`,this.meshGroup=e,this.meshSubgroup=t,this.renderOrder=r.X.default,this.castShadow=l.ShouldCastShadow,this.onBeforeRender=(e,t,n,s,i,o)=>{this.updateUniforms(i,o)}}dispose(){this.reset()}reset(){this._chunks.length=0,this.geometry.dispose(),delete this.onBuild,delete this.onOpacityUpdate,this.built=!1}addChunk(e){-1===this._chunks.indexOf(e)&&this._chunks.push(e)}getChunk(e){return this._chunks[e]}build(){if(this.built)throw new Error("build() should only be called once");if(!this._chunks.length)return;const e=(0,o.h0)(this._chunks.map((e=>e.geometry)));e.clearGroups();let t=0;this.material=[],this._chunks.forEach(((n,s)=>{n.geometry&&n.geometry.index&&(e.addGroup(t,n.geometry.index.count,s),t+=n.geometry.index.count,n.geometry.dispose(),n.geometry=e,n.notifyOnMaterialUpdated((e=>{Array.isArray(this.material)&&(this.material[s]=e),this.onMaterialUpdate&&this.onMaterialUpdate()})),n.onOpacityUpdate=e=>{this.opacity=e})})),this.geometry=e,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this.material=this._chunks.map((e=>e.material)),this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0,this.onBuild&&this.onBuild()}buildWithSingleChunk(e){if(this.built)return;const{meshGroup:t,meshSubgroup:n,lod:s}=e;this.name=`RoomMesh:${s}-${t}-${n}-${e.chunkIndex}`,this.meshGroup=t,this.meshSubgroup=n,this._chunks.push(e),e.notifyOnMaterialUpdated((e=>{this.material=e,this.onMaterialUpdate&&this.onMaterialUpdate()})),e.onOpacityUpdate=e=>{this.opacity=e},this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0,this.onBuild&&this.onBuild()}updateUniforms(e,t){e instanceof s.ShaderMaterial&&(t?this.chunks[t.materialIndex].onBeforeDraw(e):this.chunks.length&&this.chunks[0].onBeforeDraw(e))}get boundingBox(){return(0,o.UX)(this.geometry)}set opacity(e){e!==this.opacity&&(this._opacity=e,this.raycastEnabled=e>c.u7.FADE_CLICKABLE_THRESHOLD,this.renderOrder=e<c.u7.FADE_OPAQUE?r.X.ghostFloor:r.X.default,this.onOpacityUpdate&&this.onOpacityUpdate(e))}get opacity(){return this._opacity}get chunks(){return this._chunks}getSortKey(){return this.chunks.length?this._chunks[0].getSortKey():0}}l.ShouldCastShadow=!1},75092:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});var s=n(18268);class i extends s.u{constructor(e=null){super(),this.payload={cursor:e}}}i.id="SET_MOUSE_CURSOR"},28883:(e,t,n)=>{"use strict";var s;n.d(t,{b:()=>s}),function(e){e.NONE="none",e.DEFAULT="default",e.MOVE="move",e.MOVE_LF="col-resize",e.MOVE_UD="row-resize",e.XHAIR="crosshair",e.PLUS="cell",e.QUESTION="help",e.NOPE="not-allowed",e.FINGER="pointer",e.TEXT="text",e.TEXT_VERT="vertical-text",e.ZOOM_IN="zoom-in",e.ZOOM_OUT="zoom-in",e.GRAB="grab",e.GRABBING="grabbing",e.ARROW_R="e-resize",e.ARROW_L="w-resize",e.ARROW_U="n-resize",e.ARROW_D="s-resize",e.ARROW_UR="ne-resize",e.ARROW_UL="nw-resize",e.ARROW_DR="se-resize",e.ARROW_DL="sw-resize",e.ARROW_LR="ew-resize",e.ARROW_UD="ns-resize",e.ARROW_URDL="nesw-resize",e.ARROW_ULDR="nwse-resize",e.ROOMBOUNDS_DEFAULT="rbe-default",e.ROOMBOUNDS_MOVING="rbe-moving",e.ROOMBOUNDS_PLACE_NODE="rbe-place-node",e.ROOMBOUNDS_FINISH_ROOM="rbe-finish-room"}(s||(s={}))},44045:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var s=n(61589),i=n(45021);class o extends s.B{constructor(){super(...arguments),this.name="hashtag-data",this.hashtags=(0,i.Z)([])}addHashtags(e){this.atomic((()=>{e.forEach((e=>{this.addHashtag(e)}))}))}addHashtag(e){const t=e.trim().toLowerCase();-1===this.hashtags.map((e=>e.trim().toLowerCase())).indexOf(t)&&this.hashtags.push(e)}getHashtags(){return this.hashtags.values()}}},8085:(e,t,n)=>{"use strict";var s;n.d(t,{f:()=>s}),function(e){e.CLOSED="closed",e.IDLE="idle",e.CREATING="creating",e.OPENING="opening",e.OPEN="open",e.EDITING="editing"}(s||(s={}))},31717:(e,t,n)=>{"use strict";n.d(t,{b:()=>d});var s=n(61589),i=n(41733),o=n(54998),r=n(16672),a=n(8085),c=n(57863),l=n(89998);class d extends s.B{constructor(e,t,n,s){super(),this.data=e,this.textParser=t,this.linkHandler=n,this.backgroundTexture=s,this.name="notes-view-data",this.noteViewsMap=(0,o.y)(),this.isNewNote=!1,this.openNoteViewObservable=(0,i.p)(null),this.focusedCommentObservable=(0,i.p)(null),this.activeNotationObservable=(0,i.p)(null),this.idVisibilityEnabled=!1,this.idVisibility=new Set,this.notesPhaseObservable=(0,i.p)(a.f.CLOSED),this.notesFilterObservable=(0,i.p)(c.S.OPEN),this.updateNoteViews=()=>{const e={};this.data.iterate((t=>{var n;const s=this.createNoteView(t);e[t.id]=s,(null===(n=this.openNoteView)||void 0===n?void 0:n.id)===s.id&&this.setOpenNoteView(s)})),this.noteViewsMap.replace(e)},this.sortByDate=(e,t)=>t.lastCommentMs-e.lastCommentMs,this.filterByResolved=e=>this.notesFilter===c.S.ALL||e.resolved===(this.notesFilter===c.S.RESOLVED),this.noteViews=new r.q(this.noteViewsMap),this.noteViews.priority=r.g.LOW,this.notesFilter!==c.S.ALL&&this.noteViews.setFilter(this.notesFilter,this.filterByResolved),this.noteViews.sort(this.sortByDate),this.updateNoteViews()}getFilteredNotesMap(){return this.noteViews}getNoteViewsMap(){return this.noteViewsMap}getNoteView(e){return this.noteViewsMap.get(e)}getTextParser(){return this.textParser}getLinkHandler(){return this.linkHandler}getComment(e,t){const n=this.getNoteView(e);return(null==n?void 0:n.comments.find((e=>e.id===t)))||null}getReply(e,t){const n=this.getNoteView(e);return(null==n?void 0:n.comments.find(((e,n)=>n>0&&e.id===t)))||null}getAttachment(e,t,n){var s;const i=(null===(s=this.getNoteView(e))||void 0===s?void 0:s.comments.find((e=>e.id===t)))||null;return(null==i?void 0:i.attachments.find((e=>e.id===n)))||null}createNoteView(e){return Object.assign(Object.assign({},e),{backgroundTexture:this.backgroundTexture,icon:l.tf[l.yY.NOTE]})}getCommentUserMentions(e,t){const n=[];return this.textParser.getUserMentions(e).forEach((e=>{const s=t[e];s&&n.push(s)})),n}getNoteAttachments(e){const t=[],n=this.getNoteView(e);return n&&n.comments.forEach((e=>{t.push(...e.attachments)})),t}getPendingNote(){return this.isNewNote&&this.openNoteView?this.openNoteView:null}setNotesPhase(e){this.notesPhaseObservable.value=e}get notesPhase(){return this.notesPhaseObservable.value}onNotesPhaseChanged(e){return this.notesPhaseObservable.onChanged(e)}setNotesFilter(e){const t=this.notesFilterObservable.value;this.notesFilterObservable.value=e,this.noteViews.atomic((()=>{this.noteViews.clearFilter(t),e!==c.S.ALL&&this.noteViews.setFilter(e,this.filterByResolved)}))}get notesFilter(){return this.notesFilterObservable.value}onNotesFilterChanged(e){return this.notesFilterObservable.onChanged(e)}setActiveNotation(e){this.activeNotationObservable.value=e}get activeNotation(){return this.activeNotationObservable.value}onActiveNotationChanged(e){return this.activeNotationObservable.onChanged(e)}setOpenNoteView(e){this.openNoteViewObservable.value=e}get openNoteView(){return this.openNoteViewObservable.value}onOpenNoteViewChanged(e){return this.openNoteViewObservable.onChanged(e)}resetOpenNoteView(){const e=this.openNoteView;if(e){const t=this.data.getNoteProperties(e.id);t&&this.updateOpenNoteView(t)}}updateOpenNoteView(e){const t=this.openNoteView;t&&Object.assign(t,e)}setFocusedComment(e){this.focusedCommentObservable.value=e}get focusedComment(){return this.focusedCommentObservable.value}onFocusedCommentChanged(e){return this.focusedCommentObservable.onChanged(e)}}},57863:(e,t,n)=>{"use strict";var s,i;n.d(t,{D:()=>i,S:()=>s}),function(e){e.OPEN="open",e.RESOLVED="resolved",e.ALL="all"}(s||(s={})),function(e){e.DEFAULT="default",e.HIGHLIGHTED="highlighted",e.DIMMED="dimmed"}(i||(i={}))},85127:(e,t,n)=>{"use strict";n.d(t,{V:()=>d});var s=n(74848),i=n(99366),o=n(38216),r=n(23168),a=n(99860),c=n(76481);const{NOTES:l}=i.A.SHOWCASE;function d({userName:e,description:t,numAttachments:n,numComments:i,searchText:d}){const u=(0,a.V)(),h=(0,o.Y)(),p=i-1,m=(d?(0,r.x8)(e,d):e).trim(),g=h.t(l.REPLIES,p);let f="";return""===t?n>0?f=h.t(l.NUM_ATTACHMENTS,n):0===p&&(f=h.t(l.CONTENT_DELETED)):f=(d?(0,r.x8)(t,d):t).trim(),(0,s.jsxs)("div",Object.assign({className:"item-details"},{children:[(0,s.jsxs)("div",Object.assign({className:"item-header"},{children:[u&&(0,s.jsx)(c.L,{text:m.trim(),textParser:u,markers:r.S8}),p>0&&!d&&(0,s.jsx)("span",Object.assign({className:"note-summary-info note-replies"},{children:g}))]})),u&&(0,s.jsx)("div",Object.assign({className:"item-description"},{children:(0,s.jsx)(c.L,{text:f,textParser:u,markers:r.S8,linksActive:!1})}))]}))}},86889:(e,t,n)=>{"use strict";n.d(t,{$:()=>A,B:()=>C});var s=n(74848),i=n(96540),o=n(40826),r=n(99366),a=n(38216),c=n(34466),l=n(25615),d=n(58330),u=n(11360),h=n(61412),p=n(9876),m=n(21891),g=n(11707),f=n(77704),v=n(87987),E=n(99224),x=n(52385),b=n(35216),y=n(89339),O=n(85127);n(17073);const{NOTES:T}=r.A.SHOWCASE,C=({item:e})=>e?(0,s.jsx)(A,{item:e},e.id):null,A=({item:e})=>{const t=(0,i.useRef)(null),{commandBinder:n,analytics:C,editMode:A}=(0,i.useContext)(o.BR),_=(0,a.Y)(),S=(0,d.H)(),j=(0,u.T)(),R=(0,f.r)(),N=(0,c.e)(),k=(0,l.P)(),w=(0,h.L)();if(!k)return null;const{id:I,title:L,description:P,color:D,resolved:M,user:U,numAttachments:H,numComments:B}=e,V=I,F=e.parentId;if(!F||!V)return null;const G=F===(null==R?void 0:R.id),W=M||!e.isLayerVisible(),K=(0,m.q2)(k,p.U.NOTE,U),Y=(0,m.db)(k,p.U.NOTE,U),$=_.t(T.EDIT_LIST_ITEM_OPTION_CTA),z=_.t(T.DELETE_LIST_ITEM_OPTION_CTA),X=K||Y?(0,s.jsx)(v.e,{children:(0,s.jsxs)(E.y,Object.assign({ref:t,icon:"more-vert",ariaLabel:_.t(r.A.MORE_OPTIONS),variant:x.Ak.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu"},{children:[(0,s.jsx)(x.$n,{label:$,size:x.Mp.SMALL,disabled:!K,variant:x.Ak.TERTIARY,onClick:()=>{C.trackGuiEvent("notes_list_edit_note",{tool:w}),n.issueCommand(new g.FV(F,!0,!0,V))}}),(0,s.jsx)(x.$n,{className:"menu-delete-btn",label:z,size:x.Mp.SMALL,disabled:!Y,variant:x.Ak.TERTIARY,onClick:()=>{C.trackGuiEvent("notes_list_delete_note",{tool:w}),n.issueCommand(new g.T0(F))}})]}))}):void 0,J=(0,s.jsx)(O.V,{description:P,userName:L,numAttachments:H,numComments:B,searchText:N}),q=(0,s.jsx)(y.E,{badgeStyle:D?{backgroundColor:D,borderColor:D}:void 0,iconClass:"icon-comment"});return(0,s.jsx)(b.c,{id:V,className:"search-result-item notes-list-item",title:J,badge:q,active:G,disabled:W,onClick:async()=>{C.trackGuiEvent("search_item_note_click",{tool:w}),e.onSelect(A,j,S)},actions:X},V)}},47544:(e,t,n)=>{"use strict";n.d(t,{y:()=>y});var s=n(9321),i=n(521),o=n(54244),r=n(57642),a=n(3520),c=n(54839),l=n(21296),d=n(20322),u=n(2409),h=n(31717),p=n(11707),m=n(8085),g=n(86889),f=n(99366),v=n(95149),E=n(59105),x=n(97984);const{NOTES:b}=f.A.SHOWCASE;class y{constructor(e,t){this.engine=e,this.settings=t,this.disabledAssets={[d.f]:!1,[l.RP]:!1,[c.s]:!1,[u.qE]:!1},this.settingsToggler=new a.U(this.settings,this.disabledAssets),this.initPromise=this.init()}async init(){const{market:e}=this.engine;[this.notesViewData,this.searchData]=await Promise.all([e.waitForData(h.b),e.waitForData(r.L)]),this.setSearchItemFC(!0)}async activate(){this.settingsToggler.toggle(!0),await this.initPromise,await this.engine.commandBinder.issueCommand(new p.I8(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new p.I8(!1)),this.settingsToggler.toggle(!1)}async dispose(){await this.initPromise,this.setSearchItemFC(!1)}setSearchItemFC(e){const t=this.searchData.getSearchDataTypeGroup(o.jM.NOTE);t&&(t.itemFC=e?g.$:void 0)}async deepLink(e){const t=(await this.engine.market.waitForData(h.b)).getNoteView(e);if(t)(0,E.zX)(this.settings,t,(t=>{this.engine.commandBinder.issueCommand(new p.FV(e,!0,!1,(0,v.EN)().comment,t))}));else{const e={messagePhraseKey:b.MISSING_MESSAGE,timeout:4e3,dismissesOnAction:!0};this.engine.commandBinder.issueCommand(new x.Q(e)),this.engine.commandBinder.issueCommandWhenBound(new s.yU(i.S0.NOTES,!0))}}async hasPendingEdits(){const{notesPhase:e,activeNotation:t}=this.notesViewData;switch(e){case m.f.IDLE:case m.f.CLOSED:case m.f.OPENING:return!1;case m.f.EDITING:case m.f.CREATING:return!0;default:return!!t}}}},3744:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var s=n(74848),i=n(96540),o=n(40826),r=n(521),a=n(75414),c=n(97137),l=n(9962),d=n(9876),u=n(21891),h=n(25615),p=n(89998),m=n(47223),g=n(3302),f=n(36042),v=n(8085),E=n(11707),x=n(77704),b=n(57021),y=n(83421),O=n(90863),T=n(16616),C=n(52385),A=n(36354),_=n(98260),S=n(99366),j=n(8430),R=n(38216),N=n(68850),k=n(1003);const{NOTES:w}=S.A.SHOWCASE;function I(){const e=(0,i.useMemo)((()=>(0,j.C8)()),[]),t=(0,m.f)(),n=(0,N.w)(),o=(0,R.Y)(),r=t===p.ce.CREATING,a=t===p.ce.PLACING;let c=null;if(r||!n||!e&&a){const t=o.t(e?w.OVERLAY_ADD_TOUCH:w.OVERLAY_ADD_CLICK),s=o.t(e?w.OVERLAY_PLACE_TOUCH:w.OVERLAY_PLACE_CLICK);c=n?t:s}return c?(0,s.jsxs)(k.W,{children:[(0,s.jsx)("div",{className:"icon icon-notes"}),(0,s.jsx)("span",Object.assign({className:"message"},{children:c}))]}):null}var L=n(63690),P=n(31323),D=n(77985),M=n(9544);const{NOTES:U}=S.A.SHOWCASE;function H({canEdit:e,canDelete:t}){const n=(0,i.useRef)(null),{commandBinder:a,analytics:l}=(0,i.useContext)(o.BR),d=(0,b.m)(),u=(0,x.r)(),h=(0,O.g)(),g=(0,c.O)(),f=(0,m.f)(),y=(0,L.W)(),T=(0,R.Y)(),A=f!==p.ce.IDLE,_=d===v.f.EDITING,S=T.t(U.COLOR_STEM_TOOLTIP),j=T.t(U.DELETE_TOOLTIP),N=T.t(U.ADD_TOOLTIP),k=T.t(U.CANCEL_TOOLTIP),w=A?k:N,I=g===r.L$.SIDE_PANEL,H=A?P.R.CANCEL:P.R.ADD,B=A,V=I&&e&&!A?(0,s.jsx)(C.$n,{className:"action-button-outer",icon:"stem-height",variant:C.Ak.FAB,theme:"overlay",active:_,tooltip:S,onClick:()=>{a.issueCommand(new E.dz(!_))}}):void 0,F=I&&t&&!A?(0,s.jsx)(C.$n,{className:"action-button-outer",variant:C.Ak.FAB,theme:"overlay",icon:"delete",tooltip:j,onClick:()=>{u&&(l.trackToolGuiEvent("notes","notes_overlay_click_delete"),a.issueCommand(new E.T0(u.id)))}}):void 0;return(0,s.jsx)(M.E,Object.assign({outerLeft:V,outerRight:F},{children:(0,s.jsx)(D.A,{ref:n,addIcon:H,allowLayerChange:B,disabled:!y,onClick:()=>{A?h&&a.issueCommand(new E.eg):(l.trackToolGuiEvent("notes","notes_overlay_click_add"),a.issueCommand(new E.C0))},tooltip:w,nudgeDisabled:!0})}))}function B(){const{commandBinder:e}=(0,i.useContext)(o.BR),t=(0,a.t)(),n=(0,c.O)(),S=(0,x.r)(),j=(0,b.m)(),R=(0,m.f)(),N=(0,g.E)(),k=(0,f.S)(),w=(0,h.P)(),L=(0,y.O)(),P=(0,O.g)(),D=j===v.f.CLOSED,M=(0,l.f)();if(t||!w||D)return null;const U=j===v.f.OPENING,B=j===v.f.EDITING,V=w.isCommenter()&&!M&&!L,F=!!S&&(0,u.q2)(w,d.U.NOTE,S.user),G=!!S&&(0,u.db)(w,d.U.NOTE,S.user),W=n===r.L$.SIDE_PANEL,K=R===p.ce.PRESSING,Y=!!S&&!U,$=!W&&!P&&S&&F;return(0,s.jsxs)("div",Object.assign({className:"overlay grid-overlay notes-overlay"},{children:[$&&(0,s.jsx)("div",Object.assign({className:"overlay-top-right"},{children:(0,s.jsx)(C.$n,{icon:"stem-height",variant:C.Ak.FAB,theme:"overlay",disabled:!Y,active:B,onClick:t=>{t.stopPropagation(),e.issueCommand(new E.dz(!B))}})})),(0,s.jsx)(I,{}),V&&(0,s.jsx)(H,{canEdit:F,canDelete:G}),S&&W&&F&&(0,s.jsx)(A.n,{pin:S,id:S.id,pinType:p.yY.NOTE,onSave:t=>{S&&e.issueCommand(new E.Xc(S.id,t))},onClose:()=>{e.issueCommand(new E.dz(!1))},open:B,colors:T.Ay.colors,toolPanelLayout:n}),K&&(0,s.jsx)(_.z,{progress:N,screenPosition:k})]}))}},39204:(e,t,n)=>{"use strict";n.d(t,{_:()=>_t});var s=n(74848),i=n(96540),o=n(521),r=n(75414),a=n(97137),c=n(65479),l=n(83910),d=n(77704),u=n(76217);var h=n(90863),p=n(40826),m=n(76956),g=n(25615),f=n(89998),v=n(9876),E=n(21891),x=n(16457),b=n(11707),y=n(8085),O=n(57021),T=n(16616),C=n(32485),A=n.n(C),_=n(60282),S=n(4234),j=n(89552),R=n(83421),N=n(92264);function k(e){const t=[];return e&&e.comments.forEach((e=>{t.push(...e.attachments)})),t}var w=n(38216),I=n(54244);function L(){const e=(0,g.P)(),[t,n]=(0,i.useState)((null==e?void 0:e.getUsersWhoMayNeedAccess())||{});return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getUsersWhoMayNeedAccess())||{})}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}var P=n(99860),D=n(56210),M=n(42909),U=n(47952),H=n(44045);const B=(0,U.v)(H.b);function V(){const e=B(),[t,n]=(0,i.useState)((null==e?void 0:e.getHashtags())||[]);return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getHashtags())||[])}const s=e.onChanged(t);return t(),()=>{s.cancel()}}),[e]),t}var F=n(99224),G=n(52385),W=n(72909),K=n(25591),Y=n(1665),$=n(91902),z=n(5272),X=n(55649),J=n(55848),q=n(52937),Q=n(76573),Z=n(87987),ee=n(38187),te=n(25504),ne=n(18969),se=n(70767),ie=n(63769),oe=n(99366),re=n(16098),ae=n(15442);const{EMBED:ce}=oe.A.WORKSHOP;function le(e){const{parentType:t,parentId:n,onEmbed:o,onCancel:a}=e,{locale:c}=(0,i.useContext)(p.BR),d=(0,r.t)(),u=c.t(ce.MEDIA_LINK_LABEL),h=d===l.a.MEDIA_EMBED_POPUP;return(0,s.jsx)(re.Q,Object.assign({open:h,title:u,fullModal:!1,className:"media-embed-popup",onClose:a},{children:(0,s.jsx)(ae.P,{parentId:n,parentType:t,onEmbed:o})}))}n(5444);var de=n(68726),ue=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},he=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ANNOTATIONS:pe}=oe.A.SHOWCASE;let me=class extends i.Component{constructor(e){super(e),this.uploadTooltipTimeout=0,this.bindings=[],this.isUnmounting=!1,this.getAttachmentsState=()=>{if(!this.attachmentsData)return;const{active:e,parentId:t,parentType:n}=this.props;if(!e)return;return{pendingAttachments:this.attachmentsData.getPendingAttachmentsForAsset(t,n),removedAttachments:this.attachmentsData.getRemovedAttachmentsForAsset(t,n),failures:this.attachmentsData.failures.values,uploads:this.attachmentsData.uploads.values}},this.updateAttachments=()=>{const e=this.getAttachmentsState();e&&this.setState(e)},this.cancelEdits=()=>{this.props.onCancelEditing&&this.props.onCancelEditing()},this.saveEdits=()=>{this.onDoneEditing()},this.onDoneEditing=()=>{const{onDoneEditing:e}=this.props;if(e){const t=this.getMarkdown();e(t,""===t&&0===this.getAttachmentCount())}},this.onInput=e=>{this.setState({textChanged:e.trim()!==this.props.text,charCount:e.length})},this.openLinkEditor=()=>{!(this.props.openModal===l.a.LINK_EDITOR)&&this.textEditor&&(this.context.analytics.trackGuiEvent("annotation_open_link_editor",{tool:"notes"}),this.textEditor.prepareLinkForEdit())},this.onClickBlock=(e,t)=>{const{active:n,annotationType:s,annotationId:i,linkHandler:o}=this.props,r=e.blockType;if(r===K.n.LINK&&n)this.setState({selectedBlock:e}),this.context.commandBinder.issueCommand(new X.X(l.a.LINK_EDITOR,!0));else if(!n){if(r===K.n.LINK&&o&&e.value){t&&t.preventDefault();const n=(0,Y.A)(e.value),{url:r,modelId:a,pose:c}=n;a?o.handler.openLink({fullLink:r,modelId:a}):c?(o.handler.openLink({fullLink:r,pose:c}),this.context.commandBinder.issueCommand(new $.XK(i,s))):o.handler.openLink(r)}this.context.messageBus.broadcast(new z.v(s,i,e))}},this.closeLinkEditor=async()=>(this.setState({selectedBlock:null}),this.context.commandBinder.issueCommand(new X.X(l.a.LINK_EDITOR,!1))),this.onCancelLink=async()=>{await this.closeLinkEditor()},this.openEmbedEditor=()=>{this.context.analytics.trackGuiEvent("annotation_open_embed_editor",{tool:"notes"}),this.context.commandBinder.issueCommand(new X.X(l.a.MEDIA_EMBED_POPUP,!0))},this.closeEmbedEditor=()=>{this.context.commandBinder.issueCommand(new X.X(l.a.MEDIA_EMBED_POPUP,!1))},this.onRemoveLink=()=>{this.onSaveLink("","")},this.onSaveLink=(e,t)=>{this.props.openModal===l.a.LINK_EDITOR&&this.textEditor&&(this.setState({textChanged:!0}),this.textEditor.saveLink(e,t),this.closeLinkEditor())},this.onClickFileInput=()=>{const{active:e,onClickToEdit:t}=this.props;this.isAtMaxAttachments()?(window.clearTimeout(this.uploadTooltipTimeout),this.setState({showUploadTooltip:!0}),this.uploadTooltipTimeout=window.setTimeout((()=>{this.setState({showUploadTooltip:!1})}),2500)):!e&&t&&t()},this.onFileUpload=e=>{const{parentId:t,parentType:n}=this.props,s=Array.from(e),i=this.getAttachmentCount();e.length+i>q.iS&&s.splice(q.iS-i),this.context.commandBinder.issueCommand(new S.bI(t,n,s)),this.edit()},this.onDrop=e=>{this.context.analytics.trackGuiEvent("attachment_drag_and_dropped",{tool:"notes"}),this.onFileUpload(e)},this.onFilesChosen=e=>{this.context.analytics.trackGuiEvent("annotation_files_chosen",{tool:"notes"}),this.onFileUpload(e)},this.dropActivated=()=>{const{active:e,creating:t,onClickToEdit:n}=this.props;t&&!e&&n&&n()},this.setTextEditorRef=e=>this.textEditor=e,this.state={textChanged:!1,charCount:e.text.length,selectedBlock:null,showUploadTooltip:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}}componentDidMount(){this.context.market.waitForData(J.v).then((e=>{this.attachmentsData=e,this.bindings.push(this.attachmentsData.onChanged(this.updateAttachments)),this.isUnmounting||this.updateAttachments()}))}componentWillUnmount(){this.isUnmounting=!0,window.clearTimeout(this.uploadTooltipTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{active:n,parentId:s,parentType:i}=this.props;e.active&&!n?this.setState({textChanged:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}):s===e.parentId&&i===e.parentType||this.updateAttachments()}edit(){this.textEditor&&this.textEditor.toggleEditing(!0)}focus(){this.textEditor&&this.textEditor.focus()}getMarkdown(){let e;return e=this.textEditor?this.textEditor.getMarkdown():this.props.text,e.trim()}getAttachmentCount(){const{attachments:e}=this.props,{pendingAttachments:t,removedAttachments:n,uploads:s}=this.state;return e.length+t.length+s.length-n.length}isAtMaxAttachments(){return this.getAttachmentCount()>=q.iS}inEmptyState(){const{active:e,text:t}=this.props;return!e&&""===t.trim()&&0===this.getAttachmentCount()}renderButtonBar(){const{active:e,creating:t,parentId:n,maxLength:i}=this.props;if(!e)return null;const{pendingAttachments:o,removedAttachments:r,textChanged:a,charCount:c,uploads:l,showUploadTooltip:d}=this.state,u=this.isAtMaxAttachments(),h=a||r.length>0||o.length>0,p=l.length>0,m=!u&&!p,g=h&&e&&!p&&!(i&&c>i),f=u?se.Df.DIMMED:p?se.Df.DISABLED:se.Df.ENABLED,v=this.context.locale.t(u?pe.MAX_ATTACHMENTS_TOOLTIP:pe.UPLOAD_TOOLTIP,q.iS),E=this.context.locale.t(u?pe.MAX_ATTACHMENTS_TOOLTIP:pe.EMBED_TOOLTIP,q.iS),x=this.context.locale.t(t?pe.ADD_CTA:pe.SAVE_CTA),b=this.context.locale.t(pe.LINK_TOOLTIP),y=this.context.locale.t(pe.CANCEL_CTA);return(0,s.jsxs)("div",Object.assign({className:"annotation-button-bar"},{children:[(0,s.jsxs)("div",Object.assign({className:"annotation-editors"},{children:[(0,s.jsx)(te.e,Object.assign({id:`${n}-annotation`,multi:!0,enabled:m,onUpload:this.onFilesChosen},{children:(0,s.jsx)(se.K0,{iconClass:"icon-attach",buttonStyle:se.zt.PLAIN,buttonState:f,onClick:this.onClickFileInput,tooltipMsg:v,tooltipPersist:d})})),(0,s.jsx)(se.K0,{iconClass:"icon-media-mix",buttonStyle:se.zt.PLAIN,buttonState:f,tooltipMsg:E,onClick:this.openEmbedEditor}),(0,s.jsx)(se.K0,{iconClass:"icon-add-link",buttonStyle:se.zt.PLAIN,tooltipMsg:b,onClick:this.openLinkEditor})]})),(0,s.jsxs)(Z.e,Object.assign({className:"annotation-cta-buttons",spacing:"small"},{children:[(0,s.jsx)(G.$n,{variant:G.Ak.TERTIARY,size:"small",onClick:this.cancelEdits,label:y},"cancel"),(0,s.jsx)(G.$n,{variant:G.Ak.TERTIARY,size:"small",disabled:!g,onClick:this.saveEdits,label:x},"save")]}))]}))}renderAttachments(){const{attachments:e,active:t,onViewAttachment:n,annotationType:i,parentId:o}=this.props,{pendingAttachments:r}=this.state,a=this.attachmentsData?e.filter((e=>!this.attachmentsData.removals.get(e.id))):e;if(r.forEach((e=>a.push(e))),t)return(0,s.jsx)(Q.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:a,onViewAttachment:n});const c=(a||[]).reduce(((e,t)=>{const n=(0,j.rV)(t)?"viewable":"nonViewable";return e[n]=[...e[n],t],e}),{viewable:[],nonViewable:[]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Q.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.viewable,onViewAttachment:n}),(0,s.jsx)(Q.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.nonViewable,nonViewable:!0,onViewAttachment:n})]})}renderSmartEditor(){const{placeholder:e,hashtags:t,text:n,creating:i,textParser:o,active:r,maxLength:a,tabIndex:c,annotationType:l,onClickToEdit:d}=this.props,u=l===v.U.NOTE,h=this.inEmptyState()&&u&&!i?this.context.locale.t(pe.CONTENT_DELETED):e;return(0,s.jsx)(ee.u,{ref:this.setTextEditorRef,textParser:o,text:n,active:!!r,clickToEdit:!!d,placeholder:h,onClickBlock:this.onClickBlock,onStartEditing:r?void 0:d,onDoneEditing:this.onDoneEditing,onCancelEditing:this.cancelEdits,onInput:this.onInput,tabIndex:c,maxLength:a,hashtags:t||[],userMentions:u})}render(){const{className:e,creating:t,active:n,parentId:i,parentType:o,annotationType:r,onClickToEdit:a,edited:c,title:l,maxLength:d}=this.props,{uploads:u,selectedBlock:h,charCount:p}=this.state,m=this.getAttachmentCount()<q.iS,g=!(u.length>0)&&(n||t)&&m,f=r===v.U.NOTE,E=this.inEmptyState()&&!t&&f,x=!n&&c&&!E,b={annotating:n,"editor-box":n||!!a,"annotation-emptied":E,invalid:n&&!!d&&p>d};let y="",O="";return h&&h.blockType===K.n.LINK&&(y=h.text,O=h.value||""),(0,s.jsxs)(ne.y,Object.assign({className:"annotation-box",onDropped:this.onDrop,disabled:!g,onActivate:this.dropActivated},{children:[l,(0,s.jsxs)("div",Object.assign({className:A()("annotation-text-box",b,e)},{children:[this.renderSmartEditor(),n&&this.renderAttachments(),n&&this.renderButtonBar(),n&&d&&d-p<50&&(0,s.jsx)(de.w,{current:p,max:d})]})),x&&(0,s.jsx)("div",Object.assign({className:"annotation-edited"},{children:"(edited)"})),!n&&!t&&this.renderAttachments(),n&&!!i&&(0,s.jsx)(le,{parentId:i,parentType:o,onEmbed:this.closeEmbedEditor,onCancel:this.closeEmbedEditor}),n&&!!i&&(0,s.jsx)(ie.U,{linkText:y,linkUrl:O,onCancelLink:this.onCancelLink,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]}))}};me.contextType=p.BR,me=ue([W.A,he("design:paramtypes",[Object])],me);var ge=n(40194),fe=n(89339),ve=n(2040),Ee=n(7930),xe=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},be=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_USER:ye,INVITE_BUTTON:Oe,INVITE_USERS:Te,INVITE_VISIBLE_MSG:Ce}=oe.A.USERS;let Ae=class extends i.Component{constructor(e){super(e),this.onInviteUsers=()=>{this.props.onInviteUsers(this.props.invitees)}}render(){const{invitees:e}=this.props;if(0===e.length)return null;const{locale:t}=this.context;let n;const i=t.t(Oe,e.length);n=1===e.length?t.t(ye,{email:e[0]}):t.t(Te,{emails:e.join(", ")});const o=t.t(Ce);return(0,s.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,s.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",Object.assign({className:""},{children:o}))]})),(0,s.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n})),(0,s.jsx)(G.$n,{onClick:this.onInviteUsers,variant:G.Ak.TERTIARY,className:A()("button-inline","user-invite-button"),label:i})]}))}};Ae.contextType=p.BR,Ae=xe([W.A,be("design:paramtypes",[Object])],Ae);var _e=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Se=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_VISIBLE_MSG:je,INVITE_USER_FAILED:Re,INVITE_USERS_FAILED:Ne}=oe.A.USERS;let ke=class extends i.Component{constructor(e){super(e)}render(){const{failedEmails:e}=this.props,{locale:t}=this.context;if(0===e.length)return null;let n;n=1===e.length?t.t(Re,{email:e[0]}):t.t(Ne,{failedEmails:e.join(", ")});const i=t.t(je);return(0,s.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,s.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",Object.assign({className:""},{children:i}))]})),(0,s.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n}))]}))}};ke.contextType=p.BR,ke=_e([W.A,Se("design:paramtypes",[Object])],ke);var we=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r};const{UNKNOWN_USER:Ie,UNKNOWN_USERS:Le,INVITE_VISIBLE_MSG:Pe}=oe.A.USERS;let De=class extends i.Component{render(){const{locale:e}=this.context,{emails:t}=this.props;if(0===t.length)return null;let n;n=1===t.length?e.t(Ie,{email:t[0]}):e.t(Le,{emails:t.join(", ")});const i=e.t(Pe);return(0,s.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,s.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",Object.assign({className:""},{children:i}))]})),(0,s.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n}))]}))}};De.contextType=p.BR,De=we([W.A],De);var Me=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ue=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let He=class extends i.Component{constructor(e){super(e),this.inviteUsers=async e=>{if(0===e.length)return;const{noteId:t,message:n}=this.props;await this.context.commandBinder.issueCommand(new ve.jl(e,n,T.NB,t))}}getInvitees(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{(e.userStatus===Ee._.MENTIONED||e.userStatus===Ee._.KNOWN&&e.modelAccess===I.OQ.PUBLIC)&&t.push(e.email)})),t}getFailedEmails(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{e.userStatus===Ee._.FAILED&&t.push(e.email)})),t}render(){const{expires:e,noteId:t}=this.props;if((new Date).getTime()>e)return null;const{userData:n}=this.context,i=n.isInviter(),o=this.getInvitees(),r=this.getFailedEmails();return(0,s.jsxs)("div",Object.assign({className:"user-mentions-unknown"},{children:[i&&o.length>0&&(0,s.jsx)(Ae,{invitees:o,modelAccess:T.NB,noteId:t,onInviteUsers:this.inviteUsers}),!i&&o.length>0&&(0,s.jsx)(De,{emails:o}),r.length>0&&(0,s.jsx)(ke,{failedEmails:r})]}))}};He.contextType=p.BR,He=Me([W.A,Ue("design:paramtypes",[Object])],He);const{NOTES:Be}=oe.A.SHOWCASE;function Ve(e){const{comment:t,noteId:n,onCancel:o,onViewAttachment:c}=e,{user:l,created:d,edited:u,id:h,text:m}=t,{analytics:f,commandBinder:x}=(0,i.useContext)(p.BR),y=(0,g.P)(),O=(0,w.Y)(),C=(0,r.t)(),_=(0,a.O)(),S=(0,i.useRef)(null),j=(0,P.V)(),N=(0,D.b)(),k=(0,M.Y)(),U=(0,R.O)(),H=V(),B=L();if(!k||!j||!y)return null;function W(e){f.trackToolGuiEvent("notes",e)}const K=U===h,Y=t.attachments.values(),$=(0,E.q2)(y,v.U.NOTE,l),z=(0,E.db)(y,v.U.NOTE,l),X=t.modified.getTime()+60*T._d*1e3,J=y.getUserDisplay(l.email),q=J.color,Q=j.getPlainText(m),Z=k.getCommentUserMentions(m,B),ee=!K&&($||z)?(0,s.jsxs)(F.y,Object.assign({icon:"more-vert",variant:G.Ak.TERTIARY,ariaLabel:O.t(oe.A.MORE_OPTIONS),menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end"},{children:[$&&(0,s.jsx)(G.$n,{label:O.t(Be.EDIT),size:G.Mp.SMALL,variant:G.Ak.TERTIARY,onClick:()=>{S.current&&(W("notes_click_edit_comment"),x.issueCommand(new b.lf(t.id)),S.current.edit())}}),z&&(0,s.jsx)(G.$n,{className:"menu-delete-btn",label:O.t(Be.DELETE),size:G.Mp.SMALL,variant:G.Ak.TERTIARY,onClick:()=>{W("notes_click_delete_comment"),x.issueCommand(new b.IN(n,t.id))}})]})):null;return(0,s.jsxs)("div",Object.assign({className:A()("comment",{active:K}),"data-id":h},{children:[(0,s.jsxs)("div",Object.assign({className:"note-header comment-header"},{children:[(0,s.jsx)(fe.E,{badgeStyle:{color:q,borderColor:q},label:J.initials}),(0,s.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,s.jsx)("span",Object.assign({className:"note-user"},{children:J.name})),(0,s.jsx)("div",Object.assign({className:"note-subheader"},{children:d.toLocaleString()}))]})),ee]})),$?(0,s.jsx)(me,{ref:S,textParser:j,linkHandler:N,annotationId:n,annotationType:v.U.NOTE,parentId:h,parentType:I.pi.COMMENT,attachments:Y,active:K,edited:u,creating:!1,text:m,hashtags:H,toolPanelLayout:_,openModal:C,onViewAttachment:c,onDoneEditing:(e,s)=>{s?(W("notes_delete_empty_comment"),x.issueCommand(new b.IN(n,t.id)),o()):x.issueCommand(new b.er(n,t.id,e))},onCancelEditing:o,maxLength:T.u4}):(0,s.jsx)(ge.$,{text:m,textParser:j,linkHandler:N,annotationType:v.U.NOTE,annotationId:n,attachments:Y,edited:u,onViewAttachment:c}),$&&Z.length>0&&(0,s.jsx)(He,{noteId:n,message:Q,userMentions:Z,expires:X})]}))}const{NOTES:Fe}=oe.A.SHOWCASE;function Ge({noteId:e,replyId:t,active:n,onCancel:o,onReply:c}){const l=(0,w.Y)(),{commandBinder:d,analytics:u}=(0,i.useContext)(p.BR),h=(0,r.t)(),m=(0,a.O)(),g=(0,P.V)(),f=(0,D.b)(),E=V();if(!g)return null;return(0,s.jsx)(me,{className:"reply-box",textParser:g,linkHandler:f,annotationType:v.U.NOTE,annotationId:e,parentType:I.pi.COMMENT,parentId:t,attachments:[],active:n,edited:!1,creating:!0,text:"",hashtags:E,toolPanelLayout:m,openModal:h,placeholder:l.t(Fe.REPLY_PLACEHOLDER),onClickToEdit:()=>{u.trackToolGuiEvent("notes","notes_click_new_comment"),d.issueCommand(new b.lf(t))},onDoneEditing:(e,n)=>{n?o():c(t,e)},onCancelEditing:o,maxLength:T.u4})}var We=n(19974),Ke=n(61643);const{NOTES:Ye}=oe.A.SHOWCASE;function $e({note:e,active:t,onCancelNote:n}){const{analytics:o,commandBinder:r}=(0,i.useContext)(p.BR),a=(0,g.P)(),c=(0,h.g)(),l=(0,w.Y)();if(!a)return null;const d=e.comments.get(0);function u(e){o.trackToolGuiEvent("notes",e)}const m=(0,E.q2)(a,v.U.NOTE,e.user),f=a.getUserDisplay(e.user.email),x=f.color,y=!c&&!t,O=y&&(0,E.db)(a,v.U.NOTE,e.user),T=y&&!e.resolved,C=y&&e.resolved,A=!c&&(m||C||O)?(0,s.jsxs)(F.y,Object.assign({icon:"more-vert",ariaLabel:l.t(oe.A.MORE_OPTIONS),variant:G.Ak.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end"},{children:[m&&(0,s.jsx)(G.$n,{label:l.t(Ye.EDIT),size:G.Mp.SMALL,variant:G.Ak.TERTIARY,onClick:()=>{u("notes_click_edit_note"),d&&r.issueCommand(new b.lf(d.id))}}),C&&(0,s.jsx)(G.$n,{label:l.t(Ye.UNRESOLVE),size:G.Mp.SMALL,variant:G.Ak.TERTIARY,onClick:()=>{u("notes_click_unresolve_note"),r.issueCommand(new b.kr(e.id,!1))}}),O&&(0,s.jsx)(G.$n,{className:"menu-delete-btn",label:l.t(Ye.DELETE),size:G.Mp.SMALL,variant:G.Ak.TERTIARY,onClick:()=>{u("notes_click_delete_note"),r.issueCommand(new b.T0(e.id))}})]})):null,_=l.t(Ye.MARK_AS_RESOLVED);return(0,s.jsxs)("header",Object.assign({className:"note-header"},{children:[(0,s.jsx)(fe.E,{badgeStyle:{color:x,borderColor:x},label:f.initials}),(0,s.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,s.jsx)("span",Object.assign({className:"note-user"},{children:f.name})),(0,s.jsx)("div",Object.assign({className:"note-subheader"},{children:e.created.toLocaleString()}))]})),(0,s.jsxs)(Z.e,Object.assign({spacing:"small"},{children:[c&&(0,s.jsx)(G.$n,{icon:"close",tooltip:l.t(Ye.CANCEL),onClick:n,tooltipOptions:{placement:"bottom-end"}}),T&&(0,s.jsx)(G.$n,{icon:"checkmark",size:G.Mp.SMALL,variant:G.Ak.FAB,theme:"dark",tooltip:_,onClick:()=>{u("notes_click_resolve_note"),r.issueCommand(new b.kr(e.id,!0))}}),y&&(0,s.jsx)(Ke.k,{prefix:"note",pin:e,id:e.id,darkTheme:!0,analyticAction:"copy_note_share_link",includeCameraView:!0}),A]}))]}))}const{NOTES:ze}=oe.A.SHOWCASE;function Xe({note:e,onViewAttachment:t,onCancel:n}){var o;const{commandBinder:c}=(0,i.useContext)(p.BR),l=(0,w.Y)(),d=(0,r.t)(),u=(0,a.O)(),f=(0,g.P)(),E=L(),x=(0,i.useRef)(null),y=(0,M.Y)(),O=(0,R.O)(),C=(0,h.g)(),A=V(),_=(0,P.V)(),S=(0,D.b)(),j=e.comments.get(0),N=null==j?void 0:j.id,k=!!O&&(O===N||C),U=e.id,H=(0,i.useCallback)((()=>{x.current&&O===U&&x.current.edit()}),[O,U]);if((0,m.J)(We.wk,(()=>{C&&H()})),(0,i.useEffect)((()=>{k&&H()}),[k,H]),!y||!_||!f)return null;const B=(null===(o=null==j?void 0:j.attachments)||void 0===o?void 0:o.values())||[],F=(null==j?void 0:j.text)||"",G=(null==j?void 0:j.edited)||!1,W=(null==j?void 0:j.modified.getTime())+60*T._d*1e3,K=e.user.id===f.getCurrentUserId(),Y=!!K&&f.isCommenter(),$=_.getPlainText(F),z=y.getCommentUserMentions(F,E),X=k?l.t(ze.ADD_NOTE_MESSAGE):void 0;return(0,s.jsxs)("div",Object.assign({className:"note-post"},{children:[(0,s.jsx)($e,{note:e,active:k,onCancelNote:n}),Y?(0,s.jsx)(me,{ref:x,textParser:_,linkHandler:S,annotationId:U,annotationType:v.U.NOTE,parentId:N||U,parentType:I.pi.COMMENT,attachments:B,active:k,edited:G,creating:C,text:F,hashtags:A,placeholder:X,toolPanelLayout:u,openModal:d,onViewAttachment:t,onDoneEditing:async(e,t)=>{t?n():C?await c.issueCommand(new b.x7(e)):await c.issueCommand(new b.iT(U,e))},onCancelEditing:n,maxLength:T.KZ}):(0,s.jsx)(ge.$,{text:F,textParser:_,linkHandler:S,annotationType:v.U.NOTE,annotationId:U,attachments:B,edited:G,onViewAttachment:t}),!C&&j&&K&&z.length>0&&(0,s.jsx)(He,{message:$,noteId:U,expires:W,userMentions:z})]}))}function Je({note:e}){const{commandBinder:t,analytics:n}=(0,i.useContext)(p.BR),o=(0,g.P)(),r=(0,R.O)(),a=(0,h.g)(),c=function(e){const t=(0,N.Z)(e),[n,s]=(0,i.useState)(k(t));return(0,i.useEffect)((()=>{if(!t)return()=>{};function e(){s(k(t))}const n=t.comments.onChanged(e);return e(),()=>{n.cancel()}}),[t]),n}(e.id),[l,d]=(0,i.useState)((0,_.D)(11)),u=()=>{t.issueCommand(new b.up)},m=e=>{if(c.length){n.trackToolGuiEvent("notes","notes_click_view_attachment");const s=c.filter((e=>(0,j.rV)(e)));s.length>0&&t.issueCommand(new S.ht(!0,s,e))}},f={annotating:!!r,creating:a},v=r===l,E=!a&&(null==o?void 0:o.isCommenter())&&(v||!r);return(0,s.jsxs)("div",Object.assign({className:A()("note-widget",f)},{children:[e&&(0,s.jsx)(Xe,{note:e,onViewAttachment:m,onCancel:()=>{a?t.issueCommand(new b.eg):r&&u()}}),!a&&(0,s.jsx)("div",Object.assign({className:"note-comments"},{children:e.comments.map(((t,n)=>0===n?null:(0,s.jsx)(Ve,{noteId:e.id,comment:t,onCancel:u,onViewAttachment:m},t.id)))})),E&&(0,s.jsx)(Ge,{replyId:l,noteId:e.id,active:v,onCancel:()=>{u(),d((0,_.D)(11))},onReply:(n,s)=>{t.issueCommand(new b.YC(e.id,s,n)),d((0,_.D)(11))}})]}))}var qe=n(54550),Qe=n(36354),Ze=n(9321),et=n(19591),tt=n(41733),nt=n(66077);const st=(0,tt.p)(!1);function it(e){st.value=e}function ot(){return[(0,nt.A)(st),it]}var rt=n(71136),at=n(75716),ct=n(8639),lt=n(86978);function dt(e){const{analyticAction:t}=e,{analytics:n,commandBinder:o}=(0,i.useContext)(p.BR),r=(0,at.W)(),a=(0,d.r)(),c=(0,ct.e)(null==a?void 0:a.id),[l,u]=ot();if(!(a&&r.length>1))return null;const h=r.findIndex((e=>{const t=e.id,n=e.parentId;return n&&n===(null==a?void 0:a.id)&&(!c||t===(null==c?void 0:c.id))}));return(0,s.jsx)(lt.r,{index:h,total:r.length,disabled:l,wrapAround:!0,onNavigate:e=>{const s=r[e];if(!s)return;const i=s.id,c=s.parentId;if(!i||!c)return;u(!0);const l=a?null:rt.fl.Interpolate;n.trackToolGuiEvent("notes",t),o.issueCommand(new b.FV(c,!0,!1,i,l)).then((()=>{u(!1)}))}})}var ut=n(99167);const{NOTES:ht}=oe.A.SHOWCASE;function pt(){const e=(0,R.O)(),{commandBinder:t}=(0,i.useContext)(p.BR),n=(0,w.Y)(),r=(0,c.k)(),a=(0,et.c)(),[l]=ot(),d=r&&a&&(a===o.S0.SEARCH||a===o.S0.LAYERS),u=d||!r,h=!e&&!d,m=u?n.t(ht.NAV_BACK):n.t(ht.NAV_CLOSE),g=u?"back":"close";return(0,s.jsxs)("div",Object.assign({className:"detail-panel-header"},{children:[(0,s.jsx)(ut.J,{icon:g,label:m,onClose:()=>{l||(d?t.issueCommand(new Ze.kC).then((()=>{t.issueCommand(new Ze.oe(!1))})):r?t.issueCommand(new Ze.u3(o.S0.NOTES)):t.issueCommand(new b.sL))}}),h&&(0,s.jsx)(dt,{analyticAction:"notes_navigate_in_panel"})]}))}function mt({panelOpen:e,note:t}){const{commandBinder:n}=(0,i.useContext)(p.BR),r=(0,g.P)(),c=(0,a.O)(),l=(0,i.useRef)(null),d=(0,O.m)(),u=(0,h.g)(),C=null==t?void 0:t.id;(0,m.J)(x.F,(e=>{l.current&&l.current.scrollToSelector(`[data-id='${e.commentId}']`)})),(0,i.useEffect)((()=>{l.current&&C&&l.current.resetScrollTop()}),[C]);const A=!(!t||!r)&&(0,E.q2)(r,v.U.NOTE,t.user),_=d===y.f.EDITING,S=c===o.L$.BOTTOM_PANEL,j=_&&S;return(0,s.jsxs)(qe.q,Object.assign({ref:l,open:e,className:"note-panel",scrollingDisabled:j,onClose:()=>{n.issueCommand(new b.sL)}},{children:[t&&!u&&(0,s.jsx)(pt,{}),t&&(0,s.jsx)(Je,{note:t}),t&&C&&S&&A&&(0,s.jsx)(Qe.n,{id:C,pin:t,pinType:f.yY.NOTE,onSave:e=>{C&&n.issueCommand(new b.Xc(C,e))},onClose:()=>{n.issueCommand(new b.dz(!1))},colors:T.Ay.colors,open:_,toolPanelLayout:c},C)]}))}var gt=n(34466),ft=n(20255),vt=n(72322),Et=n(57863),xt=n(84573);n(30562);const{NOTES:bt}=oe.A.SHOWCASE;function yt(){const e=(0,w.Y)(),t=(0,vt.X)(),n=(0,i.useRef)(null);return(0,s.jsx)("div",Object.assign({className:"search-filter"},{children:(0,s.jsxs)(F.y,Object.assign({ref:n,icon:"filter",ariaLabel:e.t(bt.FILTER),variant:G.Ak.TERTIARY,size:G.Mp.SMALL,menuClassName:"search-filter-menu"},{children:[(0,s.jsxs)("div",Object.assign({className:"search-filter-menu-header"},{children:[(0,s.jsx)("div",{children:e.t(bt.FILTER_BY)}),(0,s.jsx)(ut.J,{onClose:()=>{n.current&&n.current.closeMenu()}})]})),(0,s.jsx)(Ot,{id:Et.S.ALL,label:e.t(bt.FILTER_ALL),selected:t===Et.S.ALL},Et.S.ALL),(0,s.jsx)(Ot,{id:Et.S.OPEN,label:e.t(bt.FILTER_UNRESOLVED),selected:t===Et.S.OPEN},Et.S.OPEN),(0,s.jsx)(Ot,{id:Et.S.RESOLVED,label:e.t(bt.FILTER_RESOLVED),selected:t===Et.S.RESOLVED},Et.S.RESOLVED)]}))}))}function Ot({id:e,label:t,selected:n}){const{commandBinder:o,analytics:r}=(0,i.useContext)(p.BR);return(0,s.jsx)(xt.M,{id:e,label:t,selected:n,onToggled:()=>{n||(r.trackToolGuiEvent("notes","notes_list_change_filter"),o.issueCommand(new b.$l(e,!0)))}})}var Tt=n(32381);const{NOTES:Ct}=oe.A.SHOWCASE;function At({children:e,title:t,hideBadge:n}){const i=(0,w.Y)(),r=(0,gt.e)(),a=(0,at.W)().length,c=(0,s.jsx)(Tt.M,{filter:(0,s.jsx)(yt,{})}),l=t||i.t(r?Ct.COMMENTS:Ct.NOTES,a);return(0,s.jsx)(ft.h,Object.assign({toolId:o.S0.NOTES,className:"notes-list-panel",title:l,subheader:c,hideBadge:n},{children:e}))}function _t({children:e,title:t,hideBadge:n}){const p=(0,r.t)(),m=(0,a.O)(),g=(0,c.k)(),f=(0,d.r)(),v=function(){const e=(0,d.r)(),t=(0,u.X)();return(null==e?void 0:e.id)===(null==t?void 0:t.id)?e:null}(),E=(0,h.g)(),[x,b]=(0,i.useState)(v),y=g;(0,i.useEffect)((()=>{f&&(null==f?void 0:f.id)!==(null==x?void 0:x.id)&&b(f)}),[null==x?void 0:x.id,f,null==f?void 0:f.id]);const O=E?v:f,T=m===o.L$.BOTTOM_PANEL,C=p&&p!==l.a.CONFIRM,A=!(!O||T&&C);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(mt,{panelOpen:A,note:O||x}),!y&&(0,s.jsx)(At,Object.assign({title:t,hideBadge:n},{children:e}))]})}},8639:(e,t,n)=>{"use strict";n.d(t,{e:()=>r});var s=n(96540),i=n(42909);function o(e,t){return t&&e&&e.focusedComment?e.getReply(t,e.focusedComment.id):null}function r(e){const t=(0,i.Y)(),[n,r]=(0,s.useState)(o(t,e));return(0,s.useEffect)((()=>{if(!t)return()=>{};const n=t.onFocusedCommentChanged((function(){r(o(t,e))}));return()=>n.cancel()}),[t,e]),n}},90863:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var s=n(43802),i=n(31717);const o=(0,s.r)(i.b,"isNewNote",!1)},83421:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var s=n(96540),i=n(42909);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.activeNotation)||null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onActiveNotationChanged(n);return()=>t.cancel()}),[e]),t}},92264:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(96540),i=n(42909);function o(e){const t=(0,i.Y)(),[n,o]=(0,s.useState)((null==t?void 0:t.getNoteView(e))||null);return(0,s.useEffect)((()=>{if(!t)return()=>{};const n=t.getNoteViewsMap().onChanged((function(){t&&o(t.getNoteView(e))}));return()=>n.cancel()}),[t,e]),n}},72322:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});var s=n(96540),i=n(42909),o=n(57863);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesFilter)||o.S.OPEN);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesFilterChanged(n);return()=>t.cancel()}),[e]),t}},56210:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var s=n(96540),i=n(42909);function o(){const e=(0,i.Y)();return(0,s.useMemo)((()=>function(e){return e?e.getLinkHandler():null}(e)),[e])}},57021:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var s=n(96540),i=n(42909),o=n(8085);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesPhase)||o.f.CLOSED);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesPhaseChanged(n);return n(e.notesPhase),()=>t.cancel()}),[e]),t}},99860:(e,t,n)=>{"use strict";n.d(t,{V:()=>o});var s=n(96540),i=n(42909);function o(){const e=(0,i.Y)();return(0,s.useMemo)((()=>function(e){return e?e.getTextParser():null}(e)),[e])}},42909:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var s=n(47952),i=n(31717);const o=(0,s.v)(i.b)},77704:(e,t,n)=>{"use strict";n.d(t,{r:()=>o});var s=n(96540),i=n(42909);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)(e?e.openNoteView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenNoteViewChanged(n);return n(e.openNoteView),()=>t.cancel()}),[e]),t}(0,n(29633).c)("openNoteView",o)},16457:(e,t,n)=>{"use strict";n.d(t,{F:()=>o,a:()=>i});var s=n(14754);class i extends s.QB{constructor(e,t){super(),this.id=e,this.resolved=t}}class o extends s.QB{constructor(e){super(),this.commentId=e}}},69831:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var s=n(61589),i=n(54998);class o extends s.B{constructor(){super(),this.name="object-tags",this.suggestions=(0,i.y)()}get collection(){return this.suggestions}iterate(e){for(const t of this.suggestions)e(t)}getObjectTag(e){return this.suggestions.get(e)}getObjectTagIds(){return this.suggestions.keys}updateObjectTag(e){this.suggestions.set(e.id,e)}removeObjectTag(e){return this.suggestions.delete(e)}}},87243:(e,t,n)=>{"use strict";n.d(t,{HZ:()=>o,R5:()=>d,_8:()=>a,lA:()=>r,lg:()=>l,vX:()=>i,y_:()=>u,ye:()=>c});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={enabled:e}}}i.id="OBJECTS_ANNOTATIONS_ENABLED";class o extends s.u{constructor(e){super(),this.payload={ids:e}}}o.id="FILTER_TAG_SUGGESTION";class r extends s.u{constructor(e){super(),this.payload={id:e}}}r.id="NAVIGATE_TO_TAG_SUGGESTION";class a extends s.u{constructor(e,t){super(),this.payload={id:e,enabled:t}}}a.id="TOGGLE_OBJECT_ENABLED";class c extends s.u{constructor(e,...t){super(),this.payload={ids:t,enabled:e}}}c.id="TOGGLE_OBJECT_TAG_ENABLED";class l extends s.u{constructor(...e){super(),this.payload={ids:e}}}l.id="DISMISS_OBJECT_TAG";class d extends s.u{constructor(e,t,n,s){super(),this.payload={id:e,options:t,pendingAttachments:n,embed:s}}}d.id="CREATE_OBJECT_TAG";class u extends s.u{constructor(e){super(),this.payload={id:e}}}u.id="DOCK_OBJECT_TAG"},59421:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});const s=Object.freeze({pink:"#f78da7",plum:"#9c4b92",purple:"#673ab7",teal:"#03687d",cerulean:"#03a9f4",ocean:"#00bcd4",fog:"#abb8c3",iron:"#607d8b",forest:"#417505",emerald:"#51a868",mint:"#37d67a",lime:"#cddc39",canary:"#fbcd00",sunflower:"#ffac17",tangerine:"#ff6900",sunset:"#f44336",sierra:"#d44441",magenta:"#e91e63"})},36354:(e,t,n)=>{"use strict";n.d(t,{n:()=>b});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=n(40826),l=n(7628),d=n(521),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.clickColor=e=>{const t=e.currentTarget;if(t&&t.dataset){const n=t.dataset.value;n&&(e.stopPropagation(),this.props.onColorPicked(n),this.setState({activeColor:n}))}},this.renderColorSwatch=e=>{const{activeColor:t}=this.state,n={backgroundColor:e},i=a()({"color-swatch":!0,"icon-checkmark":!0,active:e===t});return(0,s.jsx)("div",{className:i,style:n,"data-value":e,onClick:this.clickColor},e)},this.state={activeColor:e.defaultColor||""}}UNSAFE_componentWillReceiveProps(e){e.defaultColor&&!this.state.activeColor&&this.setState({activeColor:e.defaultColor})}render(){const{colors:e}=this.props;return(0,s.jsx)("div",Object.assign({className:"color-picker"},{children:e.map((e=>this.renderColorSwatch(e)))}))}};p=u([o.A,h("design:paramtypes",[Object])],p);var m=n(23101),g=n(99167),f=n(99366),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{PINS:x}=f.A.WORKSHOP;let b=class extends i.Component{constructor(e){super(e),this.closePinAssetEditor=()=>{this.props.onClose()},this.handleColorPicked=e=>{this.context.analytics.trackGuiEvent("pin_change_color"),this.props.onSave({color:e})},this.saveStemEnabled=e=>{this.context.analytics.trackGuiEvent(e?"pin_show_stem":"pin_hide_stem"),this.props.onSave({stemEnabled:e})},this.saveStemLength=e=>{this.context.analytics.trackGuiEvent("pin_change_stem_height"),this.props.onSave({stemLength:e})},this.previewStemLength=e=>{const{id:t,pinType:n}=this.props;this.context.commandBinder.issueCommand(new l.gx(t,n,{stemLength:e}))},this.stopPropagation=e=>{e.stopPropagation()}}renderStemEditor(){const{pin:e}=this.props;return(0,s.jsx)(m.n,{stemLength:e.stemLength,stemEnabled:e.stemEnabled,onLengthUpdate:this.previewStemLength,onLengthChanged:this.saveStemLength,onStemEnabledChanged:this.saveStemEnabled})}render(){const{toolPanelLayout:e,open:t,pin:n,colors:i}=this.props,o=e===d.L$.BOTTOM_PANEL;if(!t&&!o)return null;const r=this.context.locale.t(x.COLOR_STEM_EDITOR_TITLE);return(0,s.jsxs)("div",Object.assign({className:a()("pin-tool-editor",{"tool-popup":!o,open:o&&t}),onClick:this.stopPropagation},{children:[(0,s.jsxs)("div",Object.assign({className:"tool-editor-title"},{children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)(g.J,{theme:"dark",tooltip:"",onClose:this.closePinAssetEditor})]})),(0,s.jsx)(p,{colors:i,defaultColor:n.color,onColorPicked:this.handleColorPicked}),this.renderStemEditor()]}))}};b.contextType=c.BR,b=v([o.A,E("design:paramtypes",[Object])],b)},61643:(e,t,n)=>{"use strict";n.d(t,{k:()=>E});var s=n(74848),i=n(69505),o=n(68909),r=n(96540),a=n(32485),c=n.n(a),l=n(40826),d=n(34904),u=n(99366),h=n(52147),p=n(61412),m=n(52385),g=n(9389);function f(e){const{label:t,className:n,darkTheme:i,analyticAction:o,urlParams:a,buttonVariant:f}=e,{analytics:v,engine:E,editMode:x,locale:b,settings:y}=(0,r.useContext)(l.BR),[O,T]=(0,r.useState)(!1),C=x||y.tryGetProperty(h.wD,!1),A=(0,p.L)(),_=(0,r.useCallback)((e=>{e.stopPropagation()}),[]),S=(0,r.useCallback)((e=>{e.stopPropagation(),O||(!async function(e,t){const n=(await t.getModuleBySymbol(g.r)).creator.createDeepLink({additionalParams:e,paramFilter:e=>!["q","qK","qF","tag","note","comment","pin-pos","cloudEdit"].includes(e)});n.hash="",(0,d.l)(n.href)}(a,E),T(!0),v.trackGuiEvent(o,{tool:A}))}),[O,a,E,v,o,A]);(0,r.useEffect)((()=>{if(!O)return()=>{};const e=window.setTimeout((()=>T(!1)),2500);return()=>window.clearTimeout(e)}),[O]);let j=f||(!t?m.Ak.FAB:m.Ak.TERTIARY),R="share",N=t,k=t?void 0:b.t(u.A.COPY_LINK),w=!1;return O&&(j=m.Ak.TERTIARY,R=void 0,N=b.t(u.A.SHARE_COPIED),k=void 0,w=!0),C?(0,s.jsx)("div",Object.assign({className:c()("url-link-copy",n,{"link-copied":O}),onClick:_},{children:(0,s.jsx)(m.$n,{icon:R,label:N,size:m.Mp.SMALL,variant:j,theme:i?"dark":"light",disabled:w,tooltip:k,tooltipOptions:{placement:"bottom"},onClick:S})})):null}var v=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};function E(e){const{prefix:t,pin:n,id:r}=e,a=v(e,["prefix","pin","id"]),{stemNormal:c,stemLength:l,anchorPosition:d}=n,u=i.s.encodeVector3((new o.Vector3).copy(c).setLength(l).add(d)),h={[`${t}`]:r,"pin-pos":u};return(0,s.jsx)(f,Object.assign({urlParams:h},a))}},63690:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var s=n(96540),i=n(50465);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canAdd);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanAddChanged(n);return n(e.canAdd),()=>t.cancel()}),[e]),t}},68850:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(96540),i=n(50465);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canPlace);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanPlaceChanged(n);return n(e.canPlace),()=>t.cancel()}),[e]),t}},47223:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(96540),i=n(50465),o=n(89998);function r(){const e=(0,i.d)(),[t,n]=(0,s.useState)(e?e.pinEditorState:o.ce.IDLE);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onPinEditorStateChanged(n);return()=>t.cancel()}),[e]),t}},3302:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var s=n(96540),i=n(50465);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)((null==e?void 0:e.progress)||0);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onProgressChanged(n);return n(e.progress),()=>t.cancel()}),[e]),t}},36042:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var s=n(96540),i=n(50465);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)((null==e?void 0:e.screenPosition)||null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onScreenPositionChanged(n);return n(e.screenPosition),()=>t.cancel()}),[e]),t}},50465:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var s=n(47952),i=n(30411);const o=(0,s.v)(i.U)},59105:(e,t,n)=>{"use strict";n.d(t,{RN:()=>l,hs:()=>d,nK:()=>c,zX:()=>u});var s=n(68909),i=n(39404),o=n(89998),r=n(71136),a=n(69505);function c(e,t){switch(t){case o.ob.DEFAULT:return e.baseColor;case o.ob.DIMMED:return e.dimmedColor;case o.ob.HIGHLIGHTED:return e.hoverColor}}function l(e,t,n){const s=n?t:void 0;return s&&i.J[s]?s:o.tf[e]}function d(e){if("comment-large"===e)return{x:0,y:5}}const u=async(e,t,n)=>{const i=(new s.Vector3).copy(t.stemNormal).setLength(t.stemLength).add(t.anchorPosition),o=a.s.decodeVector3(e.getOverrideParam("pin-pos",a.s.encodeVector3(i)));n(o&&o.distanceTo(i)>.1||null===a.s.deserialize()?r.fl.FadeToBlack:null)}},21994:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var s=n(96540),i=n(38216),o=n(74504),r=n(52982);function a(e){const t=(0,o.N)(),n=(0,i.Y)(),[a,c]=(0,s.useState)((0,r.Ay)(e,n,t));return(0,s.useEffect)((()=>{if(!t)return()=>{};function s(){c((0,r.Ay)(e,n,t))}const i=t.onRoomsChanged({onUpdated:s});return s(),()=>i.cancel()}),[n,t,e]),a}},87312:(e,t,n)=>{"use strict";n.d(t,{$M:()=>r,Oc:()=>u,Pb:()=>o,Xx:()=>d,_d:()=>c,_w:()=>l,tA:()=>i,tf:()=>h,xg:()=>a});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={query:e}}}i.id="UPDATE_SEARCH_QUERY";class o extends s.u{constructor(e){super(),this.payload={keywords:e}}}o.id="UPDATE_SEARCH_QUERY_KEYWORDS";class r extends s.u{constructor(e){super(),this.payload={keywordId:e}}}r.id="TOGGLE_SEARCH_QUERY_KEYWORD";class a extends s.u{constructor(e){super(),this.payload={grouping:e}}}a.id="CHANGE_SEARCH_GROUPING";class c extends s.u{constructor(){super()}}c.id="SEARCH_FILTER_CLEAR";class l extends s.u{constructor(e,t){super(),this.payload={groupId:e,enabled:t}}}l.id="SEARCH_FILTER_TOGGLE";class d extends s.u{constructor(e,t){super(),this.payload={id:e,typeId:t}}}d.id="SELECT_SEARCH_RESULT";class u extends s.u{constructor(e){super(),this.payload=e}}u.id="SEARCH_GROUP_REGISTER";class h extends s.u{constructor(e){super(),this.payload={id:e}}}h.id="SEARCH_GROUP_DEREGISTER"},38093:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var s=n(74848),i=n(91659),o=n(34466),r=n(38216);function a({dataTypeGroup:e}){return e.groupActionsFC?(0,s.jsx)(e.groupActionsFC,{group:e}):null}var c=n(26775);function l(e){const{id:t,numItems:n,numSelected:l,selected:d,selectDisabled:u,selectMode:h,onSelect:p}=e,m=(0,i.f)(),g=(0,o.e)(),f=(0,r.Y)(),v=m[t];if(!v)return null;const E=g&&v.groupMatchingPhraseKey||v.groupPhraseKey,x=E?f.t(E):t,b=h?`(${l}/${n})`:`(${n})`;return(0,s.jsx)(c.u,{id:t,title:x,decals:(0,s.jsx)("span",Object.assign({className:"mp-list-item-text"},{children:b})),actions:(0,s.jsx)(a,{dataTypeGroup:v}),selectMode:h,selectDisabled:u,selected:d,onSelect:p})}},86880:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var s=n(74848),i=n(38216),o=n(26775);function r(e){const{id:t,numItems:n,numSelected:r,selected:a,selectMode:c,onSelect:l}=e,d=(0,i.Y)().t(`SHOWCASE.NOTES.${t}`),u=c?`(${r}/${n})`:`(${n})`;return(0,s.jsx)(o.u,{id:t,title:d,decals:(0,s.jsx)("span",Object.assign({className:"mp-list-item-text"},{children:u})),selectMode:c,selected:a,onSelect:l})}},33947:(e,t,n)=>{"use strict";n.d(t,{og:()=>R,ic:()=>w,r2:()=>N,ex:()=>L,mk:()=>k,dS:()=>I});var s=n(74848),i=n(96540),o=n(40826),r=n(99366),a=n(38216),c=n(76956),l=n(18435),d=n(75716),u=n(93424);var h=n(84020),p=n(82856),m=n(7895),g=n(28452),f=n(52973),v=n(67742);function E(e=!0){return x((0,d.W)(),function(){const e=[];for(const t in u.T)e.push({id:t});const[t]=(0,i.useState)(e);return t}(),p.Hj.DATE,e)}function x(e,t,n,s){const o=(0,h.w)(),[r,a]=(0,i.useState)([]);return(0,i.useEffect)((()=>{if(!o)return()=>{};const i=t.reduce(((e,t,s)=>Object.assign(Object.assign({},e),{[t.id]:{id:t.id,grouping:n,groupOrder:s,items:[],batchSupported:!0}})),{}),r={};e.forEach((e=>{const t=e.getGroupingId(n);if(t&&i[t])t&&i[t].items.push(e);else{const t=e.getGroupingId(p.Hj.TYPE);if(t){const n=o.getSearchDataTypeGroup(t);r[t]||(r[t]={id:t,grouping:p.Hj.TYPE,groupOrder:(0,v.E)(o,t,p.Hj.TYPE),items:[],batchSupported:n.batchSupported}),r[t].items.push(e)}}}));let c=Object.values(i);return s&&(c=c.filter((e=>e.items.length>0))),a(c.concat(Object.values(r))),()=>{}}),[o,e,t,n,s]),r}var b=n(91659),y=n(81047);var O=n(95178),T=n(68340),C=n(73715),A=n(82880),_=n(66368);const{SEARCH:S}=r.A.SHOWCASE,j=({group:e})=>{const t=(0,a.Y)().t(S.EMPTY_LIST_MESSAGE);return(0,s.jsx)(_.t,{message:t})},R=60;function N(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,m.y)();return x((0,d.W)(),t,p.Hj.FLOOR,e)}(t);return(0,s.jsx)(P,Object.assign({},e,{dataGroups:n}))}function k(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,g.N)();return x((0,d.W)(),t,p.Hj.ROOM,e)}(t);return(0,s.jsx)(P,Object.assign({},e,{dataGroups:n}))}function w(e){const{excludeEmptyGroups:t}=e,n=E(t);return(0,s.jsx)(P,Object.assign({},e,{dataGroups:n}))}function I(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,b.f)(),n=Object.values(t).sort(((e,t)=>(e.groupOrder||y.X$)-(t.groupOrder||y.X$))).map((e=>({id:e.id,grouping:p.Hj.TYPE,groupOrder:e.groupOrder||y.X$,items:e.matches,batchSupported:e.batchSupported})));return e?n.filter((e=>e.items.length>0)):n}(t);return(0,s.jsx)(P,Object.assign({},e,{dataGroups:n}))}function L(e){const{excludeEmptyGroups:t}=e,{editMode:n}=(0,i.useContext)(o.BR),{includeInMemory:r}=(0,i.useContext)(o.bf),a=function(e=!0,t=!1){const n=(0,f.z)(t);return x((0,d.W)(),n,p.Hj.LAYER,e)}(t,!r),l=(0,C.z0)(),u=n&&(null==l?void 0:l.id)||void 0,[h,m]=(0,i.useState)(void 0),g=(0,i.useCallback)((()=>{m(void 0)}),[]);return(0,c.J)(T.V7,(({layerId:e})=>{m(e)})),(0,s.jsx)(P,Object.assign({},e,{dataGroups:a,activeGroupId:u,scrollToGroupId:h,onScrolled:g}))}function P(e){const{renderGroup:t,renderItem:n,dataGroups:o,activeItemId:c,activeGroupId:d,scrollToGroupId:u,onScrolled:h}=e,[p,m]=(0,l.N)(),g=(0,i.useRef)(null),f=(0,O.M)(),v=(0,i.useRef)(),E=(0,a.Y)();return(0,i.useEffect)((()=>(window.clearTimeout(v.current),f&&(v.current=window.setTimeout((()=>{o.forEach((e=>{e.items.length>0&&m(e.id,!1)}))}),500)),()=>{window.clearTimeout(v.current)})),[f,o,m]),(0,i.useEffect)((()=>{var e;if(!u)return;(null===(e=g.current)||void 0===e?void 0:e.scrollIntoView(`[data-id='${u}']`))&&(null==h||h())}),[u,h]),(0,i.useEffect)((()=>{var e;if(c){let t=-1;const n=null===(e=o.find((e=>{const n=e.items.findIndex((e=>e.id===c));return-1!==n&&(t=n,!0)})))||void 0===e?void 0:e.id;g.current&&n&&g.current.focusGroupItem(n,t)}return()=>{}}),[o,c,g]),(0,s.jsx)(A.n,{ref:g,ariaExpandLabel:E.t(r.A.ACCORDIONS.EXPAND),ariaCollapseLabel:E.t(r.A.ACCORDIONS.COLLAPSE),data:o,itemHeight:60,renderItem:n,renderGroup:t,renderEmpty:j,onToggleCollapse:m,collapsedIds:p,activeGroupId:d,collapseEmptyGroups:o.length>1})}},97300:(e,t,n)=>{"use strict";n.d(t,{$:()=>x});var s=n(74848),i=n(96540),o=n(99366),r=n(38216),a=n(91659),c=n(92157),l=n(81047),d=n(99224),u=n(52385),h=n(40826),p=n(61412),m=n(87312),g=n(84573);function f({id:e,icon:t,label:n,selected:o}){const{commandBinder:r,analytics:a}=(0,i.useContext)(h.BR),c=(0,p.L)();return(0,s.jsx)(g.M,{id:e,icon:t,label:n,selected:o,onToggled:t=>{t.stopPropagation(),"ALL"===e?o||r.issueCommand(new m._d):r.issueCommand(new m._w(e,!o)),o||a.trackGuiEvent(`items_filter_by_${e.toLowerCase()}`,{tool:c})}})}var v=n(99167);n(30562);const{SEARCH:E}=o.A.SHOWCASE;function x(){const e=(0,r.Y)(),t=Object.values((0,a.f)()),n=(0,c.h)(),o=0===n.length,h=(0,i.useRef)(null),p=t.sort(((e,t)=>(e.groupOrder||l.X$)-(t.groupOrder||l.X$))).map((t=>{const{id:i,groupIcon:r,groupPhraseKey:a}=t,c=e.t(a),l=!o&&n.includes(i);return(0,s.jsx)(f,{id:i,icon:r,label:c,selected:l},i)})),m=e.t(E.FILTER_SEARCH),g=e.t(E.FILTER_SEARCH_ALL);return(0,s.jsx)("div",Object.assign({className:"search-filter",onClick:e=>e.stopPropagation()},{children:(0,s.jsxs)(d.y,Object.assign({ariaLabel:e.t(E.FILTER_SEARCH_LABEL),ref:h,icon:"filter",variant:u.Ak.TERTIARY,size:u.Mp.SMALL,menuClassName:"search-filter-menu"},{children:[(0,s.jsxs)("div",Object.assign({className:"search-filter-menu-header"},{children:[(0,s.jsx)("div",{children:m}),(0,s.jsx)(v.J,{onClose:()=>{h.current&&h.current.closeMenu()}})]})),(0,s.jsx)(f,{id:"ALL",icon:"fullscreen",label:g,selected:o}),p]}))}))}},84573:(e,t,n)=>{"use strict";n.d(t,{M:()=>c});var s=n(74848),i=n(38216),o=n(99366),r=n(52385),a=n(63591);function c({id:e,icon:t,label:n,selected:c,onToggled:l}){const d=(0,i.Y)();return(0,s.jsx)(r.$n,Object.assign({icon:t,label:n,ariaLabel:c?d.t(o.A.SHOWCASE.SEARCH.FILTER_SEARCH_SELECTED):n,size:r.Mp.SMALL,variant:r.Ak.TERTIARY,onClick:l,appendChildren:!1},{children:(0,s.jsx)("div",Object.assign({className:"search-filter-selected"},{children:c&&(0,s.jsx)(a.I,{name:"checkmark"})}))}),e)}},95692:(e,t,n)=>{"use strict";n.d(t,{$:()=>E});var s=n(74848),i=n(96540),o=n(40826),r=n(99366),a=n(16603),c=n(38216),l=n(43802),d=n(57642);const u=(0,l.r)(d.L,"searchMode",!1);var h=n(61412),p=n(33324),m=n(82856),g=n(99224),f=n(52385);const{SEARCH:v}=r.A.SHOWCASE;function E({phraseKeys:e={},grouping:t,onGroupBy:n}){const i=(0,c.Y)(),o=(0,a.i)(p.qD,!1),r=u(),l=[m.Hj.DATE,m.Hj.FLOOR];"boolean"==typeof r&&l.unshift(m.Hj.TYPE),o&&l.push(m.Hj.LAYER);const d=i.t(b(t,!0,e));return(0,s.jsx)(g.y,Object.assign({className:"grouping-sort-menu-button",ariaLabel:d,variant:f.Ak.TERTIARY,label:d,caret:!0},{children:l.map((t=>(0,s.jsx)(x,{onGroupBy:n,grouping:t,phraseKeys:e},t)))}))}function x({grouping:e,onGroupBy:t,phraseKeys:n={}}){const{analytics:r}=(0,i.useContext)(o.BR),a=(0,c.Y)().t(b(e,!1,n)),l=(0,h.L)();return(0,s.jsx)(f.$n,{label:a,size:f.Mp.SMALL,variant:f.Ak.TERTIARY,onClick:()=>{t(e),r.trackGuiEvent(`items_group_by_${e}`,{tool:l})}},e)}function b(e,t,n){var s,i,o,r,a,c,l,d,u,h;switch(e){case m.Hj.TYPE:return t?(null===(s=n[m.Hj.TYPE])||void 0===s?void 0:s.selectedTextKey)||v.GROUP_TYPE_SELECTED:(null===(i=n[m.Hj.TYPE])||void 0===i?void 0:i.textKey)||v.GROUP_TYPE;case m.Hj.FLOOR:return t?(null===(o=n[m.Hj.FLOOR])||void 0===o?void 0:o.selectedTextKey)||v.GROUP_FLOOR_SELECTED:(null===(r=n[m.Hj.FLOOR])||void 0===r?void 0:r.textKey)||v.GROUP_FLOOR;case m.Hj.ROOM:return t?(null===(a=n[m.Hj.ROOM])||void 0===a?void 0:a.selectedTextKey)||v.GROUP_ROOM_SELECTED:(null===(c=n[m.Hj.ROOM])||void 0===c?void 0:c.textKey)||v.GROUP_ROOM;case m.Hj.LAYER:return t?(null===(l=n[m.Hj.LAYER])||void 0===l?void 0:l.selectedTextKey)||v.GROUP_LAYER_SELECTED:(null===(d=n[m.Hj.LAYER])||void 0===d?void 0:d.textKey)||v.GROUP_LAYER;case m.Hj.DATE:default:return t?(null===(u=n[m.Hj.DATE])||void 0===u?void 0:u.selectedTextKey)||v.GROUP_DATE_SELECTED:(null===(h=n[m.Hj.DATE])||void 0===h?void 0:h.textKey)||v.GROUP_DATE}}},27447:(e,t,n)=>{"use strict";n.d(t,{e:()=>m});var s=n(74848),i=n(96540),o=n(40826),r=n(99366),a=n(38216),c=n(20487),l=n(87312),d=n(52385);const{WORKSHOP:u,HIDE:h,SHOW:p}=r.A;function m({item:e,onToggle:t}){const{commandBinder:n}=(0,i.useContext)(o.BR),r=(0,a.Y)(),{enabled:m,id:g,typeId:f}=e,v=!e.isLayerVisible(),E=!m||v?"eye-hide":"eye-show",x=(0,c.H)(),b=v?r.t(u.LAYERS.HIDDEN_LAYER_ITEM_TOOLTIP):m?r.t(h):r.t(p);return(0,s.jsx)(d.$n,{icon:E,dimmed:!m,variant:d.Ak.TERTIARY,onClick:e=>{e.stopPropagation(),v||(m&&x===g&&n.issueCommand(new l.Xx(null,f)),t(!m))},tooltip:b})}},57037:(e,t,n)=>{"use strict";n.d(t,{x:()=>v});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(99366),c=n(38216),l=n(82856),d=n(95178),u=n(75716),h=n(33947),p=n(76956),m=n(68340);var g=n(66368);const{SEARCH:f}=a.A.SHOWCASE;function v(e){const{excludeEmptyGroups:t,activeItemId:n,grouping:o,emptyPhrase:a}=e,v=(0,i.useRef)(null),E=(0,c.Y)(),x=(0,d.M)(),b=(0,u.W)(),y=function(){const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)((e=>()=>t(e)),[]);return(0,p.J)(m.MT,n(!0)),(0,p.J)(m.tj,n(!1)),e}(),O=0===b.length,T=o===l.Hj.FLOOR,C=o===l.Hj.ROOM,A=o===l.Hj.LAYER,_=o===l.Hj.DATE,S=void 0!==t?t:x,j=E.t(a||f.EMPTY_LIST_MESSAGE),R=!!S&&O,N=Object.assign(Object.assign({},e),{scrollRef:null==v?void 0:v.current,excludeEmptyGroups:S,activeItemId:n});return R?(0,s.jsx)(g.t,{message:j}):(0,s.jsxs)("div",Object.assign({className:r()("list-contents","searchable-list",{pending:y}),ref:v},{children:[T?(0,s.jsx)(h.r2,Object.assign({},N)):C?(0,s.jsx)(h.mk,Object.assign({},N)):A?(0,s.jsx)(h.ex,Object.assign({},N)):_?(0,s.jsx)(h.ic,Object.assign({},N)):(0,s.jsx)(h.dS,Object.assign({},N)),e.children]}))}},80898:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(74848),i=n(88007),o=n(89339);function r({item:e}){const{imgUrl:t,color:n,icon:r}=e;return t?(0,s.jsx)(i.q,{className:"thumbnail-image",resource:t}):r?(0,s.jsx)(o.E,{badgeStyle:void 0!==n?{background:n,borderColor:n}:{},iconClass:r}):null}},37086:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(74848),i=n(34466),o=n(23168),r=n(76481);function a({item:e}){const{textParser:t,title:n,description:a}=e,c=(0,i.e)();let l=n;l&&(l=(0,o.x8)(l,c));let d=a;return d&&(d=(0,o.A_)(d,c)),(0,s.jsxs)("div",Object.assign({className:"item-details"},{children:[(0,s.jsx)("div",Object.assign({className:"item-header"},{children:(0,s.jsx)(r.L,{text:l||"",textParser:t,markers:o.S8})})),t&&(0,s.jsx)("div",Object.assign({className:"item-description"},{children:(0,s.jsx)(r.L,{text:d||"",textParser:t,markers:o.S8})}))]}))}},5929:(e,t,n)=>{"use strict";n.d(t,{P:()=>b});var s=n(74848),i=n(45094),o=n(50078),r=n(96540),a=n(38216),c=n(84020);const l=(e,t)=>Number(t.isSelected)-Number(e.isSelected)||e.text.localeCompare(t.text),d={fixtures:"KEYWORDS_FIXTURES"};function u(){const e=(0,a.Y)(),t=function(){const e=(0,c.w)(),[t,n]=(0,r.useState)((null==e?void 0:e.getKeywordSummaries())||[]);return(0,r.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordSummaries())}const s=e.keywordCounts.onChanged(t),i=e.keywordFilters.onChanged(t);return t(),()=>{s.cancel(),i.cancel()}}),[e]),t}();return(0,r.useMemo)((()=>t.map((t=>Object.assign(Object.assign({},t),{text:d[t.id]?e.t(d[t.id]):t.text}))).sort(l)),[t,e])}var h=n(87312);const p=()=>{const e=u(),t=(0,o.D)(h.$M,(e=>[e.id]));return(0,s.jsx)(i.c,{className:"search-keyword-summary",tokens:e,onTokenClick:t,maxVisibleTruncated:5,allowSelect:!0})};var m=n(92924),g=n(84370),f=n(521),v=n(57016),E=n(97137),x=n(75414);function b(){const e=(0,v.J)(),t=(0,E.O)(),n=t===f.L$.NARROW||t===f.L$.BOTTOM_PANEL,i=!e&&t===f.L$.BOTTOM_PANEL;return(0,x.t)()&&i?null:(0,s.jsx)("div",Object.assign({className:"search-tool-overlay"},{children:n?(0,s.jsx)(m.A,Object.assign({direction:g.OP.horizontal},{children:(0,s.jsx)(p,{})})):(0,s.jsx)(p,{})}))}},32381:(e,t,n)=>{"use strict";n.d(t,{M:()=>L});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(40826),c=n(99366),l=n(521),d=n(9321),u=n(97137),h=n(57016),p=n(38216),m=n(8430),g=n(40270),f=n(34466),v=n(9182),E=n(92157),x=n(87312),b=n(34904),y=n(44383),O=n(52385),T=n(52147);function C(e){const{query:t,keywordFilters:n,typeFilters:o}=e,{locale:r,analytics:l,editMode:d,settings:u}=(0,i.useContext)(a.BR),[h,p]=(0,i.useState)(!1),m=d||u.tryGetProperty(T.wD,!1),g=(0,i.useCallback)((()=>{const e=(0,y.Cz)(t,n,o);(0,b.l)(e),p(!0);const s=d?"workshop_gui":"showcase_gui";l.track(s,{gui_action:"space_search_share_link_clicked"})}),[t,n,o,d,l]);return(0,i.useEffect)((()=>{if(!h)return()=>{};const e=window.setTimeout((()=>p(!1)),2500);return()=>window.clearTimeout(e)}),[h]),m?h?(0,s.jsx)("span",Object.assign({className:"link-copied"},{children:r.t(c.A.SHARE_COPIED)})):(0,s.jsx)(O.$n,{onClick:g,icon:"share",variant:O.Ak.TERTIARY,tooltip:r.t(c.A.COPY_URL)}):null}var A=n(35953),_=n(64599),S=n(63954);const{SEARCH:j}=c.A.SHOWCASE;function R({filter:e,readOnly:t,shareEnabled:n}){const{commandBinder:o}=(0,i.useContext)(a.BR),c=(0,i.useRef)(null),b=(0,i.useRef)(null),y=(0,p.Y)(),T=(0,u.O)(),R=(0,h.J)(),N=(0,f.e)(),k=(0,v.e)(),w=(0,E.h)(),I=(0,i.useMemo)((()=>(0,m.C8)()),[]),L=T===l.L$.BOTTOM_PANEL&&R,P=(0,_.w)((0,S.A)()),D=(0,i.useCallback)((e=>{o.issueCommand(new x.tA(e))}),[o]),M=y.t(j.SEARCH_IN_TOOL_PLACEHOLDER),U=y.t(j.CLEAR_SEARCH).toLocaleUpperCase(),H=k.length>0||w.length>0||""!==N,B=n&&H,V=I?void 0:g.JO;return(0,s.jsxs)("div",Object.assign({ref:b,className:r()("list-search","search-panel-header")},{children:[(0,s.jsxs)("div",Object.assign({className:"search-bar"},{children:[(0,s.jsx)("span",{className:r()("search-header-icon","icon","icon-magnifying-glass",{"search-header-icon-active":H})}),(0,s.jsx)(A.A,{text:N,onInput:D,onDone:e=>{L&&e&&o.issueCommand(new d.li(!1))},onCancel:()=>{o.issueCommand(new d.Te)},placeholder:M,onFocus:()=>{P&&L&&I&&(o.issueCommand(new d.li(!1)),window.setTimeout((()=>{b.current&&b.current.scrollIntoView({behavior:"smooth",block:"start"})}),g.JO))},ref:c,focusOnMount:V,readOnly:t}),(0,s.jsxs)("div",Object.assign({className:"search-header-button-container"},{children:[""!==N&&(0,s.jsx)(O.$n,{onClick:()=>{D(""),c.current&&!I&&c.current.focus()},label:U,size:O.Mp.SMALL,variant:O.Ak.TERTIARY}),B&&(0,s.jsx)(C,{query:N,keywordFilters:k,typeFilters:w})]}))]})),e]}))}var N=n(91659);const{SEARCH:k}=c.A.SHOWCASE;function w({id:e,label:t}){const{commandBinder:n}=(0,i.useContext)(a.BR),o=(0,p.Y)().t(k.FILTER_SEARCH_REMOVE);return(0,s.jsx)(O.$n,{icon:"close",label:t,tooltip:o,tooltipOptions:{placement:"bottom"},size:O.Mp.SMALL,variant:O.Ak.FAB,theme:"dark",onClick:()=>{n.issueCommand(new x._w(e,!1))},reverse:!0})}function I(){const e=(0,p.Y)(),t=(0,N.f)(),n=(0,E.h)();if(0===n.length)return null;const i=[];return n.forEach((n=>{const o=t[n];if(o){const t=e.t(o.groupPhraseKey);i.push((0,s.jsx)(w,{id:n,label:t},n))}})),(0,s.jsx)("div",Object.assign({className:"search-filter-pills"},{children:i}))}function L(e){const{shareEnabled:t=!1,filterPills:n=!1,filter:i}=e;return(0,s.jsxs)("div",Object.assign({className:"list-subheaders"},{children:[(0,s.jsx)(R,{filter:i,shareEnabled:t}),n&&(0,s.jsx)(I,{})]}))}},95178:(e,t,n)=>{"use strict";n.d(t,{M:()=>c});var s=n(34466),i=n(92157),o=n(9182),r=n(521),a=n(11360);function c(){const e=(0,s.e)(),t=(0,i.h)(),n=(0,o.e)(),c=(0,a.T)(),l=c===r.S0.SEARCH||c===r.S0.LAYERS;return!!e||l&&t.length>0||n.length>0}},84020:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(47952),i=n(57642);const o=(0,s.v)(i.L)},91659:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var s=n(96540),i=n(84020);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.dataTypeGroups)||{});return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.dataTypeGroups)}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},9182:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(96540),i=n(84020);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getKeywordFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordFilters())}const s=e.keywordFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},34466:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(43802),i=n(57642);const o=(0,s.r)(i.L,"query","")},75716:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var s=n(96540),i=n(84020),o=n(76956),r=n(68340);function a(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getResults())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getResults())}const s=e.onSearchResultsChanged(t);return t(),()=>s.cancel()}),[e]),(0,o.J)(r.MT,(()=>{null==e||e.setResults([])})),t}},92157:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var s=n(96540),i=n(84020);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getTypeFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getTypeFilters())}const s=e.typeFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},20487:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var s=n(43802),i=n(57642);const o=(0,s.r)(i.L,"activeItemId",null)},9419:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,Y:()=>a});var s=n(32361),i=n(18268),o=n(61543),r=n(44945);class a extends i.u{constructor(e){super(),this.payload={maxSize:e.maxSize||o.MF.ULTRAHIGH,aspect:e.aspect||r.BE,category:e.category||s.X.USER,onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}a.id="CAPTURE_SNAPSHOT";class c extends i.u{constructor(e){super(),this.payload={onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}c.id="EQUIRECTANGULAR_SNAPSHOT"},53593:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var s=n(14754);class i extends s.QB{constructor(e){super(),this.error=e}}},13539:(e,t,n)=>{"use strict";n.d(t,{Ns:()=>r,gp:()=>i,t6:()=>a,tZ:()=>o});var s=n(18268);class i extends s.u{constructor(e,t){super(),this.payload={id:e,name:t}}}i.id="RENAME_SNAPSHOT";class o extends s.u{constructor(e){super(),this.payload={id:e}}}o.id="DELETE_SNAPSHOT";class r extends s.u{constructor(e){super(),this.payload={snapshot:e}}}r.id="UPLOAD_SNAPSHOT";class a extends s.u{constructor(e){super(),this.payload={id:e}}}a.id="SET_CURRENT_SNAPSHOT_PHOTO"},98925:(e,t,n)=>{"use strict";n.d(t,{O:()=>a});var s=n(61589),i=n(60282),o=n(16276),r=n(50281);class a extends s.B{constructor(e){super(),this.name="snapshots",this.snapshots={};for(const t in e)this.snapshots[t]=e[t].clone()}get(e){return this.snapshots[e]}async getImageUrl(e){const t=this.get(e),n=new URL(await t.imageUrl.get());return"panorama"===t.category&&(n.searchParams.delete("height"),n.searchParams.delete("fit")),n.toString()}get collection(){return this.snapshots}get snapshotsCount(){return this.snapshots?Object.keys(this.snapshots).length:0}getSortedCollection(e){if(!this.snapshotsCount)return[];let t=Object.values(this.snapshots);return(null==e?void 0:e.filterFn)&&(t=t.filter(e.filterFn)),t.sort((null==e?void 0:e.compareFn)||r.PN)}setSelectedPhoto(e){this.selectedPhotoId=e,this.commit()}add(e){e.sid=this.validateSid(e.sid),this.snapshots[e.sid]=e,this.updateOnStaleCallbacks(),this.commit()}remove(e){delete this.snapshots[e]}validateSid(e){for(;!e||this.snapshots[e];)e=(0,i.D)(11);return e}set onStale(e){this.hydrate=e,this.updateOnStaleCallbacks()}updateOnStaleCallbacks(){this.hydrate&&(0,o._)(this.snapshots,(async()=>{const e=await this.hydrate();for(const t in this.snapshots)e&&e[t]&&this.snapshots[t].refresh(e[t])}))}}},12837:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>o,LW:()=>i,iM:()=>r});var s=n(14754);class i extends s.QB{constructor(e){super(),this.sweepId=e}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.orientation=t,this.deltaAngle=n}}class r extends s.QB{constructor(e){super(),this.sweepId=e}}},67902:(e,t,n)=>{"use strict";n.d(t,{im:()=>g,jd:()=>E});var s=n(68909),i=n(85641),o=n.n(i),r=n(81019),a=n.n(r);class c extends s.ShaderMaterial{constructor(e,t){const n={tMask:{value:e},tPinHole:{value:t},pinColor:{value:new s.Color},opacity:{value:1}};super({vertexShader:o(),fragmentShader:a(),uniforms:n,name:"PinMaterial",transparent:!0})}}var l=n(19533),d=n(43998),u=n(12183),h=n(84252),p=n(89103);const m=n.p+"images/360_placement_pin_mask.png";class g extends s.Mesh{}let f;const v=()=>f||(f=(0,l.y)(m),f);class E extends p.m{constructor(e,t,n,s){const i=new c(v(),t);super(E.geometry,i),this.layers.mask=s.mask,this.name="PinMesh",this.cameraData=n,this._collider=new g(E.colliderGeometry,E.colliderMaterial),this._collider.name="PinMeshCollider",this._collider.material.visible=!1,this.add(this._collider),this.opacityProgress=0,this.shouldHide=!0,this.uniforms=i.uniforms,this.unhover(),this.selected=0,this.visible=!1,this.position.copy(e),this.renderOrder=u.X.pins360}updatePosition(e){this.position.copy(e)}get collider(){return this._collider}render(e){this.quaternion.copy(this.cameraData.pose.rotation),null===this.uniforms.tPinHole.value?this.opacityProgress=0:!this.shouldHide&&this.opacityProgress<1?this.opacityProgress+=e/E.FADE_DURATION:this.shouldHide&&this.opacityProgress>0&&(this.opacityProgress-=e/E.FADE_DURATION),this.opacityProgress=(0,d.qE)(this.opacityProgress,0,1),this.uniforms.opacity.value=this.opacityProgress,this.visible=0!==this.opacityProgress}activate(){this.shouldHide=!1}deactivate(){this.shouldHide=!0}isActive(){return!this.shouldHide}dispose(){this.collider.geometry.dispose(),this.collider.material.dispose()}setPinHover(e,t=!0,n=!0){const s=Math.min(Math.max(e,0),1);this.selected!==s&&(n&&this.uniforms.pinColor.value.copy(h.V.WHITE).lerp(h.V.MP_BRAND,s),t&&s>0&&s<=1&&(this.material.depthTest=!1),0===s&&(this.material.depthTest=!0),this.selected=s)}unhover(){this.uniforms.pinColor.value.copy(h.V.WHITE)}}E.FADE_DURATION=500,E.geometry=new s.PlaneGeometry(1.5,1.5),E.colliderGeometry=new s.SphereGeometry(1.5*.65),E.colliderMaterial=new s.MeshBasicMaterial({transparent:!0,opacity:.5,depthWrite:!1,color:16724312})},67408:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,H:()=>o});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={id:e}}}i.id="PIN_UNSELECT";class o extends s.u{constructor(e,t){super(),this.payload={sweepId:e,highlight:t}}}o.id="HIGHLIGHT_PIN"},77010:(e,t,n)=>{"use strict";n.d(t,{N:()=>i,k:()=>o});var s=n(14754);class i extends s.QB{constructor(e,t){super(),this.sweepId=e,this.selected=t}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.pinIndex=t,this.placed=n}}},32677:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(19533);const i=n.p+"images/exterior.png",o=n.p+"images/exterior_hover.png",r=n.p+"images/interior.png",a=n.p+"images/interior_hover.png";let c;const l={get:()=>c||(c={toExteriorTexture:(0,s.y)(i),toExteriorHoverTexture:(0,s.y)(o),toInteriorTexture:(0,s.y)(r),toInteriorHoverTexture:(0,s.y)(a)},c)}},16552:(e,t,n)=>{"use strict";n.d(t,{B:()=>h});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(45094),c=n(87312),l=n(40826),d=n(521),u=n(9321);const h=({keywords:e,className:t,maxVisible:n=2,theme:o})=>{const{engine:h,editMode:p}=(0,i.useContext)(l.BR),m=(0,i.useCallback)((({text:e},t)=>{t.stopPropagation();const n=p?d.S0.LAYERS:d.S0.SEARCH;h.commandBinder.issueCommand(new u.yU(n,!0)),h.commandBinder.issueCommand(new c.Pb([e]))}),[h,p]);return(0,s.jsx)(a.c,{className:r()("tag-keywords",t),tokens:e.map((e=>({id:e,text:e}))),onTokenClick:m,maxVisibleTruncated:n,tokenSize:"small",tokenTheme:o})}},63348:(e,t,n)=>{"use strict";n.d(t,{P:()=>h});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(40826),c=n(52147),l=n(33361),d=n(89375),u=n(2923);const h=({attachments:e,onClick:t})=>{const{settings:n,engine:o}=(0,i.useContext)(a.BR),h=(0,u.w)(),p=n.tryGetProperty(c.qu,!1);(0,i.useEffect)((()=>{var t;(null===(t=e[0])||void 0===t?void 0:t.parentId)!==h&&o.commandBinder.issueCommand(new d.kd)}),[e,h,o.commandBinder]);const m=(0,i.useCallback)(((n,s)=>{0!==e.length&&(n.stopPropagation(),t(n,s))}),[e,t]),g=(0,i.useCallback)((t=>{1===e.length&&o.commandBinder.issueCommand(new d.kd(t))}),[e.length,o.commandBinder]);return p||0===e.length?null:(0,s.jsx)("div",Object.assign({className:r()("tag-media",{"embed-error":!!h})},{children:(0,s.jsx)(l.g,{attachments:e,onClick:m,onError:g})}))}},765:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(89375),i=n(44901),o=n(99366),r=n(59105),a=n(97984);const{TAGS:c}=o.A.SHOWCASE;class l{constructor(e,t){this.engine=e,this.settings=t}async activate(){await this.engine.commandBinder.issueCommand(new s.NR(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new s.NR(!1))}async deepLink(e){const t=(await this.engine.market.waitForData(i.r)).getTagView(e);if(t)(0,r.zX)(this.settings,t,(t=>{this.engine.commandBinder.issueCommand(new s.Ki(e,{transition:t,dock:!0}))}));else{const e={messagePhraseKey:c.MISSING_MESSAGE,timeout:4e3,dismissesOnAction:!0};this.engine.commandBinder.issueCommand(new a.Q(e))}}}},6199:(e,t,n)=>{"use strict";n.d(t,{T:()=>g});var s=n(74848),i=n(96540),o=n(40826),r=n(71136),a=n(58330),c=n(31200),l=n(89375),d=n(8930),u=n(34368),h=n(92733),p=n(86978),m=n(42336);function g(e){const{overlay:t,analyticAction:n}=e,{analytics:g,commandBinder:f,editMode:v}=(0,i.useContext)(o.BR),E=(0,a.H)(),x=(0,d.f)(!0),b=(0,u.D)(),y=(0,c._)(),O=(0,h.G)(),[T,C]=(0,i.useState)(!1),A=v||!y?x:x.filter((e=>y.layerToggled(e.layerId)&&(!O||O.getCapabilities(e.id).focus)));if(!(b&&A.length>1))return null;const _=A.findIndex((e=>e.id===(null==b?void 0:b.id)));if(-1===_)return null;const S=(0,s.jsx)(p.r,{index:_,total:A.length,disabled:T,overlay:t,wrapAround:!0,onNavigate:e=>{const t=A[e];if(!t)return;C(!0);const s=b?E?r.fl.Instant:r.fl.FadeToBlack:r.fl.Interpolate;g.trackToolGuiEvent("tags",n),f.issueCommand(new l.Ki(t.id,{transition:s})).then((()=>{C(!1)}))}});return t?(0,s.jsx)(m.L,Object.assign({className:"tags-navigation-overlay"},{children:S})):S}},66094:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var s=n(74848),i=n(75414),o=n(11360),r=n(6199),a=(n(9554),n(20764)),c=n(16603);function l(){const e=(0,i.t)(),t=(0,o.T)(),n=(0,c.i)(a.rp,"1");return e||t||!n?null:(0,s.jsx)("div",Object.assign({className:"overlay grid-overlay tags-overlay"},{children:(0,s.jsx)(r.T,{overlay:!0,analyticAction:"tags_navigate_in_canvas"})}))}},2923:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(43802),i=n(44901);const o=(0,s.r)(i.r,"embedErrorTagId",void 0)},34368:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var s=n(96540),i=n(92733);function o(){const e=(0,i.G)(),[t,n]=(0,s.useState)(e?e.openTagView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenTagViewChanged(n);return n(e.openTagView),()=>t.cancel()}),[e]),t}},8930:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var s=n(96540),i=n(92733);function o(e){const t=(0,i.G)(),[n,o]=(0,s.useState)((null==t?void 0:t.getOrderedTags(e))||[]);return(0,s.useEffect)((()=>{if(!t)return()=>{};function n(){t&&o(t.getOrderedTags(e))}const s=t.getOrderedTagViewMapFilter().onChanged(n);return n(),()=>s.cancel()}),[t,e]),n}},24850:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var s=n(96540),i=n(92733);function o(e){return e?e.getLinkHandler():null}function r(){const e=(0,i.G)(),[t,n]=(0,s.useState)(o(e));return(0,s.useEffect)((()=>(t||n(o(e)),()=>{})),[t,e]),t}},92733:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var s=n(47952),i=n(44901);const o=(0,s.v)(i.r)},19591:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var s=n(43802),i=n(26956);const o=(0,s.r)(i.M,"previousToolName",null)},65479:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var s=n(43802),i=n(26956);const o=(0,s.r)(i.M,"softOpening",!1)},2040:(e,t,n)=>{"use strict";n.d(t,{jl:()=>r,ly:()=>i,qO:()=>o});var s=n(18268);class i extends s.u{constructor(e){super(),this.payload={search:e}}}i.id="USERS_SEARCH";class o extends s.u{constructor(e){super(),this.payload={userMentions:e}}}o.id="USERS_MENTIONS_FETCH";class r extends s.u{constructor(e,t,n,s){super(),this.payload={emails:e,message:t,modelAccess:n,noteId:s}}}r.id="USERS_INVITE"},25615:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var s=n(47952),i=n(85217);const o=(0,s.v)(i.E)},4143:(e,t,n)=>{"use strict";n.d(t,{_:()=>o,x:()=>i});var s=n(18268);class i extends s.u{constructor(){super()}}i.id="LOCK_VIEWMODE";class o extends s.u{constructor(){super()}}o.id="UNLOCK_VIEWMODE"},89103:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var s=n(68909);class i extends s.Mesh{constructor(e,t){super(e,t)}}},81019:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;uniform sampler2D tMask;uniform sampler2D tPinHole;uniform vec3 pinColor;uniform float opacity;void main(){vec4 maskColor=texture2D(tMask,vUv);vec4 pinHoleColor=vec4(texture2D(tPinHole,vec2(vUv.x,vUv.y-0.11)).xyz,1.);float redness=maskColor.r-maskColor.b;vec4 mixedPinColor=mix(vec4(pinColor,1.),pinHoleColor,redness);mixedPinColor.a=min(mixedPinColor.a,maskColor.a)*opacity;if(mixedPinColor.a==0.)discard;gl_FragColor=linearToOutputTexel(mixedPinColor);}"},85641:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"}}]);